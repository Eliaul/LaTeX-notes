
\chapter{积分曲线和流}

\section{积分曲线}

设 $M$ 是光滑流形，$\gamma:J\to M$ 是光滑曲线，那么
对于 $t\in J$，速度向量 $\gamma'(t)\in T_{\gamma(t)}M$。
本节我们研究逆向的方法：给定每个点的切向量，寻找一条曲线
使得其在每个点的速度向量等于给定的切向量。

如果 $V$ 是 $M$ 上的向量场，定义\emph{$V$ 的积分曲线}为
可微曲线 $\gamma:J\to M$，其在每个点处的速度等于 $V$ 在该点处的值：
\[
  \gamma'(t)=V_{\gamma(t)}\quad \forall t\in J.  
\]
如果 $0\in J$，点 $\gamma(0)$ 被称为\emph{$\gamma$ 的起点}。

寻找积分曲线可以归结为求解光滑坐标卡中的常微分方程组。设
$V$ 是一个光滑向量场，$\gamma:J\to M$ 是光滑曲线。在一个光滑坐标
开集 $U\subseteq M$ 中，我们可以将 $\gamma$ 表示为
$\gamma(t)=\bigl(\gamma^1(t),\dots,\gamma^n(t)\bigr)$。那么
$\gamma'(t)=V_{\gamma(t)}$ 当且仅当
\[
  \dot\gamma^i(t)\left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)}  
  =V^i(\gamma(t))\left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)} ,
\] 
这导出了一个常微分方程组：
\begin{align*}
  \dot\gamma^1(t)
  &=V^1(\gamma^1(t),\dots,\gamma^n(t)) ,\\
  &\vdots \\
  \dot\gamma^n(t)
  &=V^n(\gamma^1(t),\dots,\gamma^n(t)).
\end{align*}

\begin{proposition}
  令 $V$ 是光滑流形 $M$ 上的光滑向量场。对于每个 $p\in M$，都存在
  $\varepsilon>0$ 和光滑曲线 $\gamma:(-\varepsilon,\varepsilon)\to M$
  使得 $\gamma$ 是 $V$ 的起点为 $p$ 的积分曲线。
\end{proposition}

\begin{lemma}[缩放引理]
  令 $V$ 是光滑流形 $M$ 上的光滑向量场。$J\subseteq \mathbb{R}$
  是区间，$\gamma:J\to M$ 是 $V$ 的积分曲线。对于任意 $a\in \mathbb{R}$，
  定义曲线 $\tilde \gamma:\tilde{J}\to M$ 为 $\tilde{\gamma}(t)=\gamma(at)$，
  其中 $\tilde{J}=\{t\,|\, at\in J\}$，那么 $\tilde{\gamma}$ 是向量场
  $aV$ 的积分曲线。
\end{lemma}
\begin{proof}
  任取 $f\in C^\infty(M)$，有
  \begin{align*}
    \tilde{\gamma}'(t_0)f&=d\tilde{\gamma}_{t_0}\left(
      \left.\frac{d}{dt}\right|_{t_0}
    \right)f
    =\left.\frac{d}{dt}\right|_{t_0}(f\circ\tilde\gamma)(t)
    =\left.\frac{d}{dt}\right|_{t_0}(f\circ\gamma)(at)\\
    &=a (f\circ\gamma)'(at_0)
    =a\gamma'(at_0)f=aV_{\gamma(at_0)}f=
    aV_{\tilde{\gamma}(t_0)}f,
  \end{align*}
  所以 $\tilde{\gamma}'(t_0)=aV_{\tilde{\gamma}(t_0)}$。
\end{proof}

\begin{lemma}[平移引理]
  令 $V,M,J$ 和 $\gamma$ 的含义同上一个引理。对于任意
  $b\in \mathbb{R}$，定义曲线 $\hat\gamma:\hat J\to M$
  为 $\hat \gamma(t)=\gamma(t+b)$，其中
  $\hat J=\{t\,|\, t+b\in J\}$，那么 $\hat \gamma$ 是向量场
  $V$ 的积分曲线。
\end{lemma}

\begin{proposition}[积分曲线的自然性]\label{prop:naturality of integral curve}
  设 $M,N$ 是光滑流形，$F:M\to N$ 是光滑映射。那么 $X\in \mathfrak{X}(M)$
  和 $Y\in \mathfrak{X}(N)$ 是 $F$-相关的当且仅当 $F$ 将 $X$ 的积分曲线
  送到 $Y$ 的积分曲线，也就是说，对于 $X$ 的积分曲线 $\gamma$，
  $F\circ\gamma$ 是 $Y$ 的积分曲线。
\end{proposition}
\begin{proof}
  假设 $X,Y$ 是 $F$-相关的，这意味着对于任意 $p\in M$，有
  \[
    Y_{F(p)}=dF_p(X_p),
  \]
  于是
  \[
    (F\circ\gamma)'(t)
    =dF_{\gamma(t)}\bigl(\gamma'(t)\bigr)
    =dF_{\gamma(t)}(V_{\gamma(t)})=Y_{F(\gamma(t))}
    =Y_{(F\circ\gamma)(t)},
  \]
  这就说明 $F\circ\gamma$ 是 $Y$ 的积分曲线。

  反之，若对于任意 $X$ 的积分曲线 $\gamma$，$F\circ\gamma$ 都是
  $Y$ 的积分曲线。那么任取 $p\in M$，选取 $X$ 的以 $p$ 为起点
  的积分曲线 $\gamma$，有
  \[
    Y_{F(p)}=Y_{F(\gamma(0))}=(F\circ\gamma)'(0)
    =dF_{\gamma(0)}(\gamma'(0))=dF_p(X_p),  
  \]
  即 $X,Y$ 是 $F$-相关的。
\end{proof}

\section{流}

令 $M$ 是光滑流形，$V\in \mathfrak{X}(M)$。假设对于每个点 $p\in M$，
$V$ 有唯一的一条定义在 $t\in \mathbb{R}$ 上的以 $p$ 为起点的积分曲线，
记为 $\theta^{(p)}:\mathbb{R}\to M$。那么对于每个 $t\in \mathbb{R}$，我们可以
定义映射 $\theta_t:M\to M$，将点 $p$ 送到以 $p$ 为起点的积分曲线
在 $t$ 时刻的值：
\[
  \theta_t(p)=\theta^{(p)}(t).  
\]
那么每个 $\theta_t$ 看起来就像将流形沿着 $t$ 时刻的积分曲线进行“滑动”。
平移引理表明 $t\mapsto \theta^{(p)}(t+s)$ 是 $V$ 的以 $q=\theta^{(p)}(s)$
为起点的积分曲线，因为我们假设了积分曲线的唯一性，所以
$\theta^{(q)}(t)=\theta^{(p)}(t+s)$，也就是
\[
  \theta_t\circ\theta_s(p)=\theta_t(q)=\theta_{t+s}(p).
\]
结合 $\theta_0(p)=\theta^{(p)}(0)=p$，这导出了一个加法群 $\mathbb{R}$
在 $M$ 上的群作用 $\theta:\mathbb{R}\times M\to M$。

出于这个动机，我们定义 $M$ 上的\emph{全局流}为一个 $M$
上的连续左 $\mathbb{R}$-作用，即一个连续映射 $\theta:\mathbb{R}\times M\to M$
满足对于任意 $s,t\in \mathbb{R}$ 和 $p\in M$ 有
\begin{equation}
  \theta\bigl(t,\theta(s,p)\bigr)=\theta(t+s,p),\quad
  \theta(0,p)=p.
\end{equation}

下面的命题表明，每个光滑的全局流都是按照我们上面所述的方式
从某个光滑向量场的积分曲线导出的。如果 $\theta:\mathbb{R}\times M\to M$
是光滑的全局流，对于每个 $p\in M$，我们定义切向量 $V_p\in T_pM$ 为
\[
  V_p=\smash{\theta^{(p)}}'(0),
\]
那么 $p\mapsto V_p$ 是 $M$ 上的一个向量场，被称为\emph{$\theta$ 的无穷小生成元}。

\begin{proposition}\label{prop:infinite generator}
  令 $\theta:\mathbb{R}\times M\to M$ 是光滑的全局流，那么
  $\theta$ 的无穷小生成元 $V$ 是 $M$ 上的光滑向量场，并且每个
  曲线 $\theta^{(p)}$ 都是 $V$ 的积分曲线。
\end{proposition}
\begin{proof}
  任取 $f\in C^\infty(M)$ 和 $p\in M$，有
  \[
    Vf(p)=V_pf=  \smash{\theta^{(p)}}'(0)f=
    \left.\frac{d}{dt}\right|_{t=0}f\bigl(\theta^{(p)}(0)\bigr)
    =\frac{\partial (f\circ\theta)}{\partial t}(0,p),
  \]
  由于 $f\circ\theta$ 是光滑函数，所以 $Vf$ 也是光滑函数，故
  $V$ 是光滑向量场。

  下面证明 $\theta^{(p)}$ 是 $V$ 的积分曲线。记 $q=\theta^{(p)}(t)$，那么
  \[
    V_{\theta^{(p)}(t)}f=\smash{\theta^{(q)}}'(0)f
    =\left.\frac{d}{ds}\right|_{s=0}f(\theta(s,q))
    =\left.\frac{d}{ds}\right|_{s=0}f(\theta(s+t,p))
    =\smash{\theta^{(p)}}'(t)f,
  \]
  即 $\smash{\theta^{(p)}}'(t)=V_{\theta^{(p)}(t)}$。
\end{proof}

\subsection{流的基本定理}

我们已经说明了每个光滑的全局流都会产生一个光滑的向量场，即无穷小生成元。反之，
我们希望能说明每个光滑向量场都是某个光滑全局流的无穷小生成元。然而，很容易看出
这是不成立的，因为存在光滑向量场使得其积分曲线不可能对所有的 $t\in \mathbb{R}$
都有定义。

\begin{example}
  令 $M=\mathbb{R}^2 \smallsetminus\{0\}$ 附带标准坐标 $(x,y)$，$V=\partial/\partial x$ 是 $M$
  上的向量场。$V$ 的唯一的以 $(-1,0)$ 为起点的积分曲线为 $\gamma(t)=(t-1,0)$。
  但是此时 $\gamma$ 不能被连续地延拓为一条经过 $t=1$ 的积分曲线，这直观上是明显的，
  因为 $M$ 在原点处有个洞。为了证明这一点，假设 $\tilde\gamma$ 是 $\gamma$ 的连续延拓且
  经过 $t=1$，那么 $t\to 1_+$ 的时候有 $\gamma(t)\to\tilde{\gamma}(1)\in \mathbb{R}^2 \smallsetminus\{0\}$。
  同时我们可以将 $\gamma$ 视为值域在 $\mathbb{R}^2$ 中的曲线，于是 $t\to 1_+$ 时有 $\gamma(t)\to (0,0)$，
  出于极限的唯一性，必须有 $\tilde{\gamma}(1)=(0,0)\in \mathbb{R}^2 \smallsetminus\{0\}$，
  这是矛盾的。
\end{example}

出于上述原因，我们给出下面的定义。如果 $M$ 是流形，定义 $M$ 的\emph{流域}指的是一个开集
$\mathcal{D}\subseteq \mathbb{R}\times M$，其满足任取 $p\in M$，集合
$\mathcal{D}^{(p)}=\{t\in \mathbb{R}\,|\, (t,p)\in \mathcal{D}\}$ 是
包含 $0$ 的一个开区间。定义 $M$ 上的\emph{流}为一个连续映射 $\theta:\mathcal{D}\to M$，
其中 $\mathcal{D}\subseteq \mathbb{R}\times M$ 是流域，这个映射满足：对于任意 $p\in M$，
\[
  \theta(0,p)=p,
\]
对于 $s\in \mathcal{D}^{(p)}$ 和 $t\in \mathcal{D}^{(\theta(s,p))}$，如果
$s+t\in \mathcal{D}^{(p)}$，那么
\[
  \theta\bigl(t,\theta(s,p)\bigr)=\theta(t+s,p).
\]
有时我们将 $\theta$ 称为\emph{局部流}来和全局流区分。

如果 $\theta$ 是流，只要 $(t,p)\in \mathcal{D}$，我们定义 $\theta_t(p)=\theta^{(p)}(t)=\theta(t,p)$，
这与全局流一致。对于每个 $t\in \mathbb{R}$，我们还定义
\[
  M_t=\{p\in M\,|\, (t,p)\in \mathcal{D}\},
\]
所以
\[
  p\in M_t\Leftrightarrow (t,p)\in \mathcal{D}\Leftrightarrow t\in \mathcal{D}^{(p)}.
\]
如果 $\theta$ 是光滑的，定义 $\theta$ 的\emph{无穷小生成元} $V$ 为 $V_p=\smash{\theta^{(p)}}'(0)$。

\begin{proposition}
  如果 $\theta:\mathcal{D}\to M$ 是光滑流，那么无穷小生成元 $V$ 是光滑向量场，并且
  每条曲线 $\theta^{(p)}$ 都是 $V$ 的积分曲线。
\end{proposition}
\begin{proof}
  与 \autoref{prop:infinite generator} 的证明基本类似。在说明 $V$
  是光滑向量场的时候，只需要注意到对于任意 $p_0\in M$，有 $(0,p_0)\in \mathcal{D}$。
  又因为 $\mathcal{D}$ 是开集，所以存在 $(0,p_0)$ 处的邻域使得这个邻域中的所有 $(t,p)\in \mathcal{D}$，
  此时重复 \autoref{prop:infinite generator} 的证明即可得到 $V$ 是光滑向量场。
  在证明 $\theta^{(p)}$ 是 $V$ 的积分曲线的时候，只需要说明
  \autoref{prop:infinite generator} 的证明中的式子有意义即可。
  假设 $t_0\in \mathcal{D}^{(p)}$。因为 $\mathcal{D}^{(p)}$ 和 $\mathcal{D}^{(\theta_{t_0}(p))}$
  是包含 $0$ 的开区间，所以存在正数 $\varepsilon$ 使得 $|t|<\varepsilon$
  的时候有 $t+t_0\in \mathcal{D}^{(p)}$ 以及 $t\in \mathcal{D}^{(\theta_{t_0}(p))}$，
  那么根据局部流的定义，有 $\theta(t+t_0,p)=\theta(t,\theta(t_0,p))$，
  这便保证我们可以重复 \autoref{prop:infinite generator} 的证明。
\end{proof}

下面的定理是本节的主要结果。\emph{极大积分曲线}指的是不能延拓到任意更大开区间的一条积分曲线，
\emph{极大流}指的是不能延拓到任意更大流域的流。

\begin{theorem}[流的基本定理]
  令 $V$ 是光滑流形 $M$ 上的光滑向量场，那么存在唯一的光滑极大流 $\theta:\mathcal{D}\to M$
  使得其无穷小生成元为 $V$，此外，这个流有下面的性质：
  \begin{enumerate}
    \item 对于每个 $p\in M$，曲线 $\theta^{(p)}:\mathcal{D}^{(p)}\to M$ 是 $V$ 的唯一的
    以 $p$ 为起点的极大积分曲线。
    \item 如果 $s\in \mathcal{D}^{(p)}$，那么 $\mathcal{D}^{(\theta(s,p))}$ 是区间
    $\mathcal{D}^{(p)}-s=\{t-s\,|\, t\in \mathcal{D}^{(p)}\}$。
    \item 对于每个 $t\in \mathbb{R}$，$M_t$ 是 $M$ 的开集，并且 $\theta_t:M_t\to M_{-t}$
    是微分同胚，其逆为 $\theta_{-t}$。
  \end{enumerate}
\end{theorem}

上述基本定理中断言的存在且唯一的流称为\emph{$V$ 生成的流}，或者简称为\emph{$V$ 的流}。

\begin{proposition}[流的自然性]
  设 $M,N$ 是光滑流形，$F:M\to N$ 是光滑映射，$X\in \mathfrak{X}(M)$，
  $Y\in \mathfrak{X}(N)$。令 $\theta$ 是 $X$ 的流，$\eta$ 是 $Y$ 的流。
  如果 $X$ 和 $Y$ 是 $F$-相关的，那么对于每个 $t\in \mathbb{R}$，
  $F(M_t)\subseteq N_t$ 并且 $\eta_t\circ F=F\circ\theta_t$：
  \[
    \begin{tikzcd}
      M_t\arrow[r,"F"]\arrow[d,"\theta_t"'] & N_t\arrow[d,"\eta_t"]\\
      M_{-t}\arrow[r,"F"] & N_{-t}
    \end{tikzcd}  
  \]
\end{proposition} 
\begin{proof}
  根据 \autoref{prop:naturality of integral curve}，对于任意 $p\in M$，
  曲线 $F\circ\theta^{(p)}$ 是 $Y$ 的以 $F(p)$ 为起点的积分曲线，根据积分曲线
  的唯一性，极大积分曲线 $\eta^{(F(p))}$ 至少定义在区间 $\mathcal{D}^{(p)}$
  上并且在这个区间上有 $F\circ\theta^{(p)}=\eta^{(F(p))}$。这意味着
  \[
    p\in M_t\Rightarrow t\in \mathcal{D}^{(p)}  
    \Rightarrow t\in \mathcal{D}^{(F(p))}\Rightarrow F(p)\in N_t,
  \]
  所以 $F(M_t)\subseteq N_t$。并且在 $t\in \mathcal{D}^{(p)}$
  时，有 $F\bigl(\theta^{(p)}(t)\bigr)=\eta^{(F(p))}(t)$，
  这等价于 $\eta_t(F(p))=F(\theta_t(p))$。
\end{proof}

\begin{corollary}[流的微分同胚不变性]
  令 $F:M\to N$ 是微分同胚，如果 $X\in \mathfrak{X}(M)$ 以及
  $\theta$ 是 $X$ 的流，那么 $F_*X$ 的流为任取 $t\in \mathbb{R}$，$\eta_t=F\circ\theta_t\circ F^{-1}$，
  流域满足 $N_t=F(M_t)$。
\end{corollary}

\subsection{完备向量场}

我们已经注意到不是所有的光滑向量场都生成一个全局流，能够生成全局流
的光滑向量场足够重要，所以我们给它们一个名字。我们称一个光滑向量场
是\emph{完备的}当且仅当其能够生成一个全局流，或者等价地说，
它的极大积分曲线对所有的 $t\in \mathbb{R}$ 都有定义。
我们将表明所有的紧支向量场是完备的，因此紧流形上的所有光滑向量场都是完备的。

\begin{lemma}[一致时间引理]
  令 $V$ 是光滑流形 $M$ 上的光滑向量场，$\theta$ 是 $V$ 的流。
  假设存在正数 $\varepsilon$ 使得对于每个 $p\in M$，
  $\theta^{(p)}$ 的定义域包含 $(-\varepsilon,\varepsilon)$，那么 $V$
  是完备的。
\end{lemma}
\begin{proof}
  假设这样的 $V$ 不是完备的，即存在 $p\in M$ 使得 $\theta^{(p)}$ 的定义域
  $\mathcal{D}^{(p)}$ 是有上界或者有下界的，不妨设开集 $\mathcal D^{(p)}$ 有上界。令 $b=\sup \mathcal{D}^{(p)}$，
  那么对于正数 $\varepsilon$，存在 $t_0$ 使得 $b-\varepsilon<t_0<b$
  且 $t_0\in \mathcal D^{(p)}$。令 $q=\theta^{(p)}(t_0)$。
  根据假设，$\theta^{(q)}$ 的定义域包含 $(-\varepsilon,\varepsilon)$。
  令 $\gamma:(-\varepsilon,t_0+\varepsilon)\to M$ 为
  \[
    \gamma(t)=\begin{cases}
      \theta^{(p)}(t) & -\varepsilon<t< b,\\
      \theta^{(q)}(t-t_0) & t_0-\varepsilon< t<t+\varepsilon.
    \end{cases}
  \]
  首先，在两个定义重合的时候，即 $t_0-\varepsilon<t<b$ 的时候，
  有 $t\in \mathcal{D}^{(p)}$，所以 $\theta^{(q)}(t-t_0)
  =\theta(t-t_0,\theta(t_0,p))=\theta^{(p)}(t)$，
  所以 $\gamma$ 是良定义的。再根据平移引理，所以 $\gamma$
  是以 $p$ 为起点的一条积分曲线，但是 $t_0+\varepsilon>b$，
  这与 $\theta^{(p)}$ 的极大性矛盾。
\end{proof}

\begin{theorem}
  光滑流形上的紧支光滑向量场是完备的。
\end{theorem}
\begin{proof}
  假设 $V$ 光滑流形 $M$ 上的光滑紧支向量场，$K=\supp V$。
  对于每个 $p\in K$，都存在一个邻域 $U_p$ 和正数 $\varepsilon_p$
  使得 $V$ 的流至少定义在 $(-\varepsilon_p,\varepsilon_p)\times U_p$ 上。
  根据 $K$ 的紧性，存在有限多个 $U_{p_1},\dots,U_{p_k}$ 覆盖 $K$。
  令 $\varepsilon=\min\{\varepsilon_{p_1},\dots,\varepsilon_{p_k}\}$，
  这表明以 $K$ 中点为起点的每条极大积分曲线至少定义在 $(-\varepsilon,\varepsilon)$
  上。因为在 $M\smallsetminus K$ 上 $V$ 恒为零，所以以 $M\smallsetminus K$ 
  中点为起点的每条极大积分曲线都可以定义在 $\mathbb{R}$ 上。于是
  $V$ 满足一致时间引理，所以是完备向量场。
\end{proof}

\begin{corollary}
  紧流形上的光滑向量场是完备的。
\end{corollary}

李群上的左不变向量场构成了另一类重要的完备向量场。

\begin{theorem}
  李群上的左不变向量场是完备的。
\end{theorem}
\begin{proof}
  令 $G$ 是李群，$X\in\Lie(G)$，$\theta:\mathcal{D}\to G$ 是 $X$ 的流。
  那么存在 $\varepsilon>0$ 使得 $\theta^{(e)}$ 在 $(-\varepsilon,\varepsilon)$ 上有定义。

  任取 $g\in G$，那么 $X$ 与自身是 $L_g$-相关的，根据积分曲线的自然性，
  所以 $L_g\circ \theta^{(e)}$ 是 $X$ 的以 $g$ 为起点的积分曲线，
  故 $\theta^{(g)}$ 在 $(-\varepsilon,\varepsilon)$ 上有定义，再根据
  一致时间引理，所以 $X$ 是完备的。
\end{proof}

\begin{lemma}[逃脱引理]
  设 $M$ 是光滑流形并且 $V\in \mathfrak{X}(M)$。如果 $\gamma:J\to M$
  是 $V$ 的一条极大积分曲线并且定义域 $J$ 有有限的上确界 $b$，那么
  对于任意 $t_0\in J$，$\gamma\bigl([t_0,b)\bigr)$ 不被 $M$
  的任意紧子集包含。
\end{lemma}
\begin{proof}
  设某个 $t_0\in J$ 使得 $\gamma\bigl([t_0,b)\bigr)$ 被某个紧子集 $K$ 包含。
  取 $[t_0,b)$ 中的一个点列 $\{t_n\}$ 使得 $t_n\to b$，
  那么此时存在 $p\in K$ 使得 $\gamma(t_n)\to p$。
  设 $\theta: \mathcal{D}\to M$ 是 $V$ 的流， $\varepsilon>0$ 和 $p$
  处的邻域 $U$ 使得 $(-\varepsilon,\varepsilon)\times U\subseteq \mathcal{D}$。
  于是存在足够大的 $n$ 使得 $b-\varepsilon<t_n<b$ 并且 $\gamma(t_n)\in U$，
  定义 $\tilde{\gamma}:J\cup (t_n-\varepsilon,t_n+\varepsilon)\to M$，
  为
  \[
    \tilde{\gamma}(t)=\begin{cases}
      \gamma(t) & t\in J,\\
      \theta^{(\gamma(t_n))}(t-t_n) & t_n-\varepsilon<t<t_n+\varepsilon,
    \end{cases}
  \]
  注意我们有 $\theta^{(\gamma(0))}=\gamma$。此时 $\tilde \gamma$ 也是 $V$
  的积分曲线且比 $\gamma$ 的定义域更大，矛盾。  
\end{proof}

\section{流出}

下面的定理描述了流在某些子流形附近的行为。

\begin{theorem}[流出定理]
  设 $M$ 是光滑流形，$S\subseteq M$ 是 $k$-维嵌入子流形，$V\in \mathfrak{X}(M)$
  是与 $S$ 处处不相切的光滑向量场。令 $\theta:\mathcal{D}\to M$ 是 $V$ 的流，
  $\mathcal{O}=(\mathbb{R}\times S)\cap \mathcal{D}$，$\varPhi=\theta|_{\mathcal{O}}$。
  \begin{enumerate}
    \item $\varPhi:\mathcal{O}\to M$ 是光滑浸入。
    \item $\partial/\partial t\in \mathfrak{X}(\mathcal{O})$ 和 $V$ 是 $\varPhi$-相关的。
    \item 存在一个光滑正值函数 $\delta:S\to \mathbb{R}$ 使得 $\varPhi$ 在 $\mathcal{O}_\delta$ 上的限制是单射，
    其中 $\mathcal{O}_\delta\subseteq \mathcal{O}$ 是流域
    \begin{equation}
      \mathcal{O}_\delta=\bigl\{(t,p)\in \mathcal{O}\bigm| |t|<\delta(p)\bigr\}.
    \end{equation}
    因此，$\varPhi(\mathcal{O}_\delta)$ 是 $M$ 的包含 $S$ 的浸入子流形，并且 $V$
    与这个子流形相切。
    \item 如果 $S$ 有余维数 $1$，那么 $\varPhi|_{\mathcal{O}_\delta}$ 是到
    $M$ 的一个开子流形的微分同胚。
  \end{enumerate}
\end{theorem}
\begin{remark}
  子流形 $\varPhi(\mathcal{O}_\delta)\subseteq M$ 被称为 \emph{$S$ 沿 $V$ 的流出}。
\end{remark}
\begin{proof}
  首先我们证明 (2)。固定 $p\in S$，令 $\sigma:\mathcal{D}^{(p)}\to \mathbb{R}\times S$
  是曲线 $\sigma(t)=(t,p)$，那么 $\varPhi\circ\sigma(t)=\theta(t,p)$ 是 $V$ 的积分曲线，
  所以对于任意 $t_0\in \mathcal{D}^{(p)}$ 有
  \[
    d\varPhi_{(t_0,p)}\left(\frac{d}{dt}\bigg|_{(t_0,p)}\right)=
    (\varPhi\circ\sigma)'(t_0)=V_{\varPhi(t_0,p)}.
  \]

  然后我们证明 (1)。
\end{proof}

\subsection{奇异点和正则点}

如果 $V$ 是 $M$ 上的向量场，点 $p\in M$ 使得 $V_p=0$，那么 $p$ 被称为 $V$
的\emph{奇异点}，否则被称为\emph{正则点}。下面的命题表明由正则点和奇异点
出发的积分曲线的行为是不同的。

\begin{proposition}\label{prop:regular point and singular point}
  令 $V$ 是光滑流形 $M$ 上的光滑向量场，$\theta:\mathcal{D}\to M$
  是 $V$ 生成的流。如果 $p\in M$ 是 $V$ 的奇异点，那么 $\mathcal{D}^{(p)}=\mathbb{R}$
  并且 $\theta^{(p)}$ 是常值曲线 $\theta^{(p)}\equiv p$。如果 $p$ 是正则点，
  那么 $\theta^{(p)}:\mathcal{D}^{(p)}\to M$ 是光滑浸入。
\end{proposition}
\begin{proof}
  如果 $V_p=0$，那么 $\gamma(t)\equiv p$ 显然满足 $\gamma'(t)=0=V_p=V_{\gamma(t)}$，
  所以 $\gamma$ 是 $V$ 的以 $p$ 为起点的极大积分曲线，根据极大性和唯一性，所以
  $\theta^{(p)}=\gamma$。

  对于第二点，我们证明其逆否命题：若 $\theta^{(p)}$ 不是光滑浸入，那么 $p$
  是奇异点。$\theta^{(p)}$ 不是光滑浸入意味着存在 $s\in \mathcal{D}^{(p)}$
  使得 $\bigl(\theta^{(p)}\bigr)'(s)=0$。记 $q=\theta^{(p)}(s)$，
  那么 $V_q=0$，根据第一点，我们有 $\mathcal{D}^{(q)}=\mathbb{R}$ 并且
  $\theta^{(q)}(t)\equiv q$。由于 $\mathcal{D}^{(q)}=\mathcal{D}^{(p)}-s$，
  所以 $\mathcal{D}^{(p)}=\mathbb{R}$，并且对于任意 $t\in \mathbb{R}$，有
  \[
    \theta^{(p)}(t)=\theta(t-s,q)=q,
  \]
  令 $t=0$ 即得 $p=q$，即 $p$ 是奇异点。
\end{proof}

如果 $\theta:\mathcal{D}\to M$ 是流，点 $p\in M$ 满足对于任意 $t\in \mathcal{D}^{(p)}$
有 $\theta(t,p)=p$，那么称 $p$ 是 $\theta$ 的\emph{平衡点}。
\autoref{prop:regular point and singular point} 表明光滑流的平衡点恰好是
其无穷小生成元的奇异点。

下面的定理完全描述了在微分同胚意义下，向量场在正则点附近的形态。

\begin{theorem}[正则点附近的典范形式]
  令 $V$ 是光滑流形 $M$ 上的光滑向量场，$p\in M$ 是 $V$ 的正则点。
  那么存在 $p$ 的某个邻域上的光滑坐标 $(s^i)$ 使得 $V$ 有坐标表示
  $\partial/\partial s^1$。如果 $S\subseteq M$ 是任意嵌入超曲面且
  $p\in S$ 时 $V_p\notin T_pS$，那么这个坐标可以选取为让 $s^1$ 是 $S$
  的局部定义函数。
\end{theorem}
\begin{proof}
  如果没有给定超曲面 $S$，那么任取以 $p$ 为中心的光滑坐标卡 $(U,(x^i))$，
  我们令 $S\subseteq U$ 是 $x^j=0$ 定义的超曲面，其中 $j$ 使得 $V^j(p)\neq 0$。
  （由于 $p$ 是正则点，这样的 $j$ 总是存在）

  无论 $S$ 是事先给定的还是按照上述方法构造的，因为 $V_p\notin T_pS$，所以可以适当
  缩小 $S$ 适当 $V$ 与 $S$ 处处不相切。流出定理表明存在一个流域 $\mathcal{O}_\delta\subseteq \mathbb{R}\times S$
  使得 $V$ 的流可以限制为从 $\mathcal{O}_\delta$ 到包含 $S$ 的一个开集 $W\subseteq M$
  的微分同胚 $\varPhi$。存在 $(0,p)\in \mathcal{O}_\delta$ 的一个积邻域 $(-\varepsilon,\varepsilon)\times W_0$。
  选取一个光滑局部参数化 $X:\Omega\to S$，其像集包含 $W_0$，$\Omega$ 是 $\mathbb{R}^{n-1}$
  的开子集，$\Omega$ 上的坐标记为 $(s^2,\dots,s^n)$。定义映射 $\varPsi:(-\varepsilon,\varepsilon)\times \Omega\to M$
  为
  \[
    \varPsi(t,s^2,\dots,s^n)=\varPhi(t,X(s^2,\dots,s^n)),
  \]
  那么 $\varPsi$ 是到 $p\in M$ 的某个邻域上的微分同胚。此时 $(t,s^2,\dots,s^n)\mapsto (t,X(s^2,\dots,s^n))$
  把 $\partial/\partial t$ 推前到自身并且 $\varPhi_*(\partial/\partial t)=V$，
  所以 $\varPsi_*(\partial/\partial t)=V$。所以 $\varPsi^{-1}$ 就是一个光滑坐标卡
  使得 $V$ 有坐标表示 $\partial/\partial t$。
\end{proof}

典范形式定理的证明实际上告诉了我们如何寻找使得向量场 $V$ 具有典范形式的坐标：
从一个超曲面 $S$ 开始，$V$ 与 $S$ 处处不相切，局部参数化 $X:\Omega\to S$，
构造复合映射 $\varPsi(t,s)=\theta_t(X(s))$，那么 $\varPsi^{-1}$ 便是需要寻找
的坐标。

\begin{example}
  令 $W=x\partial/\partial y-y\partial/\partial x$ 是 $\mathbb{R}^2$ 上的
  光滑向量场，$W$ 的流 $\theta: \mathbb{R}\times \mathbb{R}^2\to \mathbb{R}^2$ 为
  \[
    \theta(t,(x,y))=(x\cos t-y\sin t,x\sin t+y\cos t).
  \]
  点 $(1,0)$ 是 $W$ 的正则点。由于 $W_{(1,0)}=\partial/\partial y$，所以选取
  超曲面 $S$ 为 $x$-轴。令 $X(s)=(s,0)$ 是 $S$ 的参数化，那么定义 $\varPsi:\mathbb{R}^2\to \mathbb{R}^2$
  为
  \[
    \varPsi(t,s)=\theta_t(s,0)=(s\cos t,s\sin t),
  \]
  在 $(1,0)$ 的某个邻域上可以得到逆映射
  \[
    (t,s)=\varPsi^{-1}(x,y)=\left(\arctan y/x, \sqrt{x^2+y^2}\right),
  \]
  不难验证在这个坐标下有 $W=\partial/\partial t$。
\end{example}




\section{李导数}

我们已经知道如何理解流形上实值函数的方向导数。对于一个切向量 $v\in T_pM$，
其可以作用在一个光滑函数 $f$ 上得到一个数 $vf$，这个数我们便可以解释为 $f$
在 $p$ 处的一个方向导数。在第三章中我们已经看到这个数可以解释为 $f$
沿着任意初速度为 $v$ 的曲线的导数。

如何定义向量场的方向导数？在 Euclid 空间中，对于一个光滑向量场 $W$
在向量 $v\in T_p \mathbb{R}^n$ 方向上的导数是可以直接定义的，即
\[
  D_vW(p)=\frac{d}{dt}\bigg|_{t=0}W_{p+tv}=
  \lim_{t\to 0}\frac{W_{p+tv}-W_p}{t}.
\]
简单的计算表明 $D_vW(p)$ 可以用分量计算为
\[
  D_vW(p)=D_vW^i(p)\frac{\partial}{\partial x^i}\bigg|_p.
\]

不幸的是，上述定义严重依赖于 $\mathbb{R}^n$ 是一个向量空间，所以切向量
$W_{p+tv}$ 和 $W_p$ 可以都视为 $\mathbb{R}^n$ 中的元素。而对于一般的流形，
减法 $W_{p+tv}-W_p$ 是没有意义的。为了处理这个问题，首先，我们可以把 $p+tv$
替换为以 $p$ 为起点、初速度为 $v$ 的曲线 $\gamma$。但是此时减法依然没有意义，
因为 $W_{\gamma(t)}\in T_{\gamma(t)}M, W_{\gamma(0)}\in T_{\gamma(0)}M$
是两个不同的切空间的元素。在 Euclid 空间中不同切空间的元素恰好可以彼此等同，
但是在流形上，无法以独立于坐标的方式理解这样的方向导数。

如果我们把向量 $v\in T_pM$ 替换为一个向量场 $V\in \mathfrak X(M)$，这个
问题则可以被解决。我们给出下面的定义。设 $M$ 是光滑流形，$V$ 是光滑向量场，
$\theta$ 是 $V$ 的流。对于任意光滑向量场 $W$，定义 $M$ 上的向量场 $\mathcal L_VW$
为
\[
  (\mathcal L_VW)_p=\frac{d}{dt}\bigg|_{t=0}d(\theta_{-t})_{\theta_t(p)}\bigl(W_{\theta_t(p)}\bigr)
  =\lim_{t\to 0}\frac{d(\theta_{-t})_{\theta_t(p)}\bigl(W_{\theta_t(p)}\bigr)-W_p}{t},
\]
$\mathcal L_VW$ 被称为 $W$ 相对于 $V$ 的\emph{李导数}。对于足够小的 $t$，
上述减法总是有意义：因为 $\theta^{(p)}$ 定义在 $0$ 的某个开区间上，所以 
$d(\theta_{-t})_{\theta_t(p)}\bigl(W_{\theta_t(p)}\bigr)$ 和 $W_p$ 都是 $T_pM$ 中的向量。
此外，不难发现，上述定义即利用 $\theta_{-t}$ 的推前，因为
\[
\bigl((\theta_{-t})_*W\bigr)_p=d(\theta_{-t})_{\theta_t(p)}(W_{\theta_t(p)}).
\]

\begin{lemma}\label{lemma:lie derivation is smooth}
  设 $M$ 是带边或者无边光滑流形，$V,W\in \mathfrak X(M)$。如果 $\partial M\neq\emptyset$，
  还要假设 $V$ 与 $\partial M$ 相切。那么对于每个 $p\in M$，$(\mathcal L_VW)_p$ 存在且
  $\mathcal L_VW$ 是光滑向量场。
\end{lemma}
\begin{proof}
  令 $\theta$ 是 $V$ 的流，对于任意 $p\in M$，令 $(U,(x^i))$ 是包含 $p$ 的坐标卡。
  选取包含 $0$ 的一段开区间 $J_0$ 和开集 $U_0\subseteq U$ 使得 $\theta$
  是 $J_0\times U_0$ 到 $U$ 的映射。对于 $(t,x)\in J_0\times U_0$，记 $\theta$
  的分量函数为 $\bigl(\theta^1(t,x),\dots,\theta^n(t,x)\bigr)$。那么对于任意
  $(t,x)\in J_0\times U_0$，映射 $d(\theta_{-t})_{\theta_t(x)}:T_{\theta_t(x)}M\to T_{x}M$
  的表示矩阵为
  \[
    \left(\frac{\partial \theta^i}{\partial x^j}(-t,\theta(t,x))\right).
  \]
  因此
  \[
    d(\theta_{-t})_{\theta_t(x)}\bigl(W_{\theta_t(x)}\bigr)
    =\frac{\partial \theta^i}{\partial x^j}(-t,\theta(t,x))W^j(\theta(t,x))
    \frac{\partial}{\partial x^i}\bigg|_{x},
  \]
  这表明 $(\mathcal L_VW)_x$ 是光滑依赖于 $x$ 的。
\end{proof}

$\mathcal L_VW$ 的定义在计算中并没有很大的作用，因为向量场的流通常难以计算或者明确写出。
幸运的是有一个简单的公式可以计算李导数而不用找出流。

\begin{theorem}\label{thm:lie derivation}
  如果 $M$ 是光滑流形，$V,W\in\mathfrak X(M)$，那么 $\mathcal L_VW=[V,W]$。
\end{theorem}
\begin{proof}
  假设 $V,W\in\mathfrak X(M)$，令 $\mathcal R(V)\subseteq M$ 是 $V$ 的正则点的集合
  （使得 $V_p\neq 0$ 的 $p\in M$ 的集合）。根据 $V$ 的连续性，注意到 $\mathcal R(V)$ 是 $M$ 的开子集，
  且 $\mathcal R(V)$ 的闭包是 $V$ 的支集。我们将 $p\in M$ 分三种情况证明 $(\mathcal L_VW)_p=[V,W]_p$。
  
  \textsc{Case 1}：$p\in\mathcal R(V)$。在这种情况下，我们选取 $p$ 的邻域上的一个光滑坐标
  $(u^i)$ 使得 $V$ 有坐标表示 $V=\partial/\partial u^1$。在这个坐标中，$V$ 的流是
  $\theta_t(u)=\bigl(u^1+t,u^2,\dots,u^n\bigr)$。对于每个 $t$，$\theta_{-t}$ 在每个
  $\theta_t(x)$ 处的 Jacobi 矩阵是单位阵。因此，对于 $u\in U$，有
  \begin{align*}
    d(\theta_{-t})_{\theta_t(u)}(W_{\theta_t(u)})&=
    d(\theta_{-t})_{\theta_t(u)}\left(
      W^i\bigl(u^1+t,u^2,\dots,u^n\bigr)\frac{\partial}{\partial u^i}\bigg|_{\theta_t(u)}
    \right)\\
    &=W^i\bigl(u^1+t,u^2,\dots,u^n\bigr)\frac{\partial}{\partial u^i}\bigg|_{u}.
  \end{align*}
  根据李导数的定义，我们得到
  \[
    (\mathcal L_VW)_u=\frac{d}{dt}\bigg|_{t=0}d(\theta_{-t})_{\theta_t(u)}(W_{\theta_t(u)})
    =\frac{\partial W^i}{\partial u^1}\bigl(u^1,\dots,u^n\bigr)\frac{\partial}{\partial u^i}\bigg|_{u},
  \]
  这与 \autoref{prop:coordinate formula for lie bracket} 的坐标表示一致，所以
  $(\mathcal L_VW)_u=[V,W]_u$。

  \textsc{Case 2}：$p\in\supp V$。因为 $\supp V$ 是 $\mathcal R(V)$ 的闭包，那么根据连续性
  即可得到 $p\in\supp V$ 的时候有 $(\mathcal L_VW)_p=[V,W]_p$。

  \textsc{Case 3}：$p\in M\smallsetminus \supp V$。此时 $V$ 在 $p$ 的某个邻域上恒为零。
  这表明任意 $\theta_t$ 在 $p$ 的这个邻域上是单位映射，故 $d(\theta_{-t})_{\theta_t(p)}(W_{\theta_t(p)})=W_p$，
  即 $(\mathcal L_VW)_p=0$。另一方面，根据 \autoref{prop:coordinate formula for lie bracket}，
  也有 $[V,W]_p=0$。
\end{proof}

\autoref{thm:lie derivation} 给出了两个向量场的李括号的几何解释：第二个向量场沿着第一个向量场
的方向导数。由李括号的性质，我们还可以立即得到一些李导数的不明显的性质。

\begin{corollary}
  设 $M$ 是带边或者无边光滑流形，$V,M,X\in\mathfrak X(M)$。
  \begin{enumerate}
    \item $\mathcal L_VW=-\mathcal L_WV$。
    \item $\mathcal L_V[W,X]=[\mathcal L_VW,X]+[W,\mathcal L_VX]$。
    \item $\mathcal L_{[V,W]}X=\mathcal L_V\mathcal L_WX-\mathcal L_W\mathcal L_VX$。
    \item 如果 $g\in C^\infty(M)$，那么 $\mathcal L_V(gW)=(Vg)W+g\mathcal L_VW$。
    \item 如果 $F:M\to N$ 是微分同胚，那么 $F_*(\mathcal L_VX)=\mathcal L_{F_*V}F_*X$。
  \end{enumerate}
\end{corollary}

\begin{proposition}\label{prop:derivation of theta-t}
  设 $M$ 是带边或者无边光滑流形，$V,W\in\mathfrak X(M)$。如果 $\partial M\neq\emptyset$，
  那么还要假设 $V$ 与 $\partial M$ 相切。令 $\theta$ 是 $V$ 的流。对于 $\theta$ 定义域中的
  任意 $(t_0,p)$，有
  \begin{equation}
    \frac{d}{dt}\bigg|_{t=t_0}d(\theta_{-t})_{\theta_t(p)}(W_{\theta_t(p)})
    =d(\theta_{-t_0})\left((\mathcal L_VW)_{\theta_{t_0}p}\right).
  \end{equation}
\end{proposition}
\begin{proof}
  任取 $p\in M$，$\mathcal D$ 是 $\theta$ 的流域，定义映射 $X:\mathcal D^{(p)}\to T_pM$ 为 
  $X(t)=d(\theta_{-t})_{\theta_t(p)}(W_{\theta_t(p)})$，\autoref{lemma:lie derivation is smooth}
  的证明表明 $X$ 是光滑的。我们有
  \begin{align*}
    X'(t_0)&=\frac{d}{ds}\bigg|_{s=0}X(t_0+s)=\frac{d}{ds}\bigg|_{s=0}
    d(\theta_{-t_0-s})_{\theta_{t_0+s}(p)}\bigl(W_{\theta_{t_0+s}(p)}\bigr)\\
    &=\frac{d}{ds}\bigg|_{s=0}
    d(\theta_{-t_0})_{\theta_{t_0}(p)}\circ d(\theta_{-s})_{\theta_s(\theta_{t_0}(p))}\bigl(W_{\theta_s(\theta_{t_0}(p))}\bigr)\\
    &=d(\theta_{-t_0})_{\theta_{t_0}(p)}\left((\mathcal L_VW)_{\theta_{t_0}(p)}\right),
  \end{align*}
  最后一个等号是因为 $d(\theta_{-t_0})$ 是与 $s$ 无关的线性映射。
\end{proof}

\section{可交换的向量场}

令 $M$ 是光滑流形，$V,W\in \mathfrak{X}(M)$。如果对于任意光滑函数 $f$，有 
$VWf=WVf$，那么我们说 $V$ 和 $W$ 是\emph{可交换的}。等价地说， $V,W$ 可交换当且仅当
$[V,W]\equiv 0$。如果 $\theta$ 是一个光滑流，如果向量场 $W$ 在任意 $t$ 处
与自身都是 $\theta_t$-相关的，那么我们说 $W$ 在 $\theta$ 下是\emph{不变的}。
等价地说，$W|_{M_t}$ 与 $W|_{M_{-t}}$ 是 $\theta_t$-相关的，或者
对于任意 $\theta$ 定义域中的 $(t,p)$，有 $(\theta_t)_*(W)|_{\theta_t(p)}=d (\theta_t)_{p}(W_p)=W_{\theta_t(p)}$。
下面的命题表明这两个概念有密切的相关性。

\begin{theorem}\label{thm:commuting vector fields}
  对于光滑流形 $M$ 上的光滑向量场 $V,W$，下面的说法等价。
  \begin{enumerate}
    \item $V$ 和 $W$ 是可交换的。
    \item $W$ 在 $V$ 的流下不变。
    \item $V$ 在 $W$ 的流下不变。
  \end{enumerate}
\end{theorem}
\begin{proof}
  假设 $V,W\in \mathfrak{X}(M)$ 以及 $\theta$ 是 $V$ 的流。若 $W$ 在 $\theta$
  下不变，那么对于任意 $p\in M$，$(-t,\theta_t(p))$ 在 $\theta$ 的定义域中，所以
  \[
    d(\theta_{-t})_{\theta_t(p)}\bigl(W_{\theta_t(p)}\bigr)=W_{p},
  \]
  所以李导数 $(\mathcal{L}_VW)_p=0$，即 $[V,W]_p=0$。
  对于 $V$ 在 $W$ 的流下不变的情况同理。

  若 $[V,W]\equiv 0$，那么 $\mathcal{L}_VW=0$。任取 $p\in M$，对于
  $t\in \mathcal{D}^{(p)}$，令 $X(t)=d(\theta_{-t})_{\theta_t(p)}\bigl(W_{\theta_t(p)}\bigr)$，
  \autoref{prop:derivation of theta-t} 表明 $X'(t)\equiv 0$，所以 $X(t)=X(0)=W_p$。
  于是 $d(\theta_t)_p(W_p)=d(\theta_t)_p\circ X(t)=W_{\theta_t(p)}$，即 $W$
  在 $V$ 的流下不变。对于 $V$ 在 $W$ 的流下不变的情况同理。
\end{proof}

\begin{corollary}
  每个光滑向量场在其自身的流下是不变的。
\end{corollary}

下面的定理表明两个向量场交换当且仅当它们的流交换。在阐述这个定理之前，
我们需要明确这个概念。假设 $V$ 和 $W$ 是 $M$ 上的光滑向量场，$\theta$
和 $\psi$ 分别是它们的流。如果 $V$ 和 $W$ 是完备的，显然它们的流
可交换应该意味着：对于所有的 $s,t\in \mathbb{R}$ 有 $\theta_t\circ\psi_s=\psi_s\circ\theta_t$。
但是，如果 $V,W$ 有一个不完备，我们至多只能要求上述式子在有定义的时候成立。
不幸的是，即使两个向量场可交换，它们的流也不一定在这个显然的意义下可交换，
也就是说存在可交换的向量场 $V$ 和 $W$ 以及合适的 $t,s,p$ 使得 $\theta_t\circ\psi_s(p)$ 
和 $\psi_s\circ\theta_t(p)$ 都有定义但是并不相等。问题在于：
如果 $\theta_t\circ\psi_s(p)$ 在 $t=t_0$ 和 $s=s_0$ 处有定义，那么根据流域
的性质，其一定在包含 $0$ 和 $t_0$ 的开区间上有定义，但是同样的论证对于 $s$
不成立，即可能存在 $0$ 和 $s_0$ 之间的某个 $s$ 使得 $V$ 的以 $\psi_s(p)$ 开始
的积分曲线并不能延拓到 $t=t_0$。

因此，我们给出下面的定义。设 $\theta$ 和 $\psi$ 是 $M$ 上的流，对于每个 $p\in M$，
假设 $J$ 和 $K$ 是包含 $0$ 的开区间，每当 $J,K$ 使得表达式 $\theta_t\circ\psi_s(p)$
和 $\psi_s\circ\theta_t(p)$ 之一在所有的 $(s,t)\in J\times K$ 上有定义的时候，
都会使得二者都有定义且相等，此时我们说 $\theta$ 和 $\psi$ 是\emph{可交换的}。

\begin{theorem}
  两个光滑向量场可交换当且仅当它们的流可交换。
\end{theorem}
\begin{proof}
  令 $V,W$ 是光滑流形 $M$ 上的光滑向量场，$\theta,\psi$ 分别是它们的流。
  假设 $V$ 和 $W$ 是可交换的。任取 $p\in M$，设 $J$ 和 $K$ 是包含 $0$ 的开区间且
  使得 $\psi_s\circ\theta_t(p)$ 对于所有的 $(s,t)\in J\times K$ 有定义。
  根据 \autoref{thm:commuting vector fields}，$V$ 在 $\psi$ 下不变。
  固定 $s\in J$，令 $\gamma:K\to M$ 为 $\gamma(t)=\psi_s(\theta_t(p))=\psi_s\circ\theta^{(p)}(t)$，那么
  $\gamma(0)=\psi_s(p)$，并且
  \[
    \gamma'(t)=d(\psi_s)_{\theta_t(p)}\circ\bigl(\theta^{(p)}\bigr)'(t)
    =d(\psi_s)_{\theta_t(p)}\bigl(V_{\theta_t(p)}\bigr)
    =V_{\psi_s\circ\theta_t(p)}=V_{\gamma(t)},
  \]
  所以 $\gamma(t)$ 是 $V$ 的以 $\psi_s(p)$ 为起点的积分曲线。根据积分曲线
  的唯一性，所以
  \[
    \gamma(t)=\theta^{\left(\psi_s(p)\right)}(t)=\theta_t\circ\psi_s(p),
  \]
  即 $\theta$ 和 $\psi$ 可交换。

  反之，若 $\theta$ 和 $\psi$ 可交换。任取 $p\in M$。选取足够小的 $\varepsilon>0$
  使得 $\psi_s\circ\theta_t(p)$ 在 $|s|<\varepsilon$ 和 $|t|<\varepsilon$ 的时候
  有定义，那么 $\theta$ 和 $\psi$ 可交换表明 $\psi_s\circ\theta_t(p)=\theta_t\circ\psi_s(p)$，
  也即
  \[
    \psi^{\left(\theta_t(p)\right)}(s)=\theta_t\left(\psi^{(p)}(s)\right),
  \]
  两边对 $s$ 微分，我们得到
  \[
    W_{\theta_t(p)}= \left(\theta_t\circ\psi^{(p)}\right)'(0) = d(\theta_t)_{p}\left(W_{p}\right),
  \]
  也即
  \[
    d(\theta_{-t})_{\theta_t(p)}\bigl(W_{\theta_t(p)}\bigr)=W_p,
  \]
  所以 $(\mathcal{L}_VW)_p=0$，即 $V,W$ 可交换。
\end{proof}

\subsection{可交换标架}

假设 $M$ 是光滑 $n$-流形。回顾 $M$ 的一个局部标架指的是一个定义在开集
$U\subseteq M$ 上的向量场的 $n$-元组 $(E_i)$，使得对于每个 $p\in U$，
$(E_i|_p)$ 都构成了 $T_pM$ 的一组基。如果对于所有 $i,j$，都有 $[E_i,E_j]=0$，
那么我们说这是一个 \emph{可交换标架}。

\begin{theorem}[可交换向量场的典范形式]\label{thm:canonical form for vector fields}
  令 $M$ 是一个光滑 $n$-流形，$(V_1,\dots,V_k)$ 是开子集 $W\subseteq M$ 上
  的线性无关的光滑可交换向量场。对于每个 $p\in W$，都存在一个以 $p$
  为中心的光滑坐标卡 $\bigl(U,(s^i)\bigr)$，使得对于每个 $i=1,\dots,k$
  都有 $V_i=\partial/\partial s^i$。如果 $S\subseteq W$ 是嵌入的余维数
  $k$ 的子流形，$p\in S$ 使得 $T_pS$ 是 $\bigl(V_1|_p,\dots,V_k|_p\bigr)$
  张成空间的补空间，那么上述坐标卡可以被选取为使得 $S\cap U$ 
  是 $s^1=\cdots=s^k=0$ 定义的切片。
\end{theorem}









