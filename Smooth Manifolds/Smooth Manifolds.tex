\documentclass[fontset=none]{Notes}

\makeatletter
\DeclareRobustCommand{\em}{%
  \@nomath\em \if b\expandafter\@car\f@series\@nil
  \normalfont \else \bfseries \fi}
\makeatother

\usepackage{tikz-cd,wrapstuff}
\usepackage{siunitx,tikz,nicematrix}
\usepackage[normal]{fixdif}
\usetikzlibrary{matrix,calc}

\input{font.def}

\usepackage[subscriptcorrection,nofontinfo,mtpbb,mtpfrak]{mtpro2}

\tikzcdset{
  arrow style=tikz,
  diagrams={>={Straight Barb[scale=0.8]}}
}

\allowdisplaybreaks[1]

\newlength{\mymathln}
\newcommand{\aligninside}[2]{
  \settowidth{\mymathln}{#2}
  \mathmakebox[\mymathln]{#1}
}

\DeclareMathOperator\Spec{Spec}
\DeclareMathOperator\im{im}
\DeclareMathOperator\nil{nil}
\DeclareMathOperator\rad{rad}
\DeclareMathOperator\Ann{Ann}
\DeclareMathOperator\Max{Max}
\DeclareMathOperator\GL{GL}
\DeclareMathOperator\Orth{O}
\DeclareMathOperator\SO{SO}
\DeclareMathOperator\SU{SU}
\DeclareMathOperator\Lie{Lie}
\DeclareMathOperator\End{End}
\DeclareMathOperator\Int{Int}
\DeclareMathOperator\Tor{Tor}
\DeclareMathOperator\Tr{Tr}
\DeclareMathOperator\Hom{Hom}
\DeclareMathOperator\supp{supp}
\DeclareMathOperator\Id{Id}
\DeclareMathOperator\rk{rank}
\DeclareMathOperator\grad{grad}
\newcommand{\LL}{{\mathrm{L}}}

\newcommand{\ideal}[1]{\mathfrak{#1}}
\newcommand{\mat}[1]{\mathbold{#1}}
\newcommand{\uline}{\underline{\hphantom{X}}}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\lie}[1]{\mathfrak{#1}}

\usepackage{enumitem}

\setlist[enumerate]{nosep}

%\DeclareMathAlphabet\mathcal{OMS}{cmsy}{m}{n}

\newlength\stextwidth
\newcommand\makesamewidth[3][c]{%
  \settowidth{\stextwidth}{#2}%
  \makebox[\stextwidth][#1]{#3}%
}



\begin{document}

\frontmatter

\tableofcontents

\mainmatter

\include{chapters/ch1/smooth manifolds}

\include{chapters/ch2/smooth maps}


\chapter{切向量}

\section{切向量}

以单位球面 $\mathbb{S}^{n-1}\subseteq\mathbb{R}^n$ 为例，我们试图定义
$\mathbb{S}^{n-1}$ 中一点处的“切向量”。在定义这个概念之前，我们先回顾
$\mathbb{R}^n$ 中的元素。对于 $\mathbb{R}^n$ 中的元素，我们通常将它们
视为点，用坐标 $(x^1,\dots,x^n)$ 表示。同时，我们也可以将它们视为向量，
其拥有方向和长度，但是与所处的位置（起点）无关，一个向量 $v=v^ie_i$
可以被视为从任意起点处出发的一个箭头。
对于切向量的定义而言，我们希望这个向量和起点是绑定的，也就是说，在每个点处
都有一个独立的 $\mathbb{R}^n$ 的复制品，当我们谈及一个点 $a$ 处的切向量的时候，
我们想象中这些切向量应该处于 $\mathbb{R}^n$ 的一个复制品中，这个复制品
的原点被平移到 $a$ 处。


\subsection{几何的切向量}

给定 $a\in\mathbb{R}^n$，定义\emph{$a$ 处的几何切空间} $\mathbb{R}_a^n$ 为
集合 $\{a\}\times\mathbb{R}^n=\{(a,v)\,|\, v\in\mathbb{R}^n\}$。
$\mathbb{R}^n$ 中的\emph{几何切向量}指的是 $\mathbb{R}_a^n$ 中的元素。
我们将 $(a,v)$ 简记为 $v_a$ 或者 $v|_a$。显然 $\mathbb{R}_a^n$
是同构于 $\mathbb{R}^n$ 的向量空间。

几何上来看，$a\in\mathbb{S}^{n-1}$ 处的切空间应该是 $\mathbb{R}_a^n$ 的一个子空间，
其与向量 $a$ 正交。但是对于一般的光滑流形而言，我们需要寻找切向量的其他特征来定义一般的切向量的概念。
几何切向量提供了一种新颖的视角。对于任意几何切向量 $v_a\in\mathbb{R}_a^n$，
其诱导了一个映射 $D_{v|_a}:C^\infty(\mathbb{R}^n)\to\mathbb{R}$，其将光滑函数
$f:\mathbb{R}^n\to\mathbb{R}$ 送到 $f$ 在 $a$ 处沿 $v$ 方向的方向导数：
\[
  D_{v|_a}f=D_vf(a)=\left.\frac{d}{dt}\right|_{t=0}f(a+tv).  
\]
$D_{v|_a}$ 是 $\mathbb{R}$ 线性映射，并且满足乘积法则：
\[
  D_{v|_a}(fg)=f(a)D_{v|_a}g+g(a)D_{v|_a}f.
\]
若 $v_a=v^ie_{i}|_a$，那么
\[
  D_{v|_a}f=v^i\frac{\partial f}{\partial x^i}(a)  .
\]

利用切向量的特点，我们可以给出如下定义。设点 $a\in\mathbb{R}^n$，
映射 $w:C^\infty(\mathbb{R}^n)\to\mathbb{R}$ 如果是 $\mathbb{R}$-线性映射并且
满足乘积法则：
\[
  w(fg)=f(a)wg+g(a)wf, 
\]
那么我们说 $w$ 是\emph{$a$ 处的导子}。记 $T_a\mathbb{R}^n$ 为所有
$a$ 处的导子的集合。定义加法和数乘
\[
  (w_1+w_2)f=w_1f+w_2f,\quad (cw)f=c(wf),
\]
$T_a\mathbb{R}^n$ 成为一个向量空间。根据前面的叙述，我们知道
每个切向量都自然地诱导出一个导子，那么导子能否代表所有的切向量？
一个重要的事实是，$T_a\mathbb{R}^n$ 与几何切空间 $\mathbb{R}_a^n$
是同构的。

\begin{lemma}[导子的性质]\label{lemma:property of derivation}
  设 $a\in\mathbb{R}^n$，$w\in T_a\mathbb{R}^n$，$f,g\in C^\infty(\mathbb{R}^n)$。
  \begin{enumerate}
    \item 如果 $f$ 是常值函数，那么 $wf=0$。
    \item 如果 $f(a)=g(a)=0$，那么 $w(fg)=0$。
  \end{enumerate}
\end{lemma}
\begin{proof}
  (1) 设 $f(x)\equiv c$，那么 $f(x)=cf_1(x)$，其中 $f_1(x)\equiv 1$。
  根据导子的乘积法则，有
  \[
    wf_1=w(f_1f_1)=2f_1(a)wf_1=2wf_1,
  \]
  所以 $wf_1=0$，所以 $wf=c(wf_1)=0$。

  (2) 根据乘积法则，有
  \[
    w(fg)=f(a)wg+g(a)wf=0.\qedhere  
  \]
\end{proof}

\begin{proposition}\label{prop:gemotry tangent vector is derivation}
  令 $a\in\mathbb{R}^n$，那么
  \begin{enumerate}
    \item 对于几何切向量 $v_a\in \mathbb{R}_a^n$，映射 $D_{v|_a}:C^\infty(\mathbb{R}^n)\to\mathbb{R}$
    定义了 $a$ 处的一个导子。
    \item 映射 $v_a\mapsto D_{v|_a}$ 给出了 $\mathbb{R}_a^n\to T_a\mathbb{R}^n$ 的同构。
  \end{enumerate}
\end{proposition}
\begin{proof}
  (1) 根据方向导数的性质是显然的。

  (2) 容易验证 $v_a\mapsto D_{v|_a}$ 是线性映射。首先我们说明这是一个单射。
  假设 $v_a\in\mathbb{R}_a^n$ 使得 $D_{v|_a}=0$，即对于任意的 $f\in C^\infty(\mathbb{R}^n)$
  有 $D_vf(a)=D_{v|_a}f=0$。特别地，考虑坐标函数 $x^j:\mathbb{R}^n\to\mathbb{R}$，
  其将点 $x$ 送到第 $j$ 个坐标 $x^j$。设 $v_a=v^i e_i|_a$，那么
  \[
    v^j=v^i\frac{\partial}{\partial x^i}x^j(a)=D_v x^j(a)=D_{v|_a}x^j=  0,
  \]
  所以 $v_a=0$，故 $v_a\mapsto D_{v|_a}$ 是单射。

  下面说明这是一个满射。任取 $w\in T_a\mathbb{R}^n$，令 $v^i=w(x^i)$，
  $v_a=v^ie_i|_a$，我们证明 $w=D_{v|_a}$。对于任意 $f\in C^\infty(\mathbb{R}^n)$，
  根据 Taylor 公式，有
  \begin{align*}
    f(x)={}&f(a)+\sum_{i=1}^n\frac{\partial f}{\partial x^i}(a)(x^i-a^i)\\
    &+\sum_{i,j=1}^n(x^i-a^i)(x^j-a^j)\int_0^1(1-t)\frac{\partial^2 f}{\partial x^i\partial x^j}
    (a+t(x-a))dt,
  \end{align*}
  根据 \autoref{lemma:property of derivation}，所以
  \begin{align*}
    wf&=w(f(a))+\sum_{i=1}^n\frac{\partial f}{\partial x^i}(a)w(x^i-a^i)\\
    &=\sum_{i=1}^n\frac{\partial f}{\partial x^i}(a)w(x^i)=\sum_{i=1}^nv^i
    \frac{\partial f}{\partial x^i}(a)\\
    &=D_{v|_a}f.\qedhere
  \end{align*}
\end{proof}

\begin{corollary}\label{coro:bases of geometry tangent space}
  对于任意 $a\in\mathbb{R}^n$，对于 $1\leq i\leq n$，定义导子
  \[
    \left.\frac{\partial}{\partial x^i}\right|_a:C^\infty(\mathbb{R}^n)\to\mathbb{R},\quad
    \left.\frac{\partial}{\partial x^i}\right|_af=\frac{\partial f}{\partial x^i}(a),
  \]
  那么这 $n$ 个导子构成了 $T_a\mathbb{R}^n$ 的一组基。
\end{corollary}

\subsection{流形上的切向量}

经过上一小节，我们找到了几何的切向量的一个等价刻画，即导子。而
导子的定义可以非常容易地推广到流形上。令 $M$ 是带边或者无边光滑流形，
$p\in M$。一个线性映射 $v:C^\infty(M)\to\mathbb{R}$ 如果满足乘积法则
\[
  v(fg)=f(p)vg+g(p)vf,\quad \forall f,g\in C^\infty(M) , 
\]
那么我们说 $v$ 是\emph{$p$ 处的导子}。所以 $p$ 处的导子的集合记为 $T_pM$，
这是一个向量空间，称为\emph{$M$ 在 $p$ 处的切空间}。$T_pM$ 中的元素
被称为\emph{$p$ 处的切向量}。

与\autoref{lemma:property of derivation} 完全类似地，流形上的切向量也有下面的性质。

\begin{lemma}[流形上切向量的性质]\label{lemma:property of tangent vector}
  设 $M$ 是带边或者无边光滑流形，$p\in M$，$v\in T_pM$，并且 $f,g\in C^\infty(M)$。
  \begin{enumerate}
    \item 如果 $f$ 是常值函数，那么 $vf=0$。
    \item 如果 $f(p)=g(p)=0$，那么 $v(fg)=0$。
  \end{enumerate}
\end{lemma}

考虑到几何切向量是定义流形上切向量的动机，我们应该把 $M$ 在 $p$ 的切向量
想象为与 $M$ 相切的、以 $p$ 为起点的一个“箭头”。当然，涉及切向量的定理必须
基于上述切向量的抽象定义，但是我们的几何直觉应当尽可能的联系几何图像。

\section{光滑映射的微分}\label{sec:differential of map}

对于 Euclid 空间之间的光滑映射，我们知道映射在一个点上的全导数（微分）是一个线性映射，
其代表了在该点附近对光滑映射的“最佳线性近似”。在流形的情况下，也有类似的线性映射，
但是流形不是向量空间，所以这样的线性映射是切空间之间的线性映射。

设 $M,N$ 是带边或者无边光滑流形，$F:M\to N$ 是光滑映射，对于每个 $p\in M$，
我们定义\emph{$F$ 在 $p$ 处的微分}为映射
\[
  dF_p:T_pM\to T_{F(p)}N  ,
\]
给定 $v\in T_pM$，令 $dF_p(v)$ 为 $F(p)$ 处的导子，其把 $f\in C^\infty(N)$
送到
\[
  dF_p(v)(f)=v(f\circ F).  
\]
注意到光滑映射的复合表明 $f\circ F\in C^\infty(M)$，所以上述定义是有意义的。
下面我们验证 $dF_p(v)$ 确实是 $T_{F(p)}N$ 中的元素。
算子 $dF_p(v):C^\infty(N)\to\mathbb{R}$ 是线性的，这是因为 $v$ 是线性的。
任取 $f,g\in C^\infty(N)$，我们有
\begin{align*}
  dF_p(v)(fg)&=v(fg\circ F)=v((f\circ F)(g\circ F))\\
  &=f(F(p))v(g\circ F)+g(F(p))v(f\circ F)\\
  &=f(F(p))dF_p(v)(g)+g(F(p))dF_p(v)(f),
\end{align*}
所以 $dF_p(v)$ 满足乘积法则，故 $dF_p(v)$ 确实是 $N$ 在 $F(p)$ 处的一个导子。

\begin{proposition}[微分的性质]
  令 $M,N,P$ 是带边或者无边光滑流形，$F:M\to N$ 和 $G:N\to P$ 是光滑映射，
  $p\in M$。 
  \begin{enumerate}
    \item $dF_p:T_pM\to T_{F(p)}N$ 是线性映射。
    \item $d(G\circ F)_p=dG_{F(p)}\circ dF_p:T_pM\to T_{G(F(p))}P$。
    \item $d(\Id_M)_p=\Id_{T_pM}:T_pM\to T_pM$。
    \item 若 $F$ 是微分同胚，则 $dF_p:T_pM\to T_{F(p)}N$ 是同构，且
    $(dF_p)^{-1}=d(F^{-1})_{F(p)}$。
  \end{enumerate}
\end{proposition}
\begin{proof}
  (1) 直接验证即可。

  (2) 任取 $v\in T_pM$，$f\in T_{G(F(p))}P$，有
  \begin{align*}
    d(G\circ F)_p(v)(f)&=v(f\circ (G\circ F))=v((f\circ G)\circ F)\\
    &=dF_p(v)(f\circ G)=dG_{F(p)}\bigl(dF_p(v)\bigr)(f)\\
    &=dG_{F(p)}\circ dF_p(v)(f),
  \end{align*}
  所以 $d(G\circ F)_p=dG_{F(p)}\circ dF_p$。

  (3) 任取 $v\in T_pM$，$f\in C^\infty(M)$，有
  \[
    d(\Id_M)_p(v)(f)=v(f\circ\Id_M)=vf,  
  \]
  所以 $d(\Id_M)(v)=v$，即 $d(\Id_M)_p=\Id_{T_pM}$。

  (4) $F$ 是微分同胚表明 $F$ 有光滑逆映射 $F^{-1}:N\to M$，那么
  $F^{-1}\circ F=\Id_M$，根据 (2) 和 (3)，我们有
  \[
    d(F^{-1})_{F(p)}\circ dF_p=d(F^{-1}\circ F)_p=d(\Id_M)_p=\Id_{T_pM},
  \] 
  所以 $dF_p$ 是同构并且 $(dF_p)^{-1}=d(F^{-1})_{F(p)}$。
\end{proof}

下面我们先解决一个技术性的问题，虽然切空间是用整个流形上的光滑函数定义的，
但是对于坐标卡而言，我们需要研究局部的切向量。

\begin{proposition}\label{prop:local property of tangent vector}
  令 $M$ 是带边或者无边光滑流形，$p\in M$，$v\in T_pM$。如果 $f,g\in C^\infty(M)$
  在 $p$ 点的某个邻域上重合，那么 $vf=vg$。
\end{proposition}
\begin{proof}
  令 $h=f-g$，那么 $h$ 在 $p$ 的某个邻域 $U$ 上为零。令 $\psi\in C^\infty(M)$
  是关于 $M\smallsetminus U$ 的支在 $M\smallsetminus \{p\}$ 中的鼓包函数，
  那么函数 $\psi h=h$，且 $\psi(p)=h(p)=0$，于是 \autoref{lemma:property of tangent vector}
  表明 $v h=v(\psi h)=0$，所以 $vf=vg$。
\end{proof}

\begin{proposition}[开子流形的切空间]\label{prop:tangent space of open submanifold}
  令 $M$ 是带边或者无边光滑流形，$U\subseteq M$ 是开子集，$\iota:U\hookrightarrow M$
  是包含映射。对于任意 $p\in U$，微分 $d\iota_p:T_pU\to T_pM$ 是同构。
\end{proposition}
\begin{proof}
  设 $v\in T_pU$ 使得 $d\iota_p(v)=0$，令 $B$ 是 $p$ 的邻域使得 $\bar B\subseteq U$。
  对于任意的 $f\in C^\infty(U)$，其可以延拓为 $\tilde{f}\in C^\infty(M)$ 使得
  $\tilde{f}\big|_B=f$。因为 $f$ 和 $\tilde{f}\big|_U$ 在 $B$ 上重合，根据 \autoref{prop:local property of tangent vector}，
  我们有
  \[
    vf=v\left(\tilde{f}\big|_U\right)=v\left(\tilde{f}\circ\iota\right)=
    d\iota_p(v)\tilde{f}=0,
  \]
  所以 $v=0$，故 $d\iota_p$ 是单射。

  另一方面，任取 $w\in T_pM$，定义算子 $v:C^\infty(U)\to\mathbb{R}$ 为
  $vf=w\tilde{f}$，其中 $\tilde{f}\in C^\infty(M)$ 是 $f$ 在 $B$ 上的任意光滑函数延拓，
  \autoref{prop:local property of tangent vector} 告诉我们算子 $v$ 是良定义的。
  容易验证 $v\in T_pU$。于是对于任意 $g\in C^\infty(M)$，有
  \[
    d\iota_p(v)(g)=v(g\circ\iota)=w\left(\widetilde{g\circ\iota}\right) 
    =wg,
  \]
  最后一个等号是因为 $g$ 和 $\widetilde{g\circ\iota}$ 在 $B$ 上重合。
  这就表明 $d\iota_p$ 是满射。
\end{proof}

给定一个开子集 $U\subseteq M$，对于任意点 $p\in U$，现在我们把
$T_pU$ 和 $T_pM$ 完全等同。这意味着我们做了如下观察：将 
$v\in T_pU$ 和 $d\iota_p(v)\in T_pM$ 等同，即认为 $v$ 作用在
整个流形 $M$ 上的光滑函数而不是 $U$ 上的光滑函数。
由于导子对光滑函数的作用只与该函数在任意小的邻域上的值有关，所以
这种等同是无害的。反过来，这也表明任意切向量 $v\in T_pM$
可以作用在定义在 $p$ 的邻域上的光滑函数，而不一定作用在
定义在整个流形 $M$ 上的光滑函数。

\begin{proposition}[切空间的维数]
  如果 $M$ 是 $n$ 维光滑流形，那么对于每个 $p\in M$，切空间 $T_pM$
  是 $n$ 维向量空间。
\end{proposition}
\begin{proof}
  给定 $p\in M$，设 $(U,\varphi)$ 是包含 $p$ 的一个光滑坐标卡，由于
  $\varphi:U\to\varphi(U)=\hat U\subseteq\mathbb{R}^n$ 是微分同胚，
  所以 $d\varphi_p:T_pU\to T_{\varphi(p)}\hat U$ 是同构，
  \autoref{prop:tangent space of open submanifold} 表明 $T_p M\simeq T_pU$
  以及 $T_{\varphi(p)}\hat U\simeq T_{\varphi(p)}\mathbb{R}^n$，所以
  $\dim T_pM=\dim T_{\varphi(p)}\mathbb{R}^n=n$。
\end{proof}

回顾 \autoref{exa:finite-dim vector space as manifold}，每个有限维向量空间
都有一个自然的光滑结构，并且其独立于基或者范数的选取。下面的命题表明，
向量空间的切空间可以自然地等同为该向量空间自身。

设 $V$ 是有限维向量空间，$a\in V$。对于任意向量 $v\in V$，定义
$D_{v|_a}:C^\infty(V)\to\mathbb{R}$ 为
\[
  D_{v|_a}f=\left.\frac{d}{dt}\right|_{t=0}f(a+tv).
\]

\begin{proposition}[向量空间的切空间]
  设 $V$ 是有限维向量空间，附带标准光滑结构。对于每个点 $a\in V$，
  映射 $v\mapsto D_{v|_a}$ 给出了 $V\to T_aV$ 的典范同构，使得
  对于任意线性映射 $L:V\to W$，下面的图表交换：
  \[
    \begin{tikzcd}[sep=3.2em]
      V\arrow[r,"\simeq"]\arrow[d,"L"'] & T_aV\arrow[d,"dL_a"] \\
      W\arrow[r,"\simeq"'] & T_{La}W
    \end{tikzcd}
  \]
\end{proposition}
\begin{proof}
  一旦我们选取了 $V$ 的一组基，完全仿照 \autoref{prop:gemotry tangent vector is derivation}，
  我们可以证明 $D_{v|_a}$ 确实是导子，并且映射 $v\mapsto D_{v|_a}$ 是同构。

  设 $L:V\to W$ 是线性映射，任选 $V,W$ 的一组基后，$L$ 的坐标表示
  仍然是线性映射，故 $L$ 是光滑映射。最后，直接计算可得
  \begin{align*}
    dL_a\left(D_{v|_a}\right)f&=D_{v|_a}(f\circ L)=\left.\frac{d}{dt}\right|_{t=0}
    f(L(a+tv))\\
    &=\left.\frac{d}{dt}\right|_{t=0}f(La+tLv)=D_{Lv|_{La}}f.\qedhere
  \end{align*}
\end{proof}

非常重要的一点是同构 $V\simeq T_aV$ 是不依赖于基的选取的，出于这一点，
我们可以把有限维向量空间的切向量视为这个空间内的元素。更一般的，如果 $M$
是向量空间 $V$ 的开子流形，我们有同构 $T_pM\simeq T_pV\simeq V$，
也就是说我们可以把 $M$ 的每个切空间都和 $V$ 等同。例如，因为
$\GL(n,\mathbb{R})$ 是向量空间 $M(n,\mathbb{R})$ 的开子流形，所以我们可以
将 $X\in\GL(n,\mathbb{R})$ 处的切空间等同于 $M(n,\mathbb{R})$。

\begin{proposition}[积流形的切空间]
  令 $M_1,\dots,M_k$ 是光滑流形，对于每个 $j$，令 $\pi_j:M_1\times\cdots\times M_k\to M_j$
  是投影。对于任意 $p=(p_1,\dots,p_k)\in M_1\times\cdots\times M_k$，定义映射
  \[
    \alpha:T_p(M_1\times\cdots\times M_k)\to T_{p_1}M_1\oplus \cdots\oplus T_{p_k}M_k  
  \]
  为
  \[
    \alpha(v)=\left(d(\pi_1)_p(v),\dots,d(\pi_k)_p(v)\right),  
  \]
  那么 $\alpha$ 是同构。如果 $M_i$ 是带边光滑流形，结论也正确。
\end{proposition}
\begin{proof}
  不难验证 $\pi_j$ 是光滑映射以及 $\alpha$ 是线性映射。
  令包含映射 $\iota_j:M_j\to M_1\times\cdots\times M_k$ 为
  \[
    \iota_j(x)=(p_1,\dots,x,\dots,p_k),  
  \]
  其中 $x$ 处于第 $j$ 个分量。
  定义线性映射
  \[
    \beta:T_{p_1}M_1\oplus \cdots\oplus T_{p_k}M_k\to T_p(M_1\times\cdots\times M_k)
  \]
  为
  \[
    \beta(v_1,\dots,v_k)=d(\iota_1)_{p_1}(v_1)+\cdots+d(\iota_k)_{p_k}(v_k).
  \]
  那么
  \begin{align*}
    \alpha\circ\beta(v_1,\dots,v_k)&=\left(
      \sum_{i=1}^k d(\pi_1)_p\circ d(\iota_i)_{p_i}(v_i),\dots,
      \sum_{i=1}^k d(\pi_k)_p\circ d(\iota_i)_{p_i}(v_i)
    \right)  \\
    &=\left(\sum_{i=1}^kd(\pi_1\circ\iota_i)_{p_i}(v_i),\dots,\sum_{i=1}^kd(\pi_k\circ\iota_i)_{p_i}(v_i)\right)\\
    &=\left(
      d(\pi_1\circ\iota_1)_{p_1}(v_1),\dots,d(\pi_k\circ\iota_k)_{p_k}(v_k)
    \right)\\
    &=\left(
      d\bigl(\Id_{M_1}\bigr)_{p_1}(v_1),\dots,d\bigl(\Id_{M_k}\bigr)_{p_k}(v_k)
    \right)\\
    &=(v_1,\dots,v_k),
  \end{align*}
  所以 $\alpha$ 是满射。显然
  \[
    \dim   T_p(M_1\times\cdots\times M_k)=\dim T_{p_1}M_1\oplus \cdots\oplus T_{p_k}M_k  ,
  \]
  所以 $\alpha$ 是同构。
\end{proof}

\section{使用坐标进行计算}


现在我们把抽象的微分和切空间的定义落实到计算上，我们将研究如何在局部坐标
使用切向量和微分进行计算。

设 $M$ 是光滑流形，$(U,\varphi)$ 是一个光滑坐标卡，那么 $\varphi$
是 $U$ 到开集 $\hat U=\varphi(U)\subseteq\mathbb{R}^n$ 的微分同胚。微分
$d\varphi_p:T_pM\to T_{\varphi(p)}\mathbb{R}^n$ 是同构。

根据 \autoref{coro:bases of geometry tangent space}，导子 
$\partial/\partial x^1|_{\varphi(p)},\dots,\partial/\partial x^n|_{\varphi(p)}$
构成了 $T_{\varphi(p)}\mathbb{R}^n$ 的一组基。因此，其在
$d\varphi_p$ 下的原像构成 $T_pM$ 的一组基，我们使用
$\partial/\partial x^i|_p$ 来表示它们。也就是说，
我们定义
\[
  \left.\frac{\partial}{\partial x^i}\right|_p=(d\varphi_p)^{-1}\left(
    \left.\frac{\partial}{\partial x^i}\right|_{\varphi(p)}
  \right)=d(\varphi^{-1})_{\varphi(p)}\left(
    \left.\frac{\partial}{\partial x^i}\right|_{\varphi(p)}
  \right)\in T_pM\simeq T_pU.
\]
此时，我们可以发现，其在 $f\in C^\infty(U)$ 上的作用为
\[
  \left.\frac{\partial}{\partial x^i}\right|_pf=
  \left.\frac{\partial}{\partial x^i}\right|_{\varphi(p)}(f\circ\varphi^{-1})
  =\frac{\partial \hat f}{\partial x^i}(\hat p),
\]
其中 $\hat f=f\circ\varphi^{-1}$ 是 $f$ 的坐标表示，$\hat p=(p^1,\dots,p^n)=\varphi(p)$
是 $p$ 的坐标表示。这样的记号看上去容易混淆，实际上对应 Euclid 空间中偏导数的定义，
即 $\partial/\partial x^i|_p$ 计算了函数 $f$ (的坐标表示) 在点 $p$ (的坐标表示) 处
的第 $i$ 个偏导数。切向量 $\partial/\partial x^i|_p$ 被称为
与给定坐标系相关的\emph{$p$ 处的坐标向量}。若 $M=\mathbb{R}^n$，
局部坐标取标准坐标 $(\mathbb{R}^n,\Id_{\mathbb{R}^n})$，此时
切向量 $\partial/\partial x^i|_p$ 就是偏导数算子。

因此，任意切向量 $v\in T_pM$ 可以唯一地表示为一个线性组合
\[
  v=v^i\!\left.\frac{\partial}{\partial x^i}\right|_p.
\]
这组基 $\left(\partial/\partial x^i|_p\right)$ 被称为\emph{$T_pM$ 的坐标基}，
实数 $(v^1,\dots,v^n)$ 被称为 $v$ 相对于这个坐标基的\emph{分量}。
如果 $v$ 是已知的，用 $x^j\in C^\infty(U)$ 表示坐标函数，将
$x\in U$ 送到 $\varphi(x)\in\mathbb{R}^n$ 的第 $i$ 个分量，那么
\[
  v(x^j)=v^i\!\left.\frac{\partial}{\partial x^i}\right|_px^j=
  v^i\frac{\partial x^j}{\partial x^i}(\hat p)=v^j.
\]


\subsection{使用坐标计算微分}

现在我们研究微分在坐标下的表示。首先考虑光滑映射 $F:U\to V$，
其中 $U\subseteq\mathbb{R}^n$，$V\subseteq\mathbb{R}^m$ 是开集。
对于任意 $p\in U$，我们来确定 $dF_p:T_p\mathbb{R}^n\to T_{F(p)}\mathbb{R}^m$
在坐标基下的表示矩阵。使用 $(x^1,\dots,x^n)$ 表示定义域上的坐标，
$(y^1,\dots,y^m)$ 表示值域上的坐标，那么我们可以计算得到
\begin{align*}
  dF_p\left(\left.\frac{\partial}{\partial x^i}\right|_p\right)f&=
  \left.\frac{\partial}{\partial x^i}\right|_p(f\circ F)=
  \frac{\partial f}{\partial y^j}(F(p))\frac{\partial F^j}{\partial x^i}(p)\\
  &=\left(\frac{\partial F^j}{\partial x^i}(p)\left.\frac{\partial}{\partial y^j}\right|_{F(p)}\right)f,
\end{align*}
所以
\begin{equation}
  dF_p\left(\left.\frac{\partial}{\partial x^i}\right|_p\right)=
  \frac{\partial F^j}{\partial x^i}(p)\left.\frac{\partial}{\partial y^j}\right|_{F(p)}.
\end{equation}
也就是说，$dF_p$ 在坐标基下的表示矩阵为
\[
  \begin{pmatrix}
    \dfrac{\partial F^1}{\partial x^1}(p) & \cdots & \dfrac{\partial F^1}{\partial x^n}(p)\\
    \vdots & \ddots & \vdots \\
    \dfrac{\partial F^m}{\partial x^1}(p) & \cdots & \dfrac{\partial F^m}{\partial x^n}(p)
  \end{pmatrix}  .
\]
可见这个矩阵就是 $F$ 在 $p$ 处的 Jacobi 矩阵，即全导数 $DF(p):\mathbb{R}^n\to\mathbb{R}^m$
的表示矩阵。因此，在这种情况下，$dF_p:T_p\mathbb{R}^n\to T_{F(p)}\mathbb{R}^m$
对应全导数 $DF(p):\mathbb{R}^n\to\mathbb{R}^m$。

现在我们考虑带边或者无边光滑流形之间的光滑映射 $F:M\to N$。选取 $p\in M$ 处
的光滑坐标卡 $(U,\varphi)$ 和 $F(p)\in N$ 处的光滑坐标卡 $(V,\psi)$，我们得到
$F$ 的坐标表示 $\hat F=\psi\circ F\circ\varphi^{-1}:\varphi(U\cap F^{-1}(V))\to \psi(V)$。
令 $\hat p=\varphi(p)$ 为 $p$ 的坐标表示。根据上面的叙述，$d\hat F_{\hat p}$
可以表示为 $\hat F$ 在 $\hat p$ 处的 Jacobi 矩阵。使用 $F\circ\varphi^{-1}=\psi^{-1}\circ\hat F$，
我们有
\begin{align*}
  dF_p\left(\left.\frac{\partial}{\partial x^i}\right|_p\right)&=
  dF_p\left(
    d(\varphi^{-1})_{\hat p}\left(
      \left.\frac{\partial}{\partial x^i}\right|_{\hat p}
    \right)
  \right)=
  d(\psi^{-1})_{\hat F(\hat p)}\left(
    d\hat F_{\hat p}\left(
      \left.\frac{\partial}{\partial x^i}\right|_{\hat p}
    \right)
  \right)\\
  &=d(\psi^{-1})_{\hat F(\hat p)}\left(
    \frac{\partial \hat F^j}{\partial x^i}(\hat p)
    \left.\frac{\partial}{\partial y^j}\right|_{\hat F(\hat p)}
  \right)\\
  &=    \frac{\partial \hat F^j}{\partial x^i}(\hat p)
  \left.\frac{\partial}{\partial y^j}\right|_{F(p)}.
\end{align*}
因此，$dF_p$ 在坐标基下的表示矩阵为 $F$ (的坐标表示) 在 $p$ (的坐标表示) 处
的 Jacobi 矩阵。

\subsection{基变换}

设 $(U,\varphi)$ 和 $(V,\psi)$ 是 $M$ 上的两个光滑坐标卡，$p\in U\cap V$。
将 $\varphi$ 的坐标函数记为 $(x^i)$，$\psi$ 的坐标函数记为 $(\tilde{x}^i)$。
$p$ 处的任意切向量都可以由两组基 $\left(\partial/\partial x^i|_p\right)$
和 $\left(\partial/\partial \tilde{x}^i|_p\right)$ 表示。现在我们研究这两个表示的关系。

在这种情况下，我们通常将转移映射 $\psi\circ\varphi^{-1}:\varphi(U\cap V)\to\psi(U\cap V)$
写为下面的简写记号：
\[
  \psi\circ\varphi^{-1}(x)=\left(\tilde{x}^1(x),\dots,\tilde{x}^n(x)\right)  .
\]
这里我们滥用一种典型的记号：对于 $\tilde{x}^i(x)$，我们把 $\tilde{x}^i$
视为一个坐标函数（定义域为 $M$ 的开集，值域为 $\mathbb{R}^n$ 或者 $\mathbb{H}^n$
的开集），但是此处 $x$ 为 $\varphi(U\cap V)$ 中的点，所以这里的
$\tilde{x}^i(x)$ 实际上表示 $\tilde{x}^i\circ\varphi^{-1}(x)$。
根据前一小节，微分 $d(\psi\circ\varphi^{-1})_{\varphi(p)}$ 满足
\[
  d(\psi\circ\varphi^{-1})_{\varphi(p)}\left(
    \left.\frac{\partial}{\partial x^i}\right|_{\varphi(p)}
  \right)  =\frac{\partial \tilde{x}^j}{\partial x^i}(\varphi(p))
  \left.\frac{\partial }{\partial \tilde x^j}\right|_{\psi(p)},
\]
利用坐标向量的定义，我们有
\begin{align*}
  \left.\frac{\partial}{\partial x^i}\right|_p&=d(\varphi^{-1})_{\varphi(p)}
  \left(
    \left.\frac{\partial}{\partial x^i}\right|_{\varphi(p)}
  \right)\\
  &=d(\psi^{-1})_{\psi(p)}\circ d(\psi\circ\varphi^{-1})_{\varphi(p)}
  \left(
    \left.\frac{\partial}{\partial x^i}\right|_{\varphi(p)}
  \right)\\
  &=d(\psi^{-1})_{\psi(p)}\left(
    \frac{\partial \tilde{x}^j}{\partial x^i}(\varphi(p))
  \left.\frac{\partial }{\partial \tilde x^j}\right|_{\psi(p)}
  \right)\\
  &=\frac{\partial \tilde{x}^j}{\partial x^i}(\hat p)
  \left.\frac{\partial }{\partial \tilde x^j}\right|_{p},
\end{align*}
其中 $\hat p=\varphi(p)$。那么对于切向量 $v=v^i\partial/\partial x^i|_p=\tilde{v}^j\partial/\partial\tilde{x}^j|_p$，
其两个分量之间满足关系
\[
  \tilde{v}^j=\frac{\partial\tilde{ x}^j}{\partial x^i}(\hat p) v^i.  
\]

\section{切丛}

$M$ 是带边或者无边光滑流形，定义 $M$ 的\emph{切丛} $TM$ 为 $M$
在所有点处切空间的无交并：
\[
  TM=\coprod_{p\in M} T_pM.  
\]

我们通常把 $TM$ 中的元素写成 $(p,v)$，其中 $p\in M$，$v\in T_pM$。
切丛配备一个自然的投影映射 $\pi:TM\to M$，其满足 $\pi(p,v)=p$。
通过自然的单射 $v\mapsto (p,v)$，我们通常会将 $T_pM$ 视为 $TM$
的子集。对于 $T_pM$ 中的切向量，我们通常会使用三种不同的记号：
$v$、$(p,v)$ 或者 $v_p$，这取决于我们有多强调点 $p$ 的存在。

以 $M=\mathbb{R}^n$ 为例，根据 \autoref{prop:gemotry tangent vector is derivation}，
我们知道 $\mathbb{R}^n$ 的切空间可以等同于几何切空间，所以我们有
\[
  T\mathbb{R}^n=\coprod_{a\in\mathbb{R}^n}T_a\mathbb{R}^n
  \simeq\coprod_{a\in\mathbb{R}^n}\mathbb{R}_a^n=\coprod_{a\in\mathbb{R}^n}
  \{a\} \times\mathbb{R}^n=\mathbb{R}^n\times\mathbb{R}^n, 
\] 
于是 $\mathbb{R}^n\times\mathbb{R}^n$ 中的元素 $(a,v)$ 可以视为表示了
一个几何切向量 $v_a$ 或者导子 $D_{v|_a}$。然而，需要注意的是，
一般光滑流形的切丛并不能直接等同于 Cartesian 积，因为并没有一种自然地方式
将不同点处的切空间等同起来。

如果 $M$ 是光滑流形，切丛 $TM$ 可以被简单地视为向量空间的无交并，但是
实际上它可以有更深刻的结构。下面的命题表明切丛也可以被视为一个光滑流形。
 
\begin{proposition}\label{prop:smooth structure of tangent bundle}
  对于光滑 $n$-流形 $M$，切丛 $TM$ 有一个自然的拓扑和光滑结构使得其成为
  $2n$ 维光滑流形。在这个结构下，投影 $\pi:TM\to M$ 是光滑映射。
\end{proposition}
\begin{proof}
  我们使用 \autoref{lemma:smooth manifold chart} 来定义 $TM$ 上的拓扑结构和
  光滑结构。对于 $M$ 的任意光滑坐标卡 $(U,\varphi)$，注意到 $\pi^{-1}(U)\subseteq TM$
  是所有在 $U$ 中一点处的切向量的集合。令 $(x^1,\dots,x^n)$ 是 $\varphi$ 的坐标函数，
  定义映射 $\tilde{\varphi}:\pi^{-1}(U)\to\mathbb{R}^{2n}$ 为
  \begin{equation}\label{eq:coordinate of TM}
    \tilde{\varphi}\left(
      v^i\!\left.\frac{\partial}{\partial x^i}\right|_p
    \right)  =\left(x^1(p),\dots,x^n(p),v^1,\dots,v^n\right).
  \end{equation}
  其像集为 $\varphi(U)\times\mathbb{R}^n$ 是 $\mathbb{R}^{2n}$ 的开集。
  $\tilde{\varphi}$ 是到其像集的双射，因为其逆映射为
  \[
    \tilde{\varphi}^{-1} \left(x^1,\dots,x^n,v^1,\dots,v^n\right)
    =v^i\!\left.\frac{\partial}{\partial x^i}\right|_{\varphi^{-1}(x)}.
  \]

  现在假设 $(U,\varphi)$ 和 $(V,\psi)$ 是 $M$ 的两个光滑坐标卡，令
  $\left(\pi^{-1}(U),\tilde{\varphi}\right)$ 和 $\left(\pi^{-1}(V),\tilde{\psi}\right)$
  是对应的 $TM$ 的坐标卡。集合
  \begin{align*}
    \tilde{\varphi}\left(\pi^{-1}(U)\cap\pi^{-1}(V)\right)&=
    \varphi(U\cap V)\times\mathbb{R}^n,\\
    \tilde{\psi}\left(\pi^{-1}(U)\cap\pi^{-1}(V)\right)&=
    \psi(U\cap V)\times\mathbb{R}^n,
  \end{align*}
  它们都是 $\mathbb{R}^{2n}$ 的开集。转移映射 $\tilde{\psi}\circ\tilde{\varphi}^{-1}:{\varphi}(U\cap V)\times\mathbb{R}^n\to\psi(U\cap V)\times\mathbb{R}^n$
  满足
  \[
    \tilde{\psi}\circ\tilde{\varphi}^{-1}\left(x^1,\dots,x^n,v^1,\dots,v^n\right)
    =\left(
      \tilde{x}^1,\dots,\tilde{x}^n,
      \frac{\partial\tilde{x}^1}{\partial x^j}(x)v^j,\dots,
      \frac{\partial\tilde{x}^n}{\partial x^j}(x)v^j
    \right),
  \]
  所以 $\tilde{\psi}\circ\tilde{\varphi}^{-1}$ 是光滑的。

  由于 $M$ 是第二可数的，所以存在可数个 $\{U_i\}$ 覆盖 $M$，其中每个 $U_i$
  都是 $M$ 的一个光滑坐标卡。于是 $\{\pi^{-1}(U_i)\}$ 满足 \autoref{lemma:smooth manifold chart}
  的 (1) 到 (4)。下面我们只需要验证 $TM$ 的 Hausdorff 性质。假设 $(p,v)$ 和 $(p,w)$
  是 $TM$ 中不同的切向量，那么存在光滑坐标卡 $U_i$ 包含 $p$，此时
  $(p,v)$ 和 $(p,w)$ 都被同一个坐标卡 $\pi^{-1}(U_i)$ 包含。
  假设 $(p,v)$ 和 $(q,w)$ 是 $TM$ 中不同的切向量，其中 $p\neq q$，由于
  $M$ 是 Hausdorff 的，所以存在不相交的光滑坐标卡 $U,V$ 使得
  $p\in U$ 以及 $q\in V$，此时 $\pi^{-1}(U)$ 和 $\pi^{-1}(V)$
  是分别包含 $p$ 和 $q$ 的不相交坐标卡。因此，$TM$ 成为一个 $2n$ 维光滑流形。

  对于 $M$ 的光滑坐标卡 $(U,\varphi)$ 和 $TM$ 的光滑坐标卡 $\left(\pi^{-1}(U),\tilde{\varphi}\right)$，
  $\pi$ 的坐标表示为 $\hat\pi=\varphi\circ\pi\circ\tilde{\varphi}^{-1}$，满足
  $\hat\pi(x,v)=x$，所以 $\hat \pi$ 是光滑函数，$\pi$ 是光滑映射。
\end{proof}

\begin{remark}
  总的来说，切丛 $TM$ 的拓扑结构为：设 $\{(U_i,\varphi_i)\}$ 是覆盖 $M$ 的一组
  可数的光滑坐标卡，定义 $TM$ 的拓扑为  $\{\tilde\varphi_i^{-1}(V)\}$ 构成的拓扑基生成的拓扑，
  其中 $V$ 是 $\mathbb{R}^{2n}$ 的开集。
  $TM$ 的光滑结构为：$\{(\pi^{-1}(U_i),\tilde\varphi_i)\}$ 构成 $TM$ 的一组光滑坐标卡。
\end{remark}

\eqref{eq:coordinate of TM} 式中的坐标 $(x^i,v^i)$ 被称为\emph{$TM$ 上的自然坐标}。

\begin{proposition}
  设 $M$ 是带边或者无边光滑 $n$-流形并且能够被单个光滑坐标卡覆盖，
  那么 $TM$ 微分同胚于 $M\times\mathbb{R}^n$。
\end{proposition}
\begin{proof}
  设 $(M,\varphi)$ 是 $M$ 的一个全局光滑坐标卡，那么 $\varphi:M\to\hat U\subseteq\mathbb{R}^n$
  是微分同胚，\eqref{eq:coordinate of TM} 式表明 $\tilde{\varphi}:TM\to \hat U\times\mathbb{R}^n$ 是
  微分同胚，故 $TM\approx\hat U\times\mathbb{R}^n\approx M\times\mathbb{R}^n$。
\end{proof}

将光滑映射 $F:M\to N$ 在所有点上的微分放在一起，我们可以定义\emph{全局微分}，
记为 $dF:TM\to TN$，当 $dF$ 限制在 $T_pM\subseteq TM$ 上时将 $dF$ 定义为
$dF_p$。对于切向量 $v\in T_pM$，我们会混用记号 $dF_p(v)$ 和 $dF(v)$，取决于
我们有多强调点 $p$。

\begin{proposition}
  如果 $F:M\to N$ 是光滑映射，那么全局微分 $dF:TM\to TN$ 是光滑映射。
\end{proposition}
\begin{proof}
  $dF$ 在 $TM$ 的自然坐标 $\tilde\varphi=(x^i,v^i)$ 和 $TN$ 的自然坐标 $\tilde\psi=(y^i,w^i)$ 下的表示为
  \begin{align*}
    \widehat{dF}\left(x^1,\dots,x^n,v^1,\dots,v^n\right)&=
    \tilde{\psi}\circ dF\circ\tilde\varphi^{-1}\left(x^1,\dots,x^n,v^1,\dots,v^n\right)\\
    &=\tilde{\psi}\circ dF\left(p,v^i\!\left.\frac{\partial}{\partial x^i}\right|_{p}\right)\\
    &=\tilde\psi \circ dF_{p}\left(v^i\!\left.\frac{\partial}{\partial x^i}\right|_{p}\right)\\
    &=\tilde{\psi}\left(
      F(p),v^i\frac{\partial\hat F^j}{\partial x^i}(x)\left.\frac{\partial}{\partial y^j}\right|_{F(p)}
    \right)
    \\
    &=\left(
      F^1(x),\dots,F^n(x),
      \frac{\partial F^1}{\partial x^i}(x)v^i,\dots,
      \frac{\partial F^n}{\partial x^i}(x)v^i
    \right),
  \end{align*}
  这是一个光滑函数，所以 $dF$ 是光滑映射。
\end{proof}

\begin{corollary}[全局微分的性质]
  设 $F:M\to N$ 和 $G:N\to P$ 是光滑映射。那么
  \begin{enumerate}
    \item $d(G\circ F)=dG\circ dF$。
    \item $d(\Id_M)=\Id_{TM}$。
    \item 如果 $F$ 是微分同胚，那么 $dF:TM\to TN$ 也是微分同胚，并且
    $(dF)^{-1}=d(F^{-1})$。
  \end{enumerate}
\end{corollary}

\section{曲线的速度向量}

$M$ 是带边或者无边光滑流形，我们定义\emph{$M$ 中的曲线}为连续映射
$\gamma:J\to M$，其中 $J\subseteq\mathbb{R}$ 是区间。
注意，本书中的曲线始终指区间到 $M$ 的一个映射，而不是 $M$ 中的某个点集。

我们对切空间的定义实际上导出了对速度向量的自然定义：
给定一个光滑曲线 $\gamma:J\to M$ 和 $t_0\in J$，定义
\emph{$\gamma$ 在 $t_0$ 处的速度}为 $\gamma'(t_0)$：
\[
  \gamma'(t_0)=d\gamma\left(\left.\frac{d}{dt}\right|_{t_0}\right)
  \in T_{\gamma(t_0)}M,
\]
其中 $d/dt|_{t_0}$ 表示 $T_{t_0}\mathbb{R}$ 的标准坐标基 (对于一维流形而言，我们
通常记为 $d/dt$ 而不是 $\partial/\partial t$)。此时速度向量作用在
函数 $f\in C^\infty(M)$ 上为
\[
  \gamma'(t_0)f=  d\gamma\left(\left.\frac{d}{dt}\right|_{t_0}\right)f
  =\left.\frac{d}{dt}\right|_{t_0}(f\circ\gamma)=
  (f\circ\gamma)'(t_0).
\]

令 $(U,\varphi)$ 是光滑坐标卡，坐标函数为 $\left(x^i\right)$。如果
$\gamma(t_0)\in U$，记 $\gamma$ 的坐标表示为 $\gamma(t)=\left(\gamma^1(t),\dots,\gamma^n(t)\right)$。
那么速度的坐标表示为
\[
  \gamma'(t_0)=\frac{d\gamma^i}{dt}(t_0)\left.\frac{\partial}{\partial x^i}\right|_{\gamma(t_0)}.
\]

下面的命题表明流形上的任意切向量都是某条曲线的速度向量。
这给出了一种更加几何的方式去理解切丛：切丛仅仅是 $M$ 中所有光滑曲线的
速度向量的集合。

\begin{proposition}\label{prop:velocity}
  设 $M$ 是带边或者无边光滑流形，$p\in M$。每个 $v\in T_pM$
  都是 $M$ 中某个光滑曲线的速度向量。
\end{proposition}
\begin{proof}
  假设 $p\in \Int M$。令 $(U,\varphi)$ 是以 $p$ 为中心的光滑坐标卡，
  设 $v=v^i\partial/\partial x^i|_p$ 是其在坐标基下的表示。
  对于充分小的 $\varepsilon>0$，令 $\gamma:(-\varepsilon,\varepsilon)\to U$
  是曲线，其坐标表示满足
  \[
    \gamma(t)=\left(tv^1,\dots,tv^n\right).
  \]
  注意此时表示 $\gamma(t)=\varphi^{-1}\left(tv^1,\dots,tv^n\right)$。
  那么 $\gamma(0)=p$ 并且 $\gamma'(0)=v^i\partial/\partial x^i|_p=v$。

  现在假设 $p\in\partial M$。
\end{proof}

\begin{proposition}[复合曲线的速度]
  令 $F:M\to N$ 是光滑映射，$\gamma:J\to M$ 是光滑曲线。对于任意 $t_0\in J$，
  复合曲线 $F\circ\gamma:J\to N$ 在 $t=t_0$ 处的速度为
  \[
    (F\circ\gamma)'(t_0)=dF\!\left(\gamma'(t_0)\right)  .
  \]
\end{proposition}
\begin{proof}
  根据定义，有
  \[
    (F\circ\gamma)'(t_0)=d(F\circ\gamma)\left(
      \left.\frac{d}{dt}\right|_{t_0}
    \right)=(dF\circ d\gamma)\left(
      \left.\frac{d}{dt}\right|_{t_0}
    \right)=dF\!\left(\gamma'(t_0)\right).\qedhere
  \]
\end{proof}

\begin{corollary}[通过速度向量计算微分]
  设 $F:M\to N$ 是光滑映射，$p\in M$，$v\in T_pM$，那么
  \[
    dF_p(v)=(F\circ\gamma)'(0),  
  \]
  其中 $\gamma:J\to M$ 是满足 $\gamma(0)=p$ 以及 $\gamma'(0)=v$ 的任意光滑曲线。
\end{corollary}

\section{Problems}

\begin{problem}{}{}
  设 $M,N$ 是带边或者无边光滑流形，$F:M\to N$ 是光滑映射，证明对于任意 $p\in M$
  有 $dF_p:T_pM\to T_{F(p)}N$ 是零映射当且仅当 $F$ 在 $M$ 的每个连通分支上是常值映射。
\end{problem}
\begin{proof}
  若任取 $p\in M$，$dF_p$ 是零映射。取 $p$ 处的一个光滑坐标卡 $(U,\varphi)$ 和
  $F(p)$ 处的光滑坐标卡 $(V,\psi)$，通过缩小 $U$，我们可以假设 $U$ 被 $p$ 所在的连通分支包含。
  此时 $dF_p$ 满足
  \[
    dF_p\left(\left.\frac{\partial}{\partial x^i}\right|_p\right)=\frac{\partial F^j}{\partial x^i}(\hat p)
    \left.\frac{\partial}{\partial x^j}\right|_{F(p)}=0,
  \]
  所以对于任意的 $i,j$，有 $\partial F^j/\partial x^i(\hat p)=0$。此时任取 $q\in U$，都有
  $\partial F^j/\partial x^i(\hat q)=0$，所以 $\partial F^j/\partial x^i:\varphi(U)\to\mathbb{R}$
  恒为零。这表明 $\psi\circ F\circ\varphi^{-1}:\varphi(U)\to \psi(V)$ 是常值函数，
  所以 $F$ 在 $U$ 上是常值函数。于是 $F$ 在 $p$ 所在的连通分支上是常值函数。
\end{proof}

\begin{problem}{}{}
  证明 $T \mathbb{S}^1$ 微分同胚于 $\mathbb{S}^1\times \mathbb{R}$。
\end{problem}
\begin{proof}
  令 $F:T \mathbb{S}^1\to \mathbb{S}^1\times \mathbb{R}$ 为
  \[
    F\left(p, v\left.\frac{d}{dt}\right|_p\right)=(p,v),
  \]
  那么 $F$ 在标准光滑结构下的坐标表示为
  \[
    (x,v)\mapsto (x,v)
  \]
  是光滑映射。同理不难验证 $F^{-1}$ 也是光滑映射。
\end{proof}



\chapter{浸没、浸入和嵌入}

\section{常秩映射}

设 $M,N$ 是带边或者无边光滑流形。给定一个光滑映射 $F:M\to N$
和点 $p\in M$，定义\emph{$F$ 在 $p$ 处的秩}为线性映射 $dF_p:T_pM\to T_{F(p)}N$
的秩。显然其等价定义有 $F$ 在任意光滑坐标卡下的 Jacobi 矩阵的秩以及
$\im dF_p\subseteq T_{F(p)}N$ 的维数。如果 $F$ 在任意点处的秩
都是 $r$，那么我们说 $F$ 是\emph{常秩}的，记为 $\rk F=r$。
显然 $F$ 在任意点处的秩都小于等于 $\min\{\dim M,\dim N\}$，如果
$dF_p$ 的秩等于 $\min\{\dim M,\dim N\}$，那么我们说\emph{$F$ 在 $p$ 处满秩}。
如果 $F$ 在任意点处都满秩，那么我们说\emph{$F$ 满秩}。

如果光滑映射 $F:M\to N$ 在任意点处的微分都是满射(等价地说，$\rk F=\dim N$)，那么我们说 $F$ 是\emph{光滑浸没}。
如果 $F$ 在任意点处的微分都是单射(等价地说，$\rk F=\dim M$)，那么我们说 $F$ 是\emph{光滑浸入}。

\begin{proposition}\label{prop:regular points is open}
  设 $F:M\to N$ 是光滑映射，$p\in M$。如果 $dF_p$ 是满射，那么存在 $p$ 
  的邻域 $U$ 使得 $F|_U$ 是浸没。如果 $dF_p$ 是单射，那么存在 $p$ 
  的邻域 $U$ 使得 $F|_U$ 是浸入。
\end{proposition}
\begin{proof}
  任取 $p$ 处的光滑坐标卡 $(W,\varphi)$ 和 $F(p)$ 处的光滑坐标卡 $(V,\psi)$，那么 $F$
  的坐标表示 $\psi\circ F\circ\varphi^{-1}$ 在 $\hat p=\varphi(p)$ 处的 Jacobi 矩阵是满秩矩阵，由于满秩矩阵的集合是 $\dim N\times\dim M$
  矩阵空间中的开集，所以存在 $\hat p$ 的邻域 $U\subseteq W$ 使得 $F$ 
  在 $U$ 中任意点都满秩，此时 $F|_U$ 为浸没或者浸入。
\end{proof}

\begin{example}[浸没和浸入]
  \mbox{}
  \begin{enumerate}
    \item 设 $M_1,\dots,M_k$ 是光滑流形，那么每个投影映射 $\pi_i:M_1\times\cdots\times M_k\to M_i$
    是光滑浸没。这是因为 $\pi_i$ 的某个坐标表示为
    $\hat \pi(x_1,\dots,x_k)=x_i$，其 Jacobi 矩阵满秩。
    \item 如果 $\gamma:J\to M$ 是光滑曲线，那么 $\gamma$ 是光滑浸入当且仅当
    对于任意的 $t\in J$ 有 $\gamma'(t)\neq 0$。
    \item 如果 $M$ 是光滑流形，赋予切丛 $TM$ \autoref{prop:smooth structure of tangent bundle}
    中的光滑结构，那么投影 $\pi:TM\to M$ 是光滑浸没。对于 $M$ 的任意光滑坐标卡
    $(U,(x^i))$ 和对应的 $TM$ 的光滑坐标卡 $(\pi^{-1}(U),(x^i,v^i))$，$\pi$
    的坐标表示为 $\hat \pi(x,v)=x$，其 Jacobi 矩阵是行满秩矩阵。
  \end{enumerate}
\end{example}

\subsection{局部微分同胚}

令 $M,N$ 是带边或者无边光滑流形，映射 $F:M\to N$。如果每个 $p\in M$
处都有一个邻域 $U$ 使得 $F(U)$ 是开集并且 $F|_U:U\to F(U)$ 是微分同胚，那么
我们说 $F$ 是\emph{局部微分同胚}。由于 $F$ 满足局部的光滑性，根据
\autoref{prop:smoothness is local}，局部微分同胚是光滑映射。

\begin{theorem}[流形上的反函数定理]
  设 $M,N$ 是光滑流形，$F:M\to N$ 是光滑映射。如果 $p\in M$ 使得
  $dF_p$ 可逆，那么存在 $p$ 的连通邻域 $U_0$ 和 $F(p)$ 的连通邻域 $V_0$
  使得 $F|_{U_0}:U_0\to V_0$ 是微分同胚。
\end{theorem}
\begin{proof}
  $dF_p$ 可逆表明 $\dim M=\dim N=n$。取 $p$ 处的光滑坐标卡 $(U,\varphi)$
  和 $F(p)$ 处的光滑坐标卡 $(V,\psi)$ 并且 $F(U)\subseteq V$，
  $\hat F=\psi\circ F\circ\varphi^{-1}:\hat U=\varphi(U)\to \psi(V)=\hat V$
  是光滑函数。微分 $d\hat F_{\hat p}=d\psi_{F(p)}\circ dF_p\circ d(\varphi^{-1})_{\hat p}$
  可逆，Euclid 空间中的反函数定理告诉我们存在 $\hat p$ 的连通邻域 $\hat U_0\subseteq\hat U$
  以及 $\psi(F(p))$ 的连通邻域 $\hat V_0\subseteq \hat V$ 使得 
  $\hat F|_{\hat U_0}:\hat U_0\to\hat V_0$ 是微分同胚，那么 $U_0=\varphi^{-1}(\hat U_0)$
  和 $V_0=\psi^{-1}(\hat V_0)$ 即为我们所需要的。
\end{proof}

\begin{proposition}[局部微分同胚的基本性质]
  \mbox{}
  \begin{enumerate}
    \item 局部微分同胚的复合是局部微分同胚。
    \item 光滑流形之间局部微分同胚的有限积是局部微分同胚。
    \item 局部微分同胚是局部同胚并且是开映射。
    \item 局部微分同胚限制在带边或者无边开子流形上是局部微分同胚。
    \item 微分同胚是局部微分同胚。
    \item 双射的局部微分同胚是微分同胚。
  \end{enumerate}
\end{proposition}
\begin{proof}
  (1) 设 $F:M\to N$ 和 $G:N\to P$ 是局部微分同胚。任取 $p\in M$，
  那么存在 $F(p)$ 的邻域 $V$ 使得 $G(V)$ 是 $P$ 的开集，并且 
  $G|_V:V\to G(V)$ 是微分同胚。$F$ 是局部微分同胚表明存在 $p$
  的邻域 $U$ 使得 $F(U)$ 为 $N$ 的开集并且 $F|_U:U\to F(U)$ 是微分同胚，
  用 $U\cap F^{-1}(V)$ 替代 $U$，可以假设 $U\subseteq F^{-1}(V)$，即
  $F(U)\subseteq V$。那么 $G|_{F(U)}:F(U)\to G(F(U))$ 是微分同胚，故
  $(G\circ F)|_U:U\to G(F(U))$ 是微分同胚，即 $G\circ F$ 是局部微分同胚。
\end{proof}


\begin{proposition}\label{prop:local diffeomorphism}
  设 $M,N$ 是光滑流形，$F:M\to N$ 是映射。
  \begin{enumerate}
    \item $F$ 是局部微分同胚当且仅当 $F$ 同时是光滑浸没以及光滑浸入。
    \item 如果 $\dim M=\dim N$ 并且 $F$ 为光滑浸没或者光滑浸入，那么
    $F$ 是局部微分同胚。
  \end{enumerate}
\end{proposition}
\begin{proof}
  (1) 设 $F$ 是局部微分同胚。任取 $p\in M$，存在 $p$ 的邻域 $U$ 使得 $F(U)$
  为开集并且 $F|_U:U\to F(U)$ 是微分同胚，那么微分 $dF_p:T_pM\to T_{F(p)}N$
  是同构，所以 $\rk F=\dim M=\dim N$，即 $F$ 是光滑浸没以及光滑浸入。

  反之，若 $F$ 是光滑浸没以及光滑浸入，任取 $p\in M$，那么 $dF_p:T_pM\to T_{F(p)}N$
  是同构，根据反函数定理，存在 $p$ 的邻域 $U$ 和 $F(p)$ 的邻域 $V$ 使得
  $F|_U:U\to V$ 是微分同胚，即 $F$ 是局部微分同胚。

  (2) 只需注意到对于相同维数的向量空间之间的线性映射，单射或者满射即可推出同构。
\end{proof}

\begin{example}[局部微分同胚]
  定义映射 $\varepsilon:\mathbb{R}\to\mathbb{S}^1$ 为 $\varepsilon(t)=e^{2\pi it}$，
  $\varepsilon$ 是局部微分同胚，因为其坐标表示为 $\hat\varepsilon(t)=2\pi t+c$
  是微分同胚。  
\end{example}





\subsection{秩定理}

\begin{theorem}[秩定理]
  设 $M,N$ 分别是 $m$ 维和 $n$ 维光滑流形，$F:M\to N$ 是秩 $r$ 的光滑映射。
  对于每个 $p\in M$，存在以 $p$ 为中心的光滑坐标卡 $(U,\varphi)$ 和以
  $F(p)$ 为中心的光滑坐标卡 $(V,\psi)$ 使得 $F(U)\subseteq V$，并且
  $F$ 的坐标表示满足
  \[
    \hat F\left(x^1,\dots,x^r,x^{r+1},\dots,x^m\right) =
    \left(x^1,\dots,x^r,0,\dots,0\right).
  \]
  特别地，如果 $F$ 是光滑浸没，那么
  \[
    \hat F\left(x^1,\dots,x^n,x^{n+1},\dots,x^m\right) =
    \left(x^1,\dots,x^n\right),
  \]
  如果 $F$ 是光滑浸入，那么
  \[
    \hat F\left(x^1,\dots,x^m\right) =
    \left(x^1,\dots,x^m,0,\dots,0\right).
  \]
\end{theorem}
\begin{proof}
  该定理的叙述是局部的，所以在选定光滑坐标卡后，我们可以将 $M,N$
  替换为开集 $U\subseteq\mathbb{R}^m$ 和开集 $V\subseteq\mathbb{R}^n$。
  $DF(p)$ 的秩为 $r$ 表明其存在某个 $r\times r$ 子矩阵的行列式不为零。
  通过调整坐标的顺序，我们假定其左上角的子矩阵的行列式不为零，即
  $\left(\partial F^i/\partial x^j\right)$，其中 $1\leq i,j\leq r$。
  记 $\mathbb{R}^m$ 中的标准坐标为 $(x,y)=(x^1,\dots,x^r,y^1,\dots,y^{m-r})$，
  $\mathbb{R}^n$ 中的标准坐标为 $(v,w)=(v^1,\dots,v^r,w^1,\dots,w^{n-r})$。
  通过平移坐标系，我们可以假设 $p=(0,0)$ 以及 $F(p)=(0,0)$。将 
  $F(x,y)$ 分解为 $F(x,y)=\left(Q(x,y),R(x,y)\right)$，其中
  $Q:U\to\mathbb{R}^r$ 和 $R:U\to\mathbb{R}^{n-r}$ 是光滑函数。
  此时 $\left(\partial Q^i/\partial x^j(0,0)\right)$ 是可逆矩阵。

  定义 $\varphi:U\to\mathbb{R}^m$ 为 $\varphi(x,y)=\left(Q(x,y),y\right)$，那么
  \[
    D\varphi(0,0)=\begin{pmatrix}
      \dfrac{\partial Q^i}{\partial x^j}(0,0) &  \dfrac{\partial Q^i}{\partial y^j}(0,0)\\[4mm]
      0 & I_{m-r}
    \end{pmatrix}  .
  \]
  显然 $D\varphi(0,0)$ 可逆。根据反函数定理，存在 $(0,0)$ 的连通邻域 $U_0$
  和 $\varphi(0,0)=(0,0)$ 的连通邻域 $\tilde{U}_0$ 使得 $\varphi:U_0\to\tilde{U}_0$
  是微分同胚。通过缩小 $U_0$ 和 $\tilde{U}_0$，我们假设 $\tilde{U}_0$ 是开立方体。
  记逆映射 $\varphi^{-1}:\tilde{U}_0\to U_0$ 为
  $\varphi^{-1}(x,y)=\left(A(x,y),B(x,y)\right)$，其中 $A:\tilde{U}_0\to\mathbb{R}^r$
  和 $B:\tilde{U}_0\to\mathbb{R}^{m-r}$ 是光滑函数，那么
  \[
    (x,y)=\varphi\left(A(x,y),B(x,y)\right)=\left(Q\bigl(A(x,y),B(x,y)\bigr),B(x,y)\right),
  \]
  故 $B(x,y)=y$。因此 $\varphi^{-1}$ 满足
  \[
    \varphi^{-1}(x,y)=\left(A(x,y),y\right)  .
  \]
  另一方面，对比分量 $x$，有 $Q\left(A(x,y),y\right)=x$，因此
  \[
    F\circ\varphi^{-1}(x,y)=\left(x,\tilde{R}(x,y)\right)  ,
  \]
  其中 $\tilde{R}:\tilde{U}_0\to\mathbb{R}^{n-r}$ 满足
  $\tilde{R}(x,y)=R\left(A(x,y),y\right)$。$F\circ\varphi^{-1}$ 在
  任意 $(x,y)\in\tilde{U}_0$ 处的 Jacobi 矩阵为
  \[
    D\left(F\circ\varphi^{-1}\right)(x,y)=\begin{pmatrix}
      I_r & 0 \\[2mm]
      \dfrac{\partial \tilde{R}^i}{\partial x^j}(x,y) & 
      \dfrac{\partial \tilde{R}^i}{\partial y^j}(x,y)
    \end{pmatrix}.
  \]
  由于微分同胚不改变映射的秩，所以上述矩阵的秩为 $r$，这表明
  $\partial\tilde{R}^i/\partial y^j(x,y)$ 为零矩阵，所以 $\tilde{R}$
  的取值实际上与 $y$ 无关，不妨设 $S(x)=\tilde{R}(x,0)$ (这里 $\tilde{U}_0$ 是开立方体保证 $\tilde{R}(x,0)$ 有定义)，
  那么
  \[
    F\circ\varphi^{-1}(x,y)=\left(x,S(x)\right)  .
  \] 

  令 $V_0\subseteq V$ 为 $V_0=\left\{(v,w)\in V\,\middle|\, (v,0)\in\tilde{U}_0\right\}$，
  那么 $V_0$ 是包含 $(0,0)$ 的开集。此时 $F\circ\varphi^{-1}\left(\tilde{U}_0\right)\subseteq V_0$。
  定义 $\psi:V_0\to\mathbb{R}^n$ 为 $\psi(v,w)=(v,w-S(v))$，这是到其像集的微分同胚，
  因为有逆映射 $\psi^{-1}(s,t)=(s,t+S(s))$，所以 $(V_0,\psi)$ 是光滑坐标卡。
  那么
  \[
    \psi\circ F\circ\varphi^{-1}(x,y)=\psi(x,S(x))=(x,S(x)-S(x))=(x,0) .
  \]
  这就完成了证明。
\end{proof}

\begin{corollary}
  令 $M,N$ 是光滑流形，$F:M\to N$ 是光滑映射，且 $M$ 是连通空间。那么下面的说法等价：
  \begin{enumerate}
    \item 对于每个 $p\in M$ 都存在包含 $p$ 的光滑坐标卡和包含 $F(p)$ 的光滑坐标卡，
    使得 $F$ 的坐标表示是线性映射。
    \item $F$ 是常秩的。
  \end{enumerate}
\end{corollary}
\begin{proof}
  $(2)\Rightarrow (1)$ 即秩定理。
  $(1)\Rightarrow (2)$ 由于线性映射是常秩的，所以 $F$ 在每个点 $p$ 处都有一个邻域
  使得 $F$ 在这个邻域上为常秩，$M$ 的连通性表明 $F$ 在 $M$ 上为常秩。
\end{proof}

\begin{theorem}[全局秩定理]
  令 $M,N$ 是光滑流形，$F:M\to N$ 是常秩光滑映射。
  \begin{enumerate}
    \item 若 $F$ 是满射，那么 $F$ 是光滑浸没。
    \item 若 $F$ 是单射，那么 $F$ 是光滑浸入。
    \item 若 $F$ 是双射，那么 $F$ 是微分同胚。
  \end{enumerate}
\end{theorem}
\begin{proof}
  记 $m=\dim M$，$n=\dim N$，设 $F$ 有常秩 $r$。(a)
  若 $F$ 是满射，假设 $F$ 不是光滑浸没，那么 $r<n$。根据秩定理，存在
  以 $p$ 为中心的光滑坐标卡 $(U,\varphi)$ 和以 $F(p)$ 为中心的光滑坐标卡
  $(V,\psi)$ 使得 $F(U)\subseteq V$ 并且 $F$ 的坐标表示为
  \[
    \hat F\left(x^1,\dots,x^r,x^{r+1},\dots,x^m\right) =
    \left(x^1,\dots,x^r,0,\dots,0\right).
  \]
  通过适当缩小 $U$，我们假设 $U$ 是一个正则坐标球并且 $F(\bar U)\subseteq V$。
  这表明 $F(\bar U)$ 是集合 $\left\{y\in V\,\middle|\, y^{r+1}=\cdots=y^n=0\right\}$
  ($N$ 的闭子集且不包含 $N$ 的任意非空开子集) 的紧子集，所以 $F(\bar U)$ 是 $N$ 的闭集且不包含 $N$ 的任何非空开子集，
  所以
  \[
    \overline{N\smallsetminus F(\bar U)}=N\smallsetminus \Int F(\bar U)=
    N\smallsetminus\emptyset=N,
  \]
  故 $F(\bar U)$ 在 $N$ 中无处稠密。因为流形的任意开覆盖都有可数子覆盖，所以我们可以
  选取可数个这样的坐标卡 $\{(U_i,\varphi_i)\}$ 覆盖 $M$，其对应的坐标卡 $\{(V_i,\psi_i)\}$
  覆盖 $F(M)$。因为
  \[
    F(M)=\bigcup_{i=1}^\infty F(\bar U),  
  \]
  根据 Baire 纲定理，所以 $F(M)$ 在 $N$ 中的内部为空集，这与 $F$ 是满射矛盾。

  (b) 若 $F$ 是单射，假设 $F$ 不是光滑浸入，那么 $r<m$。根据秩定理，
  存在
  以 $p$ 为中心的光滑坐标卡 $(U,\varphi)$ 和以 $F(p)$ 为中心的光滑坐标卡
  $(V,\psi)$ 使得 $F(U)\subseteq V$ 并且 $F$ 的坐标表示为
  \[
    \hat F\left(x^1,\dots,x^r,x^{r+1},\dots,x^m\right) =
    \left(x^1,\dots,x^r,0,\dots,0\right),
  \]
  那么对于任意小的 $\varepsilon$ 都有 $\hat F(0,\dots,0,\varepsilon)=(0,\dots,0,0)$，
  这与 $F$ 是单射矛盾。

  (c) 根据 (a) 和 (b)，$F$ 同时是光滑浸没以及光滑浸入，根据 \autoref{prop:local diffeomorphism}，
  $F$ 是局部微分同胚，双射的局部微分同胚是微分同胚。
\end{proof}

\section{嵌入}

如果 $M,N$ 是带边或者无边光滑流形，若 $F:M\to N$ 同时是光滑浸入以及
拓扑嵌入，那么我们说 $F$ 是\emph{$M$ 到 $N$ 的光滑嵌入}。

\begin{example}[光滑嵌入]
  \mbox{}
  \begin{enumerate}
    \item $M$ 是带边或者无边光滑流形，$U\subseteq M$ 是开子流形，那么
    包含映射 $\iota:U\hookrightarrow M$ 是光滑嵌入。
    \item 如果 $M_1,\dots,M_k$ 是光滑流形，$p_i\in M_i$ 是任意点，
    定义 $\iota_j:M_j\to M_1\times\cdots\times M_k$ 为
    \[
      \iota_j(q)=(p_1,\dots,p_{j-1},q,p_{j+1},\dots,p_k),  
    \]
    那么 $\iota_j$ 是光滑嵌入。
  \end{enumerate}
\end{example}

\begin{example}[光滑的拓扑嵌入]
  定义映射 $\gamma:\mathbb{R}\to\mathbb{R}^2$ 为 $\gamma(t)=(t^3,0)$ 是光滑映射
  并且是拓扑嵌入，但是其不是光滑嵌入，因为 $\gamma'(0)=(0,0)$ 不满秩。
\end{example}

\begin{example}[八字曲线]\label{exa:eight-curve}
  考虑曲线 $\beta:(-\pi,\pi)\to\mathbb{R}^2$ 为
  \[
    \beta(t)=(\sin 2t,\sin t) . 
  \]
  $\beta$ 的像集也被称为\emph{双扭线}($x^2=4y^2(1-y^2)$)。
  由于 $\beta'(t)=(2\cos 2t,\cos t)\neq (0,0)$，所以 $\beta$ 是单射的光滑浸入。
  但是 $\beta$ 不是拓扑嵌入，因为其像集在子空间拓扑下是紧集，但是
  $(-\pi,\pi)$ 不是紧集。
\end{example}

\begin{example}[环面上的稠密曲线]
  令 $\mathbb{T}^2=\mathbb{S}^1\times\mathbb{S}^1\subseteq\mathbb{C}^2$ 是环面，
  $\alpha$ 是任意无理数。定义映射 $\gamma:\mathbb{R}\to\mathbb{T}^2$ 为
  \[
    \gamma(t)=\left(e^{2\pi it},e^{2\pi i\alpha t}\right),
  \]
  由于 $\gamma'(t)$ 始终不为零，所以 $\gamma$ 是光滑浸入。若 $\gamma(t_1)=\gamma(t_2)$，
  那么 $t_1-t_2$ 和 $\alpha(t_1-t_2)$ 同时为整数，这只能表明 $t_1=t_2$，所以 $\gamma$ 是单射。

  考虑集合 $\gamma(\mathbb{Z})$。根据 Dirichlet 逼近定理，对于任意的 $\varepsilon>0$，
  存在整数 $n,m$ 使得 $\abs{\alpha n-m}<\varepsilon$。使用不等式
  $\abs{e^{it_1}-e^{it_2}}\leq\abs{t_1-t_2}$，其中 $t_1,t_2\in\mathbb{R}$ (这是因为从 $e^{it_1}$ 到 $e^{it_2}$ 的线段长度小于等于圆弧长度)，
  我们有 $\abs{e^{2\pi i\alpha n}-1}=\abs{e^{2\pi i\alpha n}-e^{2\pi i m}}\leq \abs{2\pi(\alpha n-m)}<2\pi \varepsilon$，
  因此，
  \[
    \abs{\gamma(n)-\gamma(0)}=\abs{\left(e^{2\pi i n},e^{2\pi i \alpha n}\right)-(1,1)}
    =\abs{\left(1,e^{2\pi i\alpha n}\right)-(1,1)}<2\pi\varepsilon , 
  \]
  所以 $\gamma(0)$ 是 $\gamma(\mathbb{Z})$ 的极限点。这意味着 $\gamma$ 并不同胚于它的像，
  因为 $\mathbb{Z}$ 在 $\mathbb{R}$ 中没有任何极限点。实际上，可以证明像集 $\gamma(\mathbb{R})$
  在 $\mathbb{T}^2$ 中稠密。这表明单射的光滑浸入也不一定是光滑嵌入。
\end{example}

下面的命题给出了一个判断单射的浸入为嵌入的充分条件。

\begin{proposition}
  设 $F:M\to N$ 是带边或者无边光滑流形，$F:M\to N$ 是单射的光滑浸入，如果 $F$
  满足下列条件之一，那么 $F$ 是光滑嵌入。
  \begin{enumerate}
    \item $F$ 是开映射或者闭映射。
    \item $F$ 是恰当映射。
    \item $M$ 是紧空间。
    \item $M$ 有空的边界并且 $\dim M=\dim N$。
  \end{enumerate}
\end{proposition}
\begin{proof}
  若 $F$ 为开映射或者闭映射，那么 $F$ 是拓扑嵌入，进而是光滑嵌入。
  (2) 和 (3) 都能推出 $F$ 是闭映射。对于 (4)，$\dim M=\dim N$ 表明
  $dF_p$ 可逆，$M$ 边界为空表明 $F(M)\subseteq\Int N$，
  \autoref{prop:local diffeomorphism} 表明 $F:M\to\Int N$ 是局部微分同胚，
  从而是开映射。$F:M\to N$ 是开映射的复合 $M\to\Int N\hookrightarrow N$，
  所以 $F$ 是光滑嵌入。
\end{proof}

\begin{theorem}[局部嵌入定理]\label{thm:local embedding}
  设 $M,N$ 是带边或者无边光滑流形，$F:M\to N$ 是光滑映射。那么 $F$
  是光滑浸入当且仅当在 $M$ 的每个点处，都存在一个邻域 $U$ 使得
  $F|_U:U\to N$ 是光滑嵌入。
\end{theorem}
\begin{proof}
  若 $F$ 是光滑浸入。任取点 $p\in M$，根据秩定理，存在包含 $p$
  的光滑坐标卡 $(U_1,\varphi)$ 和包含 $F(p)$ 的光滑坐标卡 $(V,\psi)$，
  使得 $F(U_1)\subseteq V$ 以及 $F$ 的坐标表示为
  \[
    \psi\circ F\circ\varphi^{-1}\left(x^1,\dots,x^m\right)=
    \left(x^1,\dots,x^m,0,\dots,0\right),
  \]
  此时 $\psi\circ F\circ\varphi^{-1}$ 是单射，所以 $F|_{U_1}$ 是单射。
  取 $p$ 的一个预紧的邻域 $U$，并且 $U$ 满足 $\bar U\subseteq U_1$。
  那么 $F|_{\bar U}:\bar U\to N$ 是紧空间到 Hausdorff 空间的连续映射，从而
  是闭映射，又因为 $F|_{\bar U}$ 是单射，所以 $F|_{\bar U}$ 是拓扑嵌入，
  于是 $F|_U$ 作为 $F|_{\bar U}$ 的限制也是拓扑嵌入。显然 $F|_U$
  是光滑浸入，所以 $F|_U$ 是光滑嵌入。

  反之，若在 $M$ 的每个点 $p$ 处，都存在一个邻域 $U$ 使得 $F|_U:U\to N$ 是光滑嵌入。
  这表明 $d(F|_U)_p=d(F\circ\iota)_p=dF_{p}\circ d\iota_p$ 是单射，而
  $d\iota_p:T_pU\to T_pM$ 是同构，所以 $dF_p$ 是单射，所以 $F$ 是光滑浸入。 
\end{proof}


\section{浸没}

如果 $\pi:M\to N$ 是连续映射，定义\emph{$\pi$ 的截面}是 $\pi$ 的连续右逆，
即一个连续映射 $\sigma:N\to M$ 使得 $\pi\circ\sigma=\Id_N$。
定义\emph{$\pi$ 的局部截面}是连续映射 $\sigma:U\to M$，其中 $U\subseteq N$
是开集并且满足 $\pi\circ\sigma=\Id_U$。下面的定理表明，对于光滑浸没而言，
其在值域上的局部行为类似满射。

\begin{theorem}[局部截面定理]
  设 $M,N$ 是光滑流形，$\pi:M\to N$ 是光滑映射。那么 $\pi$ 是光滑浸没当且仅当
  $M$ 的每个点都在 $\pi$ 的某个光滑局部截面的像集中。
\end{theorem}
\begin{proof}
  若 $\pi$ 是光滑浸没。任取 $p\in M$，根据秩定理，存在以 $p$ 为中心的光滑坐标卡
  $(U,\varphi)$ 和以 $\pi(p)$ 为中心的光滑坐标卡 $(V,\psi)$ 使得
  $\pi(U)\subseteq V$ 并且有坐标表示
  \[
    \psi\circ\pi\circ\varphi^{-1}\left(x^1,\dots,x^m\right)=\left(x^1,\dots,x^n\right).
  \]
  对于 $\varepsilon>0$，记 $\mathbb{R}^m$ 中的开立方体
  \[
    \hat C_\varepsilon=\bigl\{\,x\bigm| \abs{x^i}<\varepsilon,i=1,\dots,m\,\bigr\},
  \]
  我们可以让 $\varepsilon$ 足够小使得 $\hat C_\varepsilon\subseteq \varphi(U)$，
  记 $C_\varepsilon=\varphi^{-1}\left(\hat C_\varepsilon\right)\subseteq U$。
  于是 
  \[ 
    \psi\circ\pi(C_\varepsilon)=\bigl\{\,y\bigm| \abs{y^i}<\varepsilon,i=1,\dots,n\,\bigr\}
  \]
  是 $\mathbb{R}^n$ 中的开立方体。记 $C_\varepsilon'=\psi^{-1}\left(\psi\circ \pi(C_\varepsilon)\right)$
  是 $N$ 的开集。令 $\sigma:C_\varepsilon'\to C_\varepsilon$，其坐标表示满足
  \[
    \varphi\circ\sigma\circ\psi^{-1}\left(x^1,\dots,x^n\right)  
    =\left(x^1,\dots,x^n,0,\dots,0\right),
  \]
  那么 $\pi\circ\sigma=\Id_{C_\varepsilon'}$，且 $p\in C_\varepsilon$ 表明
  $p\in\im\sigma$。

  反之，若任取 $p\in M$，存在 $\pi$ 的光滑局部截面 $\sigma:U\to M$ 使得 $p\in\im\sigma$。
  设 $q\in U$ 使得 $p=\sigma(q)$。那么 $\pi\circ\sigma=\Id_U$ 表明
  \[
    \Id_{T_qN}=d\left(\Id_U\right)_q= d\pi_{p}\circ d\sigma_q,
  \]
  即 $d\pi_p$ 是满射，所以 $\pi$ 是光滑浸没。
\end{proof}

\begin{proposition}[光滑浸没的性质]
  令 $M,N$ 是光滑流形，$\pi:M\to N$ 是光滑浸没。那么 $\pi$ 是开映射，
  进一步的，如果 $\pi$ 是满射，那么 $\pi$ 是商映射。
\end{proposition}
\begin{proof}
  设 $W\subseteq M$ 是开集，任取 $q=\pi(p)\in \pi(W)$，即 $p\in W$，
  根据局部截面定理，存在 $\pi$ 的光滑局部截面 $\sigma:U\to M$
  使得 $p\in \im\sigma$，设 $q'\in U$ 使得 $p=\sigma(q')$，那么
  $q=\pi(p)=\pi(\sigma(q'))=q'$，所以 $\sigma(q)=p\in W$，所以 $q\in \sigma^{-1}(W)$。
  任取 $y\in\sigma^{-1}(W)$，那么 $\sigma(y)\in W$，即 $y=\pi(\sigma(y))\in \pi(W)$，
  所以 $q\in\sigma^{-1}(W)\subseteq \pi(W)$，这表明 $\pi(W)$
  是开集，即 $\pi$ 是开映射。
\end{proof}

\chapter{子流形}

\section{嵌入子流形}

设 $M$ 是带边或者无边光滑流形，$M$ 的\emph{嵌入子流形}
指的是子集 $S\subseteq M$，其配备子空间拓扑和使得包含映射 $S\hookrightarrow M$
为光滑嵌入的光滑结构。嵌入子流形也被称为\emph{正则子流形}。

如果 $S$ 是 $M$ 的嵌入子流形，那么 $\dim M-\dim S$ 被称为 $S$ 在 $M$
中的\emph{余维数}。余维数为 $1$ 的嵌入子流形被称为一个\emph{嵌入超曲面}。

\begin{proposition}[开子流形]\label{prop:open submanifold}
  设 $M$ 是光滑流形，那么 $M$ 的余维数为 $0$ 的嵌入子流形恰好为开子流形。
\end{proposition}
\begin{proof}
  设 $U\subseteq M$ 是开子流形，$\iota:U\hookrightarrow M$ 为包含映射。
  此时 $\iota$ 的坐标表示为恒等映射，所以 $\iota$ 为光滑浸入，又因为
  $U$ 有子空间拓扑，所以 $\iota$ 是光滑嵌入。故 $U$ 为余维数
  $\dim M-\dim U=0$ 的嵌入子流形。反之，设 $U$ 是余维数为 $0$ 的嵌入子流形。
  根据定义，包含映射 $\iota:U\hookrightarrow M$ 是光滑嵌入，根据
  \autoref{prop:local diffeomorphism}，$\iota$ 是局部微分同胚，从而是开映射，
  所以 $U$ 是 $M$ 的开子集，故 $U$ 是开子流形。
\end{proof}

\begin{proposition}[嵌入的像作为子流形]\label{prop:image of embedding}
  设 $M$ 是带边或者无边光滑流形，$N$ 是光滑流形，$F:N\to M$ 是光滑嵌入。
  令 $S=F(N)$，在子空间拓扑下，$S$ 是拓扑流形，并且有唯一的光滑结构使得
  其为 $M$ 的嵌入子流形以及 $F$ 为 $N\to F(N)$ 的微分同胚。 
\end{proposition}
\begin{proof}
  $F$ 是嵌入表明 $F$ 可以视为 $N\to S$ 的同胚，所以 $S$ 是一个拓扑流形。
  定义 $S$ 上的光滑坐标卡形如 $\left(F(U),\varphi\circ F^{-1}\right)$，
  其中 $(U,\varphi)$ 为 $N$ 的任意光滑坐标卡。$N$ 的光滑坐标卡的相容性
  导出了 $S$ 的光滑坐标卡的相容性，所以这给出了 $S$ 上的光滑结构。
  在这个光滑结构下，$F:N\to S$ 显然是微分同胚。包含映射 $S\hookrightarrow M$
  是光滑嵌入的复合：
  \[
    S\xlongrightarrow{F^{-1}}N\xlongrightarrow{F}M,  
  \]
  所以包含映射 $S\hookrightarrow M$ 是光滑嵌入，即 $S$ 是 $M$ 的嵌入子流形。
\end{proof}

\begin{proposition}[积流形的切片]
  令 $M,N$ 是光滑流形。对于每个 $p\in N$，子集 $M\times\{p\}$ (被称为积流形的一个\emph{切片})
  是 $M\times N$ 的一个微分同胚于 $M$ 的嵌入子流形。
\end{proposition}
\begin{proof}
  考虑光滑嵌入 $x\mapsto (x,p)$，那么 $M\times\{p\}$ 作为该光滑嵌入的像集
  是 $M\times N$ 的同胚于 $M$ 的嵌入子流形。
\end{proof}

\begin{proposition}[图像作为子流形]\label{prop:graph is submanifold}
  设 $M$ 是光滑 $n$-流形，$N$ 是光滑带边或者无边 $n$-流形，$U\subseteq M$
  是开集，$f:U\to N$ 是光滑映射。令 $\Gamma(f)\subseteq M\times N$ 为 $f$
  的图像：
  \[
    \Gamma(f)=\left\{(x,y)\in M\times N\,\middle|\, x\in U,y=f(x)\right\}  .
  \]
  那么 $\Gamma(f)$ 是 $M\times N$ 的嵌入 $m$-维子流形。
\end{proposition}
\begin{proof}
  定义映射 $\gamma_f:U\to M\times N$ 为
  \[
    \gamma_f(x)=(x,f(x)),
  \]
  那么 $\gamma_f$ 是像集为 $\Gamma(f)$ 的光滑映射。投影映射 $\pi_M:M\times N\to M$
  满足 $\pi_M\circ\gamma_f=\Id_U$，所以对于任意的 $x\in U$，有 
  $d(\pi_M)_{(x,f(x))}\circ d(\gamma_f)_x=\Id_{T_xM}$，所以 $d(\gamma_f)_x$
  是单射，故 $\gamma_f$ 是光滑浸入。$\gamma_f$ 也是拓扑嵌入，因为
  $\pi_M|_{\Gamma(f)}$ 为 $\gamma_f$ 的逆映射。所以 $\Gamma(f)$
  是同胚于 $U$ 的嵌入子流形。
\end{proof}

\subsection{嵌入子流形的切片坐标卡}

下面的定理将表明嵌入子流形可以局部地建模在 $\mathbb{R}^k$ 到 $\mathbb{R}^n$
的标准嵌入上，我们把 $\mathbb{R}^k$ 视为子空间
\[
  \left\{\left(x^1,\dots,x^k,x^{k+1},\dots,x^n\right)\,\middle|\,x^{k+1}=\cdots=x^n=0\right\}  
  \subseteq\mathbb{R}^n.
\]
更一般地，如果 $U$ 是 $\mathbb{R}^n$ 的开子集，定义\emph{$U$ 的 $k$-维切片}
(简称 $k$-切片)是
形如
\[
  S=\left\{\left(x^1,\dots,x^k,x^{k+1},\dots,x^n\right)\in U\,\middle|\,
  x^{k+1}=c^{k+1},\dots,x^n=c^n\right\}  
\]
的任意子集，其中 $c^{k+1},\dots,c^n$ 是常数。显然，每个 $k$-切片
都同胚于 $\mathbb{R}^k$ 的一个开子集。

令 $M$ 是光滑 $n$-流形，$(U,\varphi)$ 是一个光滑坐标卡。如果 $S$
是 $U$ 的子集并且使得 $\varphi(S)$ 是 $\varphi(U)$ 的 $k$-切片，那么我们说
$S$ 是\emph{$U$ 的 $k$-切片}。(虽然一般来说我们允许切片由任意常数
$c^{k+1},\dots,c^n$ 定义，但是有时候将这些常数定义为零是更有用的，这只需要
将每个坐标函数减去一个常数即可做到。)给定一个子集 $S\subseteq M$，
如果 $S$ 的每个点都被包含在 $M$ 的某个光滑坐标卡 $(U,\varphi)$ 中且使得
$S\cap U$ 是 $U$ 的 $k$-切片，那么我们说 $S$ 满足\emph{局部 $k$-切片条件}。
任意这样的坐标卡被称为\emph{$S$ 在 $M$ 中的切片坐标卡}，对应的坐标 
$\left(x^1,\dots,x^n\right)$ 被称为\emph{切片坐标}。

\begin{theorem}[嵌入子流形的局部切片判别法]
  令 $M$ 是光滑 $n$-流形，如果 $S\subseteq M$ 是嵌入 $k$-维子流形，那么
  $S$ 满足局部 $k$-切片条件。反之，如果 $S\subseteq M$ 满足局部 $k$-切片条件，
  那么在子空间拓扑下，$S$ 是 $k$-维拓扑流形，并且有一个光滑结构使其成为
  $M$ 的 $k$-维嵌入子流形。
\end{theorem}
\begin{proof}
  设 $S\subseteq M$ 是嵌入 $k$-维子流形，那么包含映射 $\iota:S\hookrightarrow M$
  是光滑嵌入，从而是光滑浸入。任取 $p\in S$，根据秩定理，存在 $S$
  的 $p$ 为中心的光滑坐标卡 $(U,\varphi)$ 和 $M$ 的 $p$ 为中心的光滑坐标卡
  $(V,\psi)$ 使得 $U=\iota(U)\subseteq V$ 并且 $\iota$ 的坐标表示
  $\psi\circ\iota|_U\circ\varphi^{-1}:\varphi(U)\to \psi(V)$ 为
  \[
    \left(x^1,\dots,x^k\right)  \to\left(x^1,\dots,x^k,0,\dots,0\right).
  \]
  由于 $U$ 是 $S$ 的开集，所以存在 $M$ 的开集 $W$ 使得 $U=W\cap S$，
  令 $V_0=W\cap V$，那么 $S\cap V_0=U\cap V=U$ 是 $V_0$
  的 $k$-切片，所以 $(V_0,\psi|_{V_0})$ 是 $S$ 在 $M$
  中的切片坐标卡。故 $S$ 满足局部 $k$-切片条件。

  反之，设 $S$ 满足局部 $k$-切片条件。在子空间拓扑下，$S$ 是 Hausdorff 的
  和第二可数的，下面我们构造 $S$ 的坐标卡。

  记 $\pi:\mathbb{R}^n\to\mathbb{R}^k$ 是前 $k$ 个坐标的投影。
  设 $(U,\varphi)$ 是 $S$ 在 $M$ 中的切片坐标卡，定义
  $V=U\cap S$，$\psi=\pi\circ\varphi|_V$。由于 $\varphi(V)$
  是 $\varphi(U)$ 的 $k$-切片，即 $\varphi(V)=\varphi(U)\cap A$，其中
  \[
    A=\left\{\left(x^1,\dots,x^k,x^{k+1},\dots,x^n\right)\in\mathbb{R}^n\,\middle|\,
      x^{k+1}=c^{k+1},\dots,x^n=c^n
    \right\},
  \]
  显然 $A$ 微分同胚于 $\mathbb{R}^k$。由于 $\varphi(U)$ 是 $\mathbb{R}^n$
  的开集，所以 $\varphi(V)=\varphi(U)\cap A$ 是 $A$ 的开集，所以
  $\psi(V)=\pi\circ\varphi(V)$ 是 $\pi(A)=\mathbb{R}^k$ 的开集。此外，
  $\psi:V\to\psi(V)$ 是同胚，因为其有连续逆映射 $\varphi^{-1}\circ j|_{\psi(V)}$，
  其中 $j:\mathbb{R}^k\to\mathbb{R}^n$ 为 
  \[
    j\left(x^1,\dots,x^k\right)=\left(x^1,\dots,x^k,c^{k+1},\dots,c^n\right).
  \]
  这表明 $S$ 是一个拓扑 $k$-流形，并且包含映射 $\iota:S\hookrightarrow M$ 是拓扑嵌入。

  下面我们验证上述坐标卡之间的相容的。设 $(U,\varphi)$ 和 $(U',\varphi')$ 是
  $S$ 在 $M$ 中的两个切片坐标卡，令 $(V,\psi)$ 和 $(V',\psi')$ 为对应的
  $S$ 的坐标卡。转移映射为 $\psi'\circ\psi^{-1}=\pi\circ\varphi'\circ\varphi^{-1}\circ j$，
  这是光滑映射的复合，所以 $\psi'\circ\psi^{-1}$ 是光滑的。这定义了 $S$
  上的光滑结构。选取 $S$ 在 $M$ 中的切片坐标卡 $(U,\varphi)$ 和对应的 $S$
  的坐标卡 $(V,\psi)$，包含映射 $\iota:S\hookrightarrow M$ 的坐标表示为
  \[
    \left(x^1,\dots,x^k\right)\mapsto\left(
      x^1,\dots,x^k,c^{k+1},\dots,c^n
    \right),
  \]
  这是一个光滑浸入。所以 $\iota$ 是光滑嵌入，$S$ 是 $M$ 的嵌入子流形。
\end{proof}

\begin{example}[球面作为子流形]
  $\mathbb{S}^n$ 是 $\mathbb{R}^{n+1}$ 的嵌入子流形。
  令 $U_i^+=\{x\in\mathbb{R}^{n+1}\,|\, x^i>0\}$，我们知道 $\mathbb{S}^n\cap U_i^+$
  是光滑函数
  \[
    x^i=f\left(x^1,\dots,x^{i-1},x^{i+1},\dots,x^{n+1}\right)  
  \]
  的图像，其中 $f:\mathbb{B}^n\to\mathbb{R}$ 为 $f(u)=\sqrt{1-|u|^2}$。
  类似地，令 $U_i^-=\{x\in\mathbb{R}^{n+1}\,|\, x^i<0\}$，$\mathbb{S}^n\cap U_i^-$
  是 $-f$ 的图像。根据 \autoref{prop:graph is submanifold}，每个
  $\mathbb{S}^n\cap U_i^\pm$ 都是 $\mathbb{R}^{n+1}$ 的 $n$ 维嵌入子流形，所以
  满足局部 $n$-切片条件，所以 $\mathbb{S}^n$ 满足局部 $n$-切片条件，
  因此 $\mathbb{S}^n$ 是嵌入子流形。

  我们也可以直接写出 $\mathbb{S}^n$ 在 $\mathbb{R}^{n+1}$ 中的切片坐标卡。
  记
  \[
    V_i^+=\left\{\left(x^1,\dots,x^{n+1}\right)\,\middle|\,
    \left(x^1,\dots,x^{i-1},x^{i+1},\dots,x^{n+1}\right)\in\mathbb{B}^n,x^i>0\right\} , 
  \]
  类似地，记 $V_i^-$ 为上述集合，其中 $x^i<0$。定义
  $\varphi_i^\pm:V_i^\pm\to\mathbb{R}^{n+1}$ 为
  \[
    \left(x^1,\dots,x^{n+1}\right)\mapsto\left(
      u,x^i\mp f(u)
    \right)  ,
  \]
  其中 $u=\left(x^1,\dots,x^{i-1},x^{i+1},\dots,x^{n+1}\right)$。不难验证
  $\varphi_i^\pm\left(V_i^\pm\right)=\mathbb{B}^{n}\times\mathbb{R}$。
  此时 $\left(V_i^\pm,\varphi_i^\pm\right)$ 就是 $\mathbb{S}^n$ 在 $\mathbb{R}^{n+1}$
  中的切片坐标卡，因为
  \[
    \varphi_i^\pm\left(V_i^\pm\cap\mathbb{S}^n\right)=\mathbb{B}^n
  \]
  是 $\varphi_i^\pm\left(V_i^\pm\right)$ 的 $n$-切片。
\end{example}


\subsection{水平集}

如果 $\varPhi:M\to N$ 是任意映射，$c\in N$，我们说 $\varPhi^{-1}(c)$
是\emph{$\varPhi$ 的水平集}。在 $N=\mathbb{R}^k$ 和 $c=0$ 的时候，
水平集 $\varPhi^{-1}(0)$ 通常被称为\emph{零点集}。

\begin{theorem}[常秩水平集定理]
  令 $M,N$ 是光滑流形，$\varPhi:M\to N$ 是光滑映射，并且有常秩 $r$。
  $\varPhi$ 的每个水平集都是 $M$ 的余维数为 $r$ 的嵌入子流形。
\end{theorem}
\begin{proof}
  记 $m=\dim M$，$n=\dim N$。任取 $p\in \varPhi^{-1}(c)$，根据秩定理，
  存在以 $p$ 为中心的 $M$ 的光滑坐标卡 $(U,\varphi)$ 和以 $\varPhi(p)$
  为中心的 $N$ 的光滑坐标卡 $(V,\psi)$，使得 $\varPhi(U)\subseteq V$
  并且 $\varPhi$ 的坐标表示为
  \[
    \left(x^1,\dots,x^m\right)\mapsto\left(x^1,\dots,x^r,0,\dots,0\right),
  \]
  那么 
  \[ 
    \varphi\left(\varPhi^{-1}(c)\cap U\right)=
    \varphi\left(\varPhi^{-1}(c)\right)\cap\varphi(U)=
    \varphi\left(\varPhi^{-1}\left(\psi^{-1}(0)\right)\right)\cap\varphi(U)
  \]
  是 $\varphi(U)$ 的 $(m-r)$-切片
  \[
    \left\{\left(x^1,\dots,x^m\right)\in\varphi(U)\,\middle|\, x^1=\cdots=x^r=0\right\}  .
  \]
  这表明 $\varPhi^{-1}(c)$ 满足局部 $(m-r)$-切片条件，所以是 $M$ 的 $(m-r)$-维
  嵌入子流形。
\end{proof}

\begin{corollary}[浸没水平集定理]
  如果 $M,N$ 是光滑流形，$\varPhi:M\to N$ 是光滑浸没，那么 $\varPhi$
  的水平集是 $M$ 的余维数为 $\dim N$ 的嵌入子流形。
\end{corollary}

如果 $\varPhi:M\to N$ 是光滑映射，点 $p\in M$ 使得 $d\varPhi_p:T_pM\to T_{\varPhi(p)}N$
是满射，那么 $p$ 被称为\emph{$\varPhi$ 的正则点}，否则被称为\emph{$\varPhi$ 的临界点}。
我们有以下两个简单的观察：如果 $\dim M<\dim N$，那么 $M$ 的每个点都是临界点；
$M$ 的每个点都是正则点当且仅当 $\varPhi$ 是浸没。
根据 \autoref{prop:regular points is open}，我们知道 $\varPhi$ 的正则点的集合
是 $M$ 的开集。一个点 $c\in N$ 被称为\emph{$\varPhi$ 的正则值}，如果水平集
$\varPhi^{-1}(c)$ 中的每个点都是正则点，否则被称为\emph{$\varPhi$ 的临界值}。
特别地，如果 $\varPhi^{-1}(c)=\emptyset$，那么 $c$ 是正则值。
如果 $c$ 是正则值，那么水平集 $\varPhi^{-1}(c)$ 被称为\emph{正则水平集}。

\begin{corollary}[正则水平集定理]
  令 $M,N$ 是光滑流形，$\varPhi:M\to N$ 是光滑映射，$c\in N$ 是正则值，那么
  正则水平集 $\varPhi^{-1}(c)$ 是 $M$ 的余维数为 $\dim N$ 的嵌入子流形。
\end{corollary}
\begin{proof}
  令 $U$ 为 $\varPhi$ 的所有正则值的集合，根据 \autoref{prop:regular points is open}，
  $U$ 是 $M$ 的开子集。显然 $\varPhi^{-1}(c)\subseteq U$。此时
  $\varPhi|_U:U\to N$ 是光滑浸没，根据浸没水平集定理，$\varPhi^{-1}(c)$
  是 $U$ 的嵌入子流形。因为光滑嵌入的复合 $\varPhi^{-1}(c)\hookrightarrow U\hookrightarrow M$
  是光滑嵌入，所以 $\varPhi^{-1}(c)$ 是 $M$ 的嵌入子流形。
\end{proof}

\begin{example}[球面]
  现在我们可以更简单地证明 $\mathbb{S}^n$ 是 $\mathbb{R}^{n+1}$ 的嵌入子流形。
  定义光滑函数 $f:\mathbb{R}^{n+1}\to\mathbb{R}$ 为 $f(x)=\abs{x}^2$，因为
  $df_x(v)=2\sum_i x^iv^i$，所以 $x\neq 0$ 时 $df_x$ 都是满射，所以
  $\mathbb{S}^n=f^{-1}(1)$ 是 $f$ 的正则水平集，故 $\mathbb{S}^n$
  是 $\mathbb{R}^{n+1}$ 的余维数为 $1$ 的嵌入子流形。
\end{example}

\begin{proposition}
  令 $S$ 为光滑 $m$-流形 $M$ 的子集，那么 $S$ 是 $M$ 的嵌入 $k$-子流形当且仅当
  $S$ 的每个点都有 $M$ 中的邻域 $U$ 使得 $U\cap S$ 是某个光滑浸没 $\varPhi:U\to \mathbb{R}^{m-k}$
  的水平集。
\end{proposition}
\begin{proof}
  若 $S$ 是嵌入 $k$-子流形，任取 $p\in S$，存在 $S$ 在 $M$ 中的切片坐标卡 $(U,\varphi)$，
  使得 $\varphi(U\cap S)$ 是 $\varphi(U)$ 的 $k$-切片，令 $\varPhi:U\to \mathbb{R}^{m-k}$
  为 $\varPhi=\pi\circ\varphi$，其中 $\pi:\mathbb{R}^m\to \mathbb{R}^{m-k}$
  是后 $m-k$ 个坐标的投影，显然 $\varPhi$ 是光滑浸没，且 
  $U\cap S$ 是 $\varPhi$ 的某个水平集。反之，若任取 $p\in S$
  都存在 $M$ 中的邻域 $U$ 使得 $U\cap S$ 是光滑浸没 $\varPhi:U\to \mathbb{R}^{m-k}$
  的水平集，根据浸没水平集定理，$U\cap S$ 是 $U$ 的嵌入 $k$-子流形，从而是
  $M$ 的嵌入 $k$-子流形，这表明 $S$ 满足局部 $k$-切片条件，所以
  $S$ 是 $M$ 的嵌入 $k$-子流形。
\end{proof}

若 $S\subseteq M$ 是嵌入子流形，光滑映射 $\varPhi:M\to N$ 使得 $S$ 是 $\varPhi$
的正则水平集，那么 $\varPhi$ 被称为 $S$ 的\emph{定义映射}。特别地，在 $N=\mathbb{R}^{m-k}$
的情况下，$\varPhi$ 被称为 $S$ 的\emph{定义函数}。若 $U$ 是 $M$ 的开子集，
$\varPhi:U\to N$ 是使得 $S\cap U$ 为正则水平集的光滑映射，那么 $\varPhi$
被称为 $S$ 的\emph{局部定义映射}。




\section{浸入子流形}

设 $M$ 是带边或者无边光滑流形，一个子集 $S\subseteq M$ 如果
配备了一个拓扑（不一定是子空间拓扑），在这个拓扑下成为一个拓扑流形，
并且有一个光滑结构使得包含映射 $S\hookrightarrow M$ 是光滑浸入，那么
我们说 $S$ 是 $M$ 的\emph{浸入子流形}。与嵌入子流形类似，
我们定义 $S$ 在 $M$ 中的\emph{余维数}是 $\dim M-\dim S$。

显然，每个嵌入子流形都是浸入子流形，因此浸入子流形是一种更一般的子流形。

\begin{proposition}[浸入的像集作为子流形]\label{prop:image of immersion}
  设 $M$ 是带边或者无边光滑流形，$N$ 是光滑流形，$F:N\to M$
  是单射的光滑浸入。令 $S=F(N)$，那么 $S$ 有唯一的拓扑结构和光滑结构
  使得 $S$ 是 $M$ 的一个光滑子流形并且 $F:N\to S$ 是微分同胚。
\end{proposition}
\begin{proof}
  证明和 \autoref{prop:image of embedding} 基本类似，只不过我们现在凭借
  $N$ 来给予 $S$ 的拓扑结构。定义 $U\subseteq S$ 是开集当且仅当
  $F^{-1}(U)$ 是 $N$ 的开集。定义 $S$ 的坐标卡形如 $\left(F(U),\varphi\circ F^{-1}\right)$，
  其中 $(U,\varphi)$ 是 $N$ 的光滑坐标卡。这些坐标卡是光滑相容的，
  所以给出了 $S$ 上的一个光滑结构。显然在这个光滑结构下，$F:N\to S$
  是微分同胚。包含映射 $S\hookrightarrow M$ 是微分同胚和光滑浸入的复合
  \[
    S\xlongrightarrow{F^{-1}} N\xlongrightarrow{F} M,  
  \]
  所以 $S\hookrightarrow M$ 是光滑浸入，即 $S$ 是 $M$ 的光滑子流形。
\end{proof}

\begin{exercise}{}{}
  设 $M$ 是光滑流形，$S\subseteq M$ 是浸入子流形。证明：
  $S$ 的子空间拓扑下的开集在上述子流形拓扑下也是开的。
  此外，$S$ 在子流形拓扑下的开集是子空间拓扑下的开集当且仅当
  $S$ 是嵌入子流形。
\end{exercise}
\begin{proof}
  设 $U$ 是 $S$ 在子空间拓扑下的开子集，那么存在 $M$ 的开子集 $W$
  使得 $U=S\cap W$，此时 $U=\iota(\iota^{-1}(W))$，由于 $\iota^{-1}(W)$
  是 $S$ 的开子集，所以 $U$ 是 $S$ 在子流形拓扑下的开子集。 

  若 $S$ 在子流形拓扑下的开集是子空间拓扑下的开集，此时表明 $S$
  的子流形拓扑就是子空间拓扑。所以包含映射 $\iota:S\hookrightarrow M$
  是拓扑嵌入，从而是光滑嵌入，即 $S$ 是嵌入子流形。反之，若 $S$
  是嵌入子流形，那么 $\iota:S\hookrightarrow M$ 是拓扑嵌入，
  所以若 $U\subseteq S$ 是开集，那么 $U=\iota(U)$ 是 $\iota(S)=S$
  的开集，即 $U$ 是 $S$ 在子空间拓扑下的开集。
\end{proof}

\begin{proposition}
  设 $M$ 是带边或者无边光滑流形，$S\subseteq M$ 是浸入子流形。
  如果下面三个条件之一被满足，那么 $S$ 是嵌入子流形。
  \begin{enumerate}
    \item $S$ 在 $M$ 中的余维数是 $0$。
    \item 包含映射 $S\hookrightarrow M$ 是恰当映射。
    \item $S$ 是紧子集。
  \end{enumerate}
\end{proposition}
\begin{proof}
  (1) 若 $S$ 在 $M$ 中的余维数是 $0$，由于包含映射 $\iota:S\hookrightarrow M$
  是光滑浸入且 $\dim S=\dim M$，根据 \autoref{prop:local diffeomorphism}，
  $\iota$ 是局部微分同胚，所以是开映射，所以 $S$ 是 $M$ 的开子集，
  故 $\iota$ 为拓扑嵌入，所以 $S$ 是嵌入子流形。
\end{proof}

% 设 $S\subseteq M$ 是浸入 $k$-维子流形。设 $U\subseteq \mathbb{R}^k$ 是开集，
% 如果连续映射 $X:U\to M$ 的像集是 $S$ 的开子集并且 $X:U\to S$ 是拓扑嵌入，
% 那么我们说 $X$ 是\emph{$S$ 的局部参数化}。如果 $X:U\to S$
% 是 $U\to X(U)$ 的微分同胚(相对于 $S$ 的光滑流形结构)，那么我们说
% $X$ 是\emph{光滑局部参数化}。如果 $X$ 的像集是整个 $S$，那么 $X$
% 被称为\emph{全局参数化}。

\begin{proposition}[浸入子流形是局部的嵌入]
  如果 $M$ 是带边或者无边光滑流形，$S\subseteq M$ 是浸入子流形，那么对于每个
  $p\in S$，都存在 $p$ 在 $S$ 中的邻域 $U$ 使得 $U$ 是 $M$ 的嵌入子流形。
\end{proposition}
\begin{proof}
  包含映射 $\iota:S\hookrightarrow M$ 是光滑浸入，任取 $p\in S$，根据
  \autoref{thm:local embedding}，存在 $p$ 在 $S$ 中的邻域 $U$ 使得
  $\iota|_U:U\hookrightarrow M$ 是光滑嵌入，即 $U$ 是 $M$ 的嵌入子流形。
\end{proof}


\section{将映射限制在子流形上}

\begin{theorem}[光滑映射限制定义域]
  如果 $M,N$ 是带边或者无边光滑流形，$F:M\to N$ 是光滑映射，$S\subseteq M$
  是浸入或者嵌入子流形，那么 $F|_S:S\to N$ 是光滑映射。
\end{theorem}
\begin{proof}
  注意到 $F|_S=F\circ\iota$，其中 $\iota:S\hookrightarrow M$ 是包含映射。
  那么 $F|_S$ 作为光滑映射的复合是光滑的。
\end{proof}

\begin{theorem}[光滑映射限制值域]
  设 $M$ 是光滑流形，$S\subseteq M$ 是浸入子流形，$F:N\to M$
  是光滑映射并且 $F(N)\subseteq S$，如果 $F:N\to S$ 是连续映射，那么
  $F:N\to S$ 光滑。
\end{theorem}
\begin{proof}
  任取 $p\in N$，记 $q=F(p)\in S$。根据局部嵌入定理，存在 $q$ 在 $S$ 中的某个邻域 $V$
  使得 $V$ 是 $M$ 的嵌入子流形，所以存在 $V$ 在 $M$ 中的切片坐标卡 $(W,\psi)$，
  令 $V_0=W\cap V$，设 $\psi(V_0)$ 是 $\psi(W)$ 的 $k$-切片。令 $\pi:\mathbb{R}^n\to \mathbb{R}^k$
  为前 $k$ 个分量的投影，$\tilde{\psi}=\pi\circ\psi$。由于 $V_0$ 是 $V$ 中的开集，
  $V$ 是 $S$ 的开集，所以 $V_0$ 是 $S$ 的开集，所以 $(V_0,\tilde\psi)$ 是 $S$ 的光滑坐标卡。

  令 $U=F^{-1}(V_0)$，$F:N\to S$ 连续表明 $U$ 是 $N$ 的开集，取 $p$ 处的光滑坐标卡 $(U_0,\varphi)$
  使得 $U_0\subseteq U$，那么 $F:N\to S$ 的坐标表示为
  \[
    \tilde{\psi}\circ F\circ \varphi^{-1}=\pi\circ(\psi\circ F\circ\varphi^{-1}),
  \] 
  右端的 $F:N\to M$，所以这是光滑映射，故 $F:N\to S$ 光滑。
\end{proof}

\begin{corollary}
  令 $M$ 是光滑流形，$S\subseteq M$ 是嵌入子流形，那么光滑映射 $F:N\to M$ 只要 $F(N)\subseteq S$，
  那么 $F:N\to S$ 就是光滑映射。
\end{corollary}
\begin{proof}
  $S$ 配备子空间拓扑，所以 $F:N\to S$ 作为连续映射的限制是连续映射。
\end{proof}

\section{子流形的切空间}

令 $M$ 是带边或者无边光滑流形，$S\subseteq M$ 是嵌入或者浸入子流形，由于 $\iota:S\hookrightarrow M$
是光滑浸入，所以任取 $p\in S$ 微分 $d\iota_p:T_pS\to T_pM$ 是单射，这意味着我们可以把 $T_pS$ 视为
$T_pM$ 的子空间，此时对于任意切向量 $v\in T_pS$，它的像 $\tilde v=d\iota_p(v)\in T_pM$ 为
\[
  \tilde{v}f=d\iota_p(v)(f)=v(f\circ\iota)=v(f|_S),
\]
其中 $f\in C^\infty(M)$，我们将 $v$ 和 $\tilde v$ 等同。注意这种等同与嵌入或者浸入无关。

\begin{proposition}
  设 $M$ 是带边或者无边光滑流形，$S\subseteq M$ 是浸入或者嵌入子流形，$p\in S$。
  切向量 $v\in T_pM$ 在 $T_pS$ 中当且仅当存在光滑曲线 $\gamma:J\to M$，
  其像集 $\gamma(J)\subseteq S$，并且作为 $J\to S$ 的映射是光滑映射，使得
  $0\in J$，$\gamma(0)=p$ 以及 $\gamma'(0)=v$。
\end{proposition}
\begin{proof}
  $v\in T_pS$ 意味着存在 $w\in T_pS$ 使得 $v=d\iota_p(w)$，
  根据 \autoref{prop:velocity}，存在光滑曲线 $\tilde\gamma:J\to S$
  使得 $\tilde\gamma(0)=p$，$\tilde\gamma'(0)=w$，令
  $\gamma=\iota\circ\tilde{\gamma}$，那么 $\gamma'(0)=d\iota_p(\gamma'(0))=v$。
  反之，由于 $\tilde{\gamma}:J\to S$ 是光滑映射，所以
  $\gamma=\iota\circ\tilde{\gamma}$，所以
  \[
    v=\gamma'(0)=d\iota_p(\tilde \gamma'(0))  \in \im d\iota_p.\qedhere
  \]
\end{proof}

\begin{proposition}
  设 $M$ 是光滑流形，$S\subseteq M$ 是嵌入子流形，$p\in S$。
  切空间 $T_pS$ 作为 $T_pM$ 的子空间可以刻画为
  \[
    T_pS=\bigl\{v\in T_pM\,|\, \forall f\in C^\infty(M), f|_S=0,vf=0\bigr\}  .
  \]
\end{proposition}
\begin{proof}
  任取 $v=d\iota_p(w)\in T_p S\subseteq T_pM$，那么对于任意 $f\in C^\infty(M)$ 且 $f|_S=0$，有
  \[
    vf=d\iota_p(w)f=w(f\circ\iota_p)=w(f|_S)=0.
  \]

  反之，若 $v\in T_pM$ 满足 $f|_S=0$ 的时候 $vf=0$。
  假设 $(U,\varphi=(x^1,\dots,x^n))$ 是 $S$ 在 $M$ 中的切片坐标卡，
  那么 $T_pM$ 的一组基为 $\partial/\partial x^i|_p$。
  设 $\varphi(S\cap U)$ 是 $\varphi(U)$ 的 $k$-切片，那么
  $\iota:S\cap U\hookrightarrow M$ 的坐标表示为
  \[
    \varphi\circ\iota\circ\tilde\varphi^{-1}:\left(x^1,\dots,x^k\right)\mapsto
    \left(x^1,\dots,x^k,0,\dots,0\right)  ,
  \]
  这表明
  \[
    d\iota_p\left(\left.\frac{\partial}{\partial x^i}\right|_p\right)
    =  \left.\frac{\partial}{\partial x^i}\right|_p,\quad i=1,\dots,k.
  \]
  所以 $d\iota_p(T_pS)$ 是由 $\partial/\partial x^1|_p,\dots,\partial/\partial x^k|_p$
  张成的 $T_pM$ 的子空间。设
  \[
    v=v^i \left.\frac{\partial}{\partial x^i}\right|_p\in T_pM,  
  \]
  所以 $v\in T_pS$ 当且仅当 $v^j=0\ (j>k)$。

  令 $\psi:M\to \mathbb{R}$ 是关于 $\{p\}$ 的支在 $U$ 中的光滑鼓包函数，
  对于每个 $j>k$，考虑函数 $f(q)=\psi(q)x^j$，其中 $q\in M$。
  显然 $f|_S=0$，所以
  \[
    0=vf= v^i\frac{\partial (f\circ\varphi^{-1})}{\partial x^i}(\varphi(p))
    =v^j.\qedhere  
  \]
\end{proof}

\begin{proposition}
  假设 $M$ 是光滑流形，$S\subseteq M$ 是嵌入子流形，如果 $\varPhi:U\to N$
  是 $S$ 的局部定义映射，那么 $T_pS=\ker d\varPhi_p:T_pM\to T_{\varPhi(p)}N$，
  其中 $p\in S\cap U$。
\end{proposition}
\begin{proof}
  根据定义，$S\cap U$ 是 $\varPhi$ 的正则水平集，令 $\iota:S\cap U\hookrightarrow U$，
  那么 $\varPhi\circ\iota:S\cap U\to N$ 是常值映射，所以
  $d(\varPhi\circ\iota)_p:T_pS\to T_{\varPhi(p)}N$ 是零映射，所以
  \[
    d\varPhi_p\circ d\iota_p=d(\varPhi\circ\iota)_p=0,
  \]
  这表明 $T_pS=\im d\iota_p\subseteq \ker d\varPhi_p$。另一方面，$\varPhi$ 是定义映射表明
  $d\varPhi_p$ 是满射，故
  \[
    \dim\ker d\varPhi_p=\dim T_pM-\dim T_{\varPhi(p)}N=\dim S\cap U=
    \dim T_pS,
  \]
  这就表明 $T_pS=\ker d\varPhi_p$。
\end{proof}

\begin{corollary}
  设 $S\subseteq M$ 是光滑浸没 $\varPhi=(\varPhi^1,\dots,\varPhi^k):M\to \mathbb{R}^k$
  的水平集，切向量 $v\in T_pM$ 在 $T_pS$ 中当且仅当 $v\varPhi^1=\cdots=v\varPhi^k=0$。
\end{corollary}

\begin{exercise}\label{exer:tangent space of submanifold}
  设 $S\subseteq M$ 是常秩映射 $\varPhi:M\to N$ 的水平集，证明对于每个 $p\in S$
  有 $T_pS=\ker d\varPhi_p$。
\end{exercise}
\begin{proof}
  根据常秩水平集定理，有 $\dim S=\dim M-\dim N$，故
  \[
    \dim T_pS=\dim T_pM-\dim T_{\varPhi(p)}N=\dim \ker d\varPhi_p.
  \]
  记 $\iota:S\hookrightarrow M$，那么 $\varPhi\circ\iota:S\to N$ 是常值映射，
  所以 $d(\varPhi\circ \iota)_p=0$，这就表明 $T_pS=\ker d\varPhi_p$。
\end{proof}



\chapter{李群}

\section{基本定义}

\begin{example}[李群]
  \mbox{}
  \begin{enumerate}
    \item $n\times n$ 可逆实矩阵集合 $\GL(n,\mathbb{R})$ 被称为\emph{一般线性群}。
    其是 $M(n,\mathbb{R})$ 的开子流形，由于矩阵乘法 $AB$ 是多项式，所以
    是光滑的。矩阵求逆的光滑性由 Cramer 法则保证。
    \item 令 $\GL^+(n,\mathbb{R})$ 表示 $\GL(n,\mathbb{R})$ 中行列式为正的
    可逆矩阵集合。显然 $\GL^+(n,\mathbb{R})$ 是 $\GL(n,\mathbb{R})$ 的子群
    同时是开子集，所以其群运算作为 $\GL(n,\mathbb{R})$ 的群运算的限制是光滑的，
    所以 $\GL^+(n,\mathbb{R})$ 是李群。
    \item 设 $G$ 的任意李群，$H\subseteq G$ 是\emph{开子群}(子群同时是开子集)。
    类似 (2) 中的叙述，$H$ 是李群，其群结构和光滑结构都继承于 $G$。
    \item Euclid 空间 $\mathbb{R}^n$ 在加法下是李群。
    \item 
  \end{enumerate}
\end{example}

\section{李群同态}

如果 $G,H$ 是李群，如果 $F:G\to H$ 同时是群同态和光滑映射，那么我们说
$F$ 是\emph{李群同态}。如果 $F$ 还是微分同胚，那么我们说 $F$
是\emph{李群同构}。

\begin{theorem}
  李群同态是常秩映射。
\end{theorem} 
\begin{proof}
  设 $F:G\to H$ 是李群同态，记 $G$ 的单位元为 $e$，$H$ 的单位元为 $\tilde{e}$。
  任取 $g_0\in G$，对于任意 $g\in G$，有
  \[
    F(L_{g_0}(g))=F(g_0g)=F(g_0)F(g)=L_{F(g_0)}(F(g)),  
  \] 
  所以 $F\circ L_{g_0}=L_{F(g_0)}\circ F$，所以
  \[
    dF_{g_0}\circ d\left(L_{g_0}\right)_e=d\left(L_{F(g_0)}\right)_{\tilde{e}}\circ dF_e,  
  \]
  由于 $L_{g_0}$ 和 $L_{F(g_0)}$ 是微分同胚，所以 $dF_{g_0}$ 和 $dF_e$
  有相同的秩，故 $F$ 是常秩映射。
\end{proof}

\begin{corollary}
  一个李群同态是李群同构当且仅当其是双射。
\end{corollary}
\begin{proof}
  全局秩定理表明双射的常秩映射是微分同胚。
\end{proof}

\section{李子群}

设 $G$ 的李群，$G$ 的\emph{李子群}指的是 $G$ 的一个子群，配备了一个拓扑
和光滑结构使得其成为一个李群以及 $G$ 的浸入子流形。

\begin{proposition}\label{prop:embedding and subgroup is lie subgroup}
  令 $G$ 是李群，设 $H\subseteq G$ 是子群同时是嵌入子流形，那么 $H$ 是李子群。
\end{proposition}
\begin{proof}
  乘法 $G\times G\to G$ 是光滑的，$H$ 是嵌入子流形表明 $H\times H\to G$
  光滑(这一步实际上只需要浸入子流形)，将值域限制在嵌入子流形不改变光滑性，
  所以 $H\times H\to H$ 是光滑的。类似地，求逆也是光滑映射，所以 $H$
  是李群。
\end{proof}

\begin{lemma}
  设 $G$ 是李群，$H\subseteq G$ 是开子群。那么 $H$ 是嵌入李子群并且是闭集，故 $H$
  是 $G$ 的连通分支的并。
\end{lemma}
\begin{proof}
  $H$ 是开子流形表明 $H$ 是嵌入李子群。对于任意 $g\in G$，陪集 $gH=L_g(H)$ 是开集，所以
  $G\smallsetminus H$ 作为陪集的并是开集，所以 $H$ 是闭集。$H$ 既开又闭表明 $H$
  是连通分支的并集。
\end{proof}


\begin{proposition}
  设 $G$ 是李群，$W\subseteq G$ 是单位元处的任意邻域。
  \begin{enumerate}
    \item $W$ 生成 $G$ 的一个开子群。
    \item 如果 $W$ 是连通的，那么其生成 $G$ 的一个连通开子群。
    \item 如果 $G$ 是连通的，那么 $W$ 生成 $G$。
  \end{enumerate}
\end{proposition}
\begin{proof}
  (1) 记 $W_1=W\cup W^{-1}$，对于 $k\geq 2$，递归地定义 $W_k=W_1W_{k-1}$，那么
  \[
    \langle W\rangle=\bigcup_{k=1}^\infty W_k,
  \]
  由于求逆映射 $g\mapsto g^{-1}$ 是微分同胚，所以 $W^{-1}$ 是开集，所以 $W_1$ 是开集。
  假设 $W_{k-1}$ 是开集，那么
  \[
    W_k=\bigcup_{g\in W_1}L_g(W_{k-1})
  \]
  是开集的并，所以 $W_k$ 是开集。故 $\langle W\rangle$ 是开集。

  (2) 由于 $W$ 和 $W^{-1}$ 都是连通的，且 $e\in W\cap W^{-1}$，所以 $W_1$ 是连通的。
  假设 $W_{k-1}$ 是连通的，那么 $W_k=m(W_1\times W_{k-1})$ 是连通空间在连续映射下的像，所以是连通的。
  又因为 $e\in W_k$，所以 $\langle W\rangle$ 是连通的。

  (3) $\langle W\rangle$ 是开子群表明 $\langle W\rangle$ 是连通分支的并，$G$ 连通表明 $\langle W\rangle=G$。
\end{proof}

若 $G$ 是李群，则 $G$ 的包含单位元的连通分支被称为 $G$ 的\emph{单位分支}。

\begin{proposition}
  令 $G$ 是李群，$G_0$ 是单位分支。那么 $G_0$ 是 $G$ 的正规子群，并且是唯一的连通开子群。
  $G$ 的任意连通分支都微分同胚于 $G_0$。
\end{proposition}
\begin{proof}
  任取 $g\in G$，那么 $gG_0g^{-1}=L_g\left(R_{g^{-1}}(G_0)\right)$ 是连通的，并且 $e\in gG_0g^{-1}$，所以
  $gG_0g^{-1}\subseteq G_0$，这就表明 $G_0$ 是正规子群。设 $G_0'$ 是连通开子群，那么 $G_0'$ 是开子群表明
  $G_0'$ 是连通分支的并集，$G_0'$ 是连通的表明 $G_0'$ 是某一个连通分支，又因为 $e\in G_0'$，所以 $G_0'=G_0$
  是单位分支。设 $G_0'$ 是任意连通分支，任取 $g\in G_0'$，$g^{-1}G_0'=L_{g^{-1}}(G_0')$ 是连通的且包含
  单位元，故 $g^{-1}G_0'$ 被单位分支 $G_0$ 包含，那么 $L_{g}(G_0)=gG_0\supseteq G_0'$ 是连通的，所以
  $G_0'=gG_0=L_g(G_0)$ 微分同胚于 $G_0$。
\end{proof}
 
\begin{proposition}
  令 $F:G\to H$ 是李群同态，那么 $\ker F$ 是 $G$ 的恰当嵌入李子群，其余维数
  为 $\rk F$。
\end{proposition}
\begin{proof}
  根据常秩水平集定理，$\ker F$ 是 $G$ 的余维数为 $\rk F$ 的嵌入子流形。
  再根据 \autoref{prop:embedding and subgroup is lie subgroup}，$\ker F$
  是李子群。
\end{proof}

一般情况下，光滑子流形可以同时是非嵌入的以及闭的，例如八字曲线
\ref{exa:eight-curve}，但是下面的定理表明对于李子群而言，
闭和嵌入性并不是独立的，即嵌入性和闭等价。

\begin{theorem}
  设 $G$ 是李群，$H\subseteq G$ 是李子群，那么 $H$ 是闭集当且仅当
  $H$ 是嵌入李子群。
\end{theorem}

\section{群作用和等变映射}

如果 $M$ 是光滑流形，$G$ 是李群，群作用 $G\times M\to M$ 是光滑映射，
那么这个群作用被称为\emph{光滑作用}。
对于光滑作用 $\theta:G\times M\to M$，任取 $g\in G$，记 
$\theta_g:M\to M$ 为 $\theta_g(p)=g\cdot p$。由于 $\theta_{g^{-1}}$
是其光滑逆映射，所以 $\theta_g$ 一定是微分同胚。

设 $G$ 是李群，$M,N$ 是带边或者无边光滑流形并且都配备一个光滑
$G$-作用，映射 $F:M\to N$ 被称为\emph{等变的}，如果对于每个 $g\in G$
都有
\[
  F(g\cdot p)=g\cdot F(p) \ (\text{left actions})  ,\quad
  F(p\cdot g)=F(p)\cdot g \ (\text{right actions})  .
\]
等价地说，如果 $\theta$ 是 $G$ 在 $M$ 上的光滑作用，$\varphi$
是 $G$ 在 $N$ 上的光滑作用，那么 $F$ 是等变的当且仅当
\[
  F\circ \theta_g=\varphi_g\circ F.  
\]

\begin{theorem}[等变秩定理]
  设 $G$ 是李群，$M,N$ 是带边或者无边光滑流形，
  $F:M\to N$ 是光滑映射，相对于 $M$ 上的传递的光滑 $G$-作用 $\theta$ 和
  $N$ 上的任意光滑 $G$-作用 $\varphi$ 是等变的。那么 $F$ 是常值映射。
  进而，若 $F$ 是满射，那么是一个光滑浸没；若 $F$ 是单射，那么
  是一个光滑浸入；若 $F$ 是双射，那么是一个微分同胚。
\end{theorem}
\begin{proof}
  任取 $p,q\in M$，$\theta$ 是传递的表明存在 $g\in G$ 使得
  $q=\theta_g(p)$，那么 $F\circ\theta_g=\varphi_g\circ F$ 表明
  \[
    dF_{q}\circ d(\theta_g)_p=d(\varphi_g)_{F(p)}\circ dF_p,  
  \]
  $\theta_g$ 和 $\varphi_g$ 都是微分同胚表明 $dF_q$ 和 $dF_p$
  的秩相同，所以 $F$ 是常秩映射。
\end{proof}

假设 $G$ 是李群，$M$ 是光滑流形，$\theta:G\times M\to M$ 是光滑左作用，
对于每个 $p\in M$，定义\emph{轨道映射} $\theta^{(p)}:G\to M$ 为
\[
  \theta^{(p)}(g)=g\cdot p.  
\]
显然 $\theta^{(p)}$ 的像集就是 $p$ 所在的轨道。

\begin{proposition}[轨道映射的性质]
  假设 $\theta$ 是李群 $G$ 在光滑流形 $M$ 上的光滑左作用，对于每个
  $p\in M$，轨道映射 $\theta^{(p)}:G\to M$ 是光滑常秩映射，
  所以稳定化子 $G_p=\left(\theta^{(p)}\right)^{-1}(p)$
  是 $G$ 的恰当嵌入李子群。如果 $G_p=\{e\}$，那么
  $\theta^{(p)}$ 是单射的光滑浸入，所以轨道 $G\cdot p$
  是 $M$ 的浸入子流形。
\end{proposition}
\begin{proof}
  映射 $\theta^{(p)}$ 可以视为光滑映射的复合
  \[
    G\to G\times M\to M,  
  \]
  所以 $\theta^{(p)}$ 是光滑映射。考虑 $G$ 在自身上的作用为
  $g\cdot g'=gg'$，这是一个传递的光滑作用，那么
  \[
    \theta^{(p)}(g\cdot g')=(gg')\cdot p=g\cdot \theta^{(p)}(g'),  
  \]
  所以 $\theta^{(p)}$ 是等变映射，从而是常秩映射。根据常秩水平集定理，
  稳定化子 $G_p$ 是嵌入子流形，根据 \autoref{prop:embedding and subgroup is lie subgroup}，
  $G_p$ 是恰当嵌入李子群。若 $G_p=\{e\}$，那么
  \[
    \theta^{(p)}(g)=\theta^{(p)}(g')\Rightarrow
    p=(g^{-1}g')\cdot p\Rightarrow g^{-1}  g'\in G_p
    \Rightarrow g=g',
  \]
  所以 $\theta^{(p)}$ 为单射。再根据全局秩定理，$\theta^{(p)}$
  是浸入。根据 \autoref{prop:image of immersion}，轨道 $G\cdot p$
  是浸入子流形。
\end{proof}

\begin{example}[正交群]\label{exa:orthogonal group}
  由 $n\times n$ 正交矩阵构成的 $\GL(n,\mathbb{R})$ 的子群 
  $\Orth(n)$ 被称为正交群。定义光滑映射 $\varPhi:\GL(n,\mathbb{R})\to M(n,\mathbb{R})$
  为 $\varPhi(A)=A^TA$，那么 $\Orth(n)$ 是 $\varPhi$ 的水平集 $\varPhi^{-1}(I_n)$。
  我们只要能说明 $\varPhi$ 是常秩映射就能够表明 $\Orth(n)$ 是 
  $\GL(n,\mathbb{R})$ 的嵌入李子群。下面我们构造合适的群作用使得
  $\varPhi$ 是等变映射。定义 $\theta$ 为 $\GL(n.\mathbb{R})$
  在自身上的右乘作用，即 $A\cdot B=AB$。$\varphi$
  为 $\GL(n,\mathbb{R})$ 在 $M(n,\mathbb{R})$ 上的右作用为：
  \[
    X\cdot B=B^TXB,  
  \]
  那么
  \[
    \varPhi(A\cdot B)=(AB)^T(AB)=B^TA^TAB=\varPhi(A)\cdot B ,
  \]
  这就表明 $\varPhi$ 是等变映射，根据等变秩定理，$\varPhi$
  确实是常秩映射。因此，$\Orth(n)$ 是 $\GL(n,\mathbb{R})$
  的嵌入李子群。此外，不难发现 $\Orth(n)$ 是紧的。

  为了确定 $\Orth(n)$ 的维数，还需要确定 $\varPhi$ 的秩，即
  微分 $d\varPhi_{I_n}$ 的像空间的维数。对于 $B\in T_{I_n}\GL(n,\mathbb{R})=M(n,\mathbb{R})$，
  设 $\gamma:(-\varepsilon,\varepsilon)\to \GL(n,\mathbb{R})$ 
  光滑曲线 $\gamma(t)=I_n+tB$，那么
  \[
    d\varPhi_{I_n}(B)=\left.\frac{d}{dt}\right|_{t=0}\varPhi(\gamma(t))
    =\left.\frac{d}{dt}\right|_{t=0}(I_n+tB^T)(I_n+tB)
    =B+B^T,
  \]
  所以 $\im d\varPhi_{I_n}$ 被对称矩阵空间包含。反之，任取对称矩阵 $B$，
  有 $d\varPhi_{I_n}(B/2)=B$，所以 $\im d\varPhi_{I_n}$ 就是对称矩阵空间，
  维数为 $(n^2+n)/2$，这就表明 $\rk \varPhi=(n^2+n)/2$，
  故
  \[
    \dim\Orth(n)=\dim\GL(n,\mathbb{R})-\rk \varPhi
    =\frac{n^2-n}{2}.
  \]
\end{example}

\begin{example}[特殊正交群]
  $n\times n$ 特殊正交群被定义为行列式为 $1$ 的正交矩阵构成的集合，
  记为 $\SO(n)$。由于 $\det:\Orth(n)\to \mathbb{R}$ 为连续映射
  且 $\SO(n)=\det^{-1}(0,\infty)$，所以 $\SO(n)$ 是 $\Orth(n)$
  的开子集，故 $\SO(n)$ 是 $\Orth(n)$ 的嵌入李子群并且
  $\dim \SO(n)=\dim\Orth(n)=(n^2-n)/2$。同时，$\SO(n)$
  也是 $\Orth(n)$ 的闭子集，所以也是紧的。
\end{example}


\begin{problem}{}{}
  令 $\mathbb{H}=\mathbb{C}\times \mathbb{C}$(视为实向量空间)，定义
  双线性的乘法 $\mathbb{H}\times \mathbb{H}\to \mathbb{H}$ 为
  \[
    (a,b)(c,d)=\bigl(ac-b\bar d,ad+b\bar c\bigr),\quad a,b,c,d\in \mathbb{C}.  
  \]
  在这个乘法下，$\mathbb{H}$ 是 $\mathbb{R}$ 上的 $4$-维代数，
  被称为\emph{四元数代数}。对于每个 $p=(a,b)\in \mathbb{H}$，定义
  $p^*=\bigl(\bar a,-b\bigr)$。定义 $\mathbb{H}$ 的一组基为
  $(\mathbb{1},\mathbb{i},\mathbb{j},\mathbb{k})$ 为
  \[
    \mathbb{1}=(1,0),\mathbb{i}=(i,0),\mathbb{j}=(0,1),\mathbb{k}=(0,i)  ,
  \]
  那么可以验证它们满足    
  \begin{gather*}
    \mathbb{i}^2=\mathbb{j}^2=\mathbb{k}^2=-1,\quad
    \mathbb{1}q=q \mathbb{1}=q\ \forall q\in \mathbb{H},\\
    \mathbb{ij}=-\mathbb{ji}=\mathbb{k},\quad \mathbb{jk}=-\mathbb{kj}=\mathbb{i},
    \quad \mathbb{ki}=-\mathbb{ik}=\mathbb{j},\\ 
    \mathbb{1}^*=\mathbb{1},\quad \mathbb{i}^*=-\mathbb{i},\quad \mathbb{j}^*=-\mathbb{j},
    \quad \mathbb{k}^*=-\mathbb{k}.
  \end{gather*}
  如果 $p^*=p$，那么称 $p$ 为实四元数，如果 $p^*=-p$，那么称 $p$ 为纯虚四元数。
  实四元数可以通过对应 $x\leftrightarrow x\mathbb{1}$ 等同为实数。
  \begin{enumerate}
    \item 证明四元数乘法是结合的但不是交换的。
    \item 证明 $(pq)^*=q^*p^*$。
    \item 证明 $\langle p,q\rangle=\frac{1}{2}(p^*q+q^*p)$ 是 $\mathbb{H}$
    上的一个内积，其导出的范数满足 $|pq|=|p||q|$。
    \item 证明任意非零四元数都有乘法逆元 $p^{-1}=p^*/|p|^2$。
    \item 证明非零四元数集合 $\mathbb{H}^*$ 在四元数乘法下构成李群。
  \end{enumerate} 
\end{problem}
\begin{proof}
  (5) $\mathbb{H}^*$ 是乘法群。范数映射 $|\cdot|:\mathbb{H}\to \mathbb{R}$
  是连续映射，所以 $\mathbb{H}^*$ 作为 $\mathbb{R}\smallsetminus\{0\}$
  的原像是 $\mathbb{H}$ 的开子集，故 $\mathbb{H}^*$ 是开子流形，
  且容易验证 $\mathbb{H}^*$ 的乘法的求逆都是光滑映射，所以 
  $\mathbb{H}^*$ 是李群，维数为 $4$。
\end{proof}

\begin{problem}{}{}
  令 $\mathbb{H}^*$ 是非零四元数李群，$\mathcal{S}\subseteq \mathbb{H}^*$
  是单位四元数的集合，证明 $\mathcal{S}$ 是 $\mathbb{H}^*$ 的恰当嵌入李子群，
  并且同构于 $\SU(2)$。
\end{problem}
\begin{proof}
  记 $N:\mathbb{H}^*\to \mathbb{R}^*$ 为范数映射，显然这是一个李群同态，
  所以是常秩映射，所以 $\mathcal{S}=\ker N$ 是恰当嵌入李子群。
\end{proof}



\chapter{向量场}

\section{流形上的向量场}

设 $M$ 是带边或者无边光滑流形，$M$ 上的\emph{向量场}指的是映射 $\pi:TM\to M$
的一个截面。确切地说，一个向量场是连续映射 $X:M\to TM$，通常记为 $p\mapsto X_p$，
其满足
\[
  \pi\circ X=\Id_M.
\]
等价地说，对于每个 $p\in M$，有 $X_p\in T_pM$。

我们主要对光滑向量场感兴趣，即其作为 $M\to TM$ 的映射是光滑的，其中 $TM$
赋予 \autoref{prop:smooth structure of tangent bundle} 定义的光滑结构。
如果 $X$ 是 $M$ 上的向量场，$X$ 的支集被定义为集合 $\{p\in M\,|\, X_p\neq 0\}$
的闭包。如果 $X$ 的支集是紧集，那么我们说 $X$ 是\emph{紧支的}。

设 $M$ 是光滑 $n$-流形，如果 $X:M\to TM$ 是 $M$ 上的向量场，$(U,(x^i))$
是 $M$ 的一个光滑坐标卡，那么对于点 $p\in U$，我们可以将 $X_p$
表示为基向量的线性组合：
\begin{equation}\label{eq:value of vector field}
  X_p=X^i(p)\left.\frac{\partial}{\partial x^i}\right|_p.
\end{equation}
其中我们定义函数 $X^i:U\to \mathbb{R}$，被称为 $X$ 在给定坐标卡下的\emph{分量}。

\begin{proposition}[向量场的光滑性判别]
  令 $M$ 是带边或者无边光滑流形，$X:M\to TM$ 是向量场，如果 $(U,(x^i))$
  是 $M$ 的一个光滑坐标卡，那么 $X|_U$ 是光滑的当且仅当其在这个坐标卡下
  的每个分量函数是光滑的。
\end{proposition}
\begin{proof}
  若 $X|_U$ 是光滑映射，那么任取 $p\in U$，$X|_U:U\to TM$ 的坐标表示为
  \[
    \left(x^1,\dots,x^n\right)\mapsto \left(x^1,\dots,x^n,X^1(x),\dots,X^n(x)\right),
  \]
  所以 $X|_U$ 光滑等价于 $X^i$ 都是光滑函数。
\end{proof}

\begin{example}[坐标向量场]
  如果 $(U,(x^i))$ 是 $M$ 的一个光滑坐标卡，那么
  \[
    p\mapsto \left.\frac{\partial}{\partial x^i}\right|_p
  \]
  是 $U$ 上的一个向量场，被称为第 $i$ 个\emph{坐标向量场}，记为 $\partial/\partial x^i$。
  由于其分量是常数，所以这当然是一个光滑向量场。
\end{example}

如果 $U\subseteq M$ 是开集，那么我们知道 $T_pU$ 同构于 $T_pM$，这允许我们将
$TU$ 视为开子集 $\pi^{-1}(U)\subseteq TM$。因此，一个 $U$ 上的向量场可以被视为
$U\to TU$ 的映射也可以被视为 $U\to TM$ 的映射。如果 $X$ 是 $M$ 上的光滑向量场，
那么限制 $X|_U$ 是 $U$ 上的光滑向量场。

下面的引理是 \autoref{lemma:extension for smooth map} 的推广，其证明也是完全类似的。
如果 $M$ 是带边或者无边光滑流形，$A\subseteq M$ 是任意子集，一个\emph{沿 $A$ 的向量场}
指的是连续映射 $X:A\to TM$ 满足 $\pi\circ X=\Id_A$。如果对于每个 $p\in A$，
都存在 $M$ 中的邻域 $V$ 和 $V$ 上的光滑向量场 $\tilde X$，使得 $\tilde X$
在 $V\cap A$ 上和 $X$ 重合，那么我们说 $X$ 是\emph{沿 $A$ 的光滑向量场}。

\begin{lemma}[向量场的延拓引理]
  $M$ 是带边或者无边光滑流形，$A\subseteq M$ 是闭子集。假设 $X$ 是沿 $A$ 的向量场。给定
  包含 $A$ 的开集 $U$，存在 $M$ 上的全局光滑向量场 $\tilde X$ 使得 $\tilde X|_A=X$
  以及 $\supp \tilde X\subseteq U$。
\end{lemma}

作为一个重要的特例，这表明一个点上的任意切向量都可以延拓为整个光滑流形上的光滑向量场。

\begin{proposition}
  $M$ 是带边或者无边光滑流形，给定 $p\in M$ 和 $v\in T_pM$，存在 $M$ 上的光滑向量场 $X$
  使得 $X_p=v$。
\end{proposition}
\begin{proof}
  我们只需要说明向量场 $p\mapsto v$ 是光滑的。任取 $p$ 处的光滑坐标卡 $(U,\varphi)$，
  令 $U$ 上的向量场为常系数的向量场，此时便可以使用延拓引理。
\end{proof}
 
$M$ 是带边或者无边光滑流形，使用记号 $\mathfrak{X}(M)$ 来表示 $M$ 上的光滑向量场全体。
定义逐点的加法和数乘为：
\[
  (aX+bY)_p=aX_p+bY_p,
\]
这使得 $\mathfrak X(M)$ 成为一个向量空间。此外，光滑向量场还可以与光滑实值函数做乘法：
如果 $f\in C^\infty(M)$，我们定义 $fX:M\to TM$ 为
\[
  (fX)_p=f(p)X_p.
\]
下面的命题表明这些操作生成的确实都是光滑向量场。

\begin{proposition}
  $M$ 是带边或者无边光滑流形。
  \begin{enumerate}
    \item 如果 $X$ 和 $Y$ 是 $M$ 上的光滑向量场，$f,g\in C^\infty(M)$，那么
    $fX+gY$ 是光滑向量场。
    \item $\mathfrak X(M)$ 是光滑函数环 $C^\infty(M)$ 上的模。
  \end{enumerate}
\end{proposition}
\begin{proof}
  (1) $fX:X\to TM$ 在给定坐标卡下的分量函数 $(fX)^i:M\to \mathbb{R}$ 为：
  \[
    (fX)^i(p)=f(p)X^i(p),
  \]
  也就是说 $(fX)^i=fX^i$ 是光滑函数，所以 $fX$ 是光滑向量场。
\end{proof}

利用这种记号，向量场 $X$ 的基表达式 \eqref{eq:value of vector field} 也可以写为
向量场之间的等式而不是切向量的等式：
\[
  X=X^i\frac{\partial }{\partial x^i}.
\]
其中 $\partial/\partial x^i$ 是坐标向量场。

\subsection{局部和全局标架}

光滑坐标卡给出的坐标向量场提供了一种表示向量场的简洁方式，因为它们的值构成了切空间
的一组基。然而，这并不是唯一的选择。

假设 $M$ 是光滑 $n$-流形，定义在子集 $A\subseteq M$ 上的 $k$ 个向量场 $(X_1,\dots,X_k)$
被称为\emph{线性无关的}，如果对于每个 $p\in A$，$\left(X_1|_p,\dots,X_k|_p\right)$
在 $T_pM$ 中是线性无关的。如果对于每个 $p\in A$，切向量组 $\left(X_1|_p,\dots,X_k|_p\right)$
都张成 $T_pM$，那么我们说它们\emph{张成切丛}。如果开子集 $U\subseteq M$ 上的
$n$ 个向量场 $(E_1,\dots,E_n)$ 是线性无关的且张成切丛，那么我们说它们是
关于 $M$ 的\emph{局部标架}。此时对于每个 $p\in U$，切向量 $\left(E_1|_p,\dots,E_n|_p\right)$
都构成 $T_pM$ 的一组基。如果 $U=M$，那么它们被称为\emph{全局标架}。如果
$E_i$ 都是光滑向量场，那么被称为\emph{光滑标架}。我们使用缩写 $(E_i)$ 来表示
标架 $(E_1,\dots,E_n)$。如果 $M$ 是 $n$ 维的，那么检验 $n$ 元组
$(E_1,\dots,E_n)$ 是局部标架只需要说明线性无关或者张成切丛中的一个即可。

\begin{example}[局部和全局标架]\mbox{}
  \begin{enumerate}
    \item 标准坐标向量场构成了 $\mathbb{R}^n$ 的一个光滑全局标架。
    \item 如果 $(U,(x^i))$ 是光滑流形 $M$ 的光滑坐标卡，那么坐标向量场
    $\left(\partial/\partial x^i\right)$ 构成了一个光滑局部标架，被称为\emph{坐标标架}。
  \end{enumerate}
\end{example}

\subsection{向量场作为 $C^\infty(M)$ 的导子}

向量场的一个基本性质是它们在光滑实值函数空间上定义算子。
如果 $X\in \mathfrak X(M)$ 以及 $f$ 是定义在开子集 $U\subseteq M$ 上的光滑实值函数，
那么我们可以定义一个新的函数 $Xf:U\to \mathbb{R}$：
\[
  (Xf)(p)=X_pf.
\]
（注意区分 $fX$ 和 $Xf$ 的区别。）由于切向量对函数的作用只与函数在该点的任意小的邻域中的行为有关，所以
$Xf$ 也是由局部确定的。特别地，对于任意开子集 $V\subseteq U$，有
\[
  (Xf)|_V=X(f|_V).
\]

\begin{proposition}
  $M$ 是带边或者无边光滑流形，$X:M\to TM$ 是向量场，那么下面的说法等价：
  \begin{enumerate}
    \item $X$ 是光滑向量场。
    \item 对于每个 $f\in C^\infty(M)$，函数 $Xf$ 都是光滑函数。
    \item 对于每个开集 $U\subseteq M$ 和 $f\in C^\infty(U)$，函数 $Xf$ 在 $U$ 上是光滑的。
  \end{enumerate}
\end{proposition}
\begin{proof}
  $(1)\Rightarrow (2)$ 任取 $p\in M$ 以及 $p$ 处的光滑坐标卡 $(U,(x^i))$，那么 
  $Xf:M\to \mathbb{R}$ 的坐标表示为
  \[
    \left(x^1,\dots,x^n \right)\mapsto 
    X_x f=\left(X^i(x)\left.\frac{\partial}{\partial x^i}\right|_x\right)f=
    X^i(x)\frac{\partial f}{\partial x^i}(x),
  \]
  $X$ 光滑表明分量函数 $X^i$ 光滑，所以 $Xf$ 是光滑函数。

  $(2)\Rightarrow (3)$ 对于 $f\in C^\infty(U)$，任取 $p\in U$，令 $\psi$
  为关于 $p$ 的某个邻域的支在 $U$ 中的光滑鼓包函数，定义 $\tilde f=\psi f$。
  那么 $\tilde f\in C^\infty(M)$，根据假设 $X\tilde f$ 是光滑函数，
  并且 $X\tilde f$ 在 $p$ 的某个邻域上等于 $Xf$，这表明 $Xf$ 在 $p$ 的某个邻域上
  是光滑的，所以在 $U$ 上是光滑的。

  $(3)\Rightarrow (1)$ 设 $(U,(x^i))$ 是任意光滑坐标卡，那么
  \[
    Xx^i=\left(X^j\frac{\partial }{\partial x^j}\right)x^i
    =X^j\frac{\partial x^i}{\partial x^j}=X^i,
  \]
  根据假设，$Xx^i$ 是光滑的，所以 $X^i$ 是光滑的，这就表明 $X$ 的每个分量函数是光滑的，
  即 $X$ 是光滑向量场。
\end{proof}

上述命题的结果是一个光滑向量场 $X\in \mathfrak X(M)$ 定义了 $C^\infty(M)$
上的映射为 $f\mapsto Xf$，这显然是一个线性映射。此外，切向量的乘积法则导出了向量场的乘积法则：
\begin{equation}\label{eq:product rule of vector field}
  X(fg)=fXg+gXf.
\end{equation}
我们只需要逐点验证两端相等即可。一般来说，满足 $\mathbb{R}$-线性和
乘积法则 \eqref{eq:product rule of vector field} 式的映射 $X:C^\infty(M)\to C^\infty(M)$
被称为\emph{导子}。与切空间类似，下面的命题表明 $C^\infty(M)$ 的导子可以等同于光滑向量场。

\begin{proposition}\label{prop:derivation and vector field}
  $M$ 是带边或者无边光滑流形，映射 $D:C^\infty(M)\to C^\infty(M)$ 是导子当且仅当
  其形如 $Df=Xf$，其中 $X\in \mathfrak X(M)$。
\end{proposition}
\begin{proof}
  我们已经说明了向量场都是导子。反过来，假设 $D$ 是导子，我们要说明存在 $X\in \mathfrak X(M)$
  使得 $Df=Xf$。任取 $p\in M$，那么这样的向量场 $X$ 必须满足
  \[
    X_pf=(Df)(p),
  \]
  容易验证这样的 $X_p$ 确实是 $p$ 处的切向量。又因为任取 $f\in C^\infty(M)$，$Xf=Df$
  都是光滑的，所以 $X$ 确实是光滑向量场。
\end{proof}

出于这个结果，我们将 $M$ 上的光滑向量场和 $C^\infty(M)$ 的导子视为同一个对象，
使用同一个字母。

\section{向量场和光滑映射}

如果 $F:M\to N$ 是光滑映射，$X$ 是 $M$ 上的向量场，那么对于每个 $p\in M$，我们得到
一个切向量 $dF_p(X_p)\in T_{F(p)}N$，但是这并不能定义 $N$ 上的向量场。
例如，若 $F$ 不是满射，那么对于点 $q\in N \smallsetminus F(M)$，我们无法分配切向量。
若 $F$ 不是单射，那么 $N$ 中同一个点可能有多种不同的切向量定义方式。
所以我们研究下面的定义。

如果 $F:M\to N$ 是光滑映射，$X$ 是 $M$ 上的向量场，$Y$ 是 $N$ 上的向量场。
对于每个 $p\in M$，如果有 $dF_p(X_p)=Y_{F(p)}$，那么我们说 $X$ 和 $Y$
是\emph{$F$-相关的}。下面的命题说明了 $F$-相关的向量场如何作用在光滑函数上。

\begin{proposition}
  设 $F:M\to N$ 是光滑映射，$X\in \mathfrak X(M)$ 和 $Y\in \mathfrak X(N)$。
  那么 $X$ 和 $Y$ 是 $F$-相关的当且仅当对于每个定义在 $N$ 的某个开子集上的光滑
  实值函数 $f$，有
  \[
    X(f\circ F)=(Yf)\circ F.
  \]
\end{proposition}
\begin{proof}
  设 $f:U\to \mathbb{R}$ 是光滑函数，任取 $p\in U$，那么
  \[
    X(f\circ F)(p)=X_p(f\circ F)=dF_p(X_p)f,
  \]
  另一方面，有
  \[
    (Yf)\circ F(p)=Yf(F(p))=Y_{F(p)}f,
  \]
  所以 $X(f\circ F)=(Yf)\circ F$ 对于任意的 $f$ 成立当且仅当
  $dF_p(X_p)=Y_{F(p)}$，即 $X$ 和 $Y$ 是 $F$-相关的。
\end{proof}

需要注意的是对于一个光滑映射 $F:M\to N$ 和向量场 $X\in \mathfrak X(M)$，
可能出现 $N$ 上的任意向量场都不与 $X$ 是 $F$-相关的情况。然而， 
当微分同胚的时候，这样的向量场总是存在的。

\begin{proposition}
  设 $M,N$ 是带边或者无边光滑流形，$F:M\to N$ 是微分同胚。对于每个 $X\in \mathfrak X(M)$，
  都存在唯一的 $F$-相关于 $X$ 的 $N$ 上的光滑向量场。
\end{proposition}
\begin{proof}
  设向量场 $Y\in \mathfrak X(N)$ $F$-相关于 $X$，那么其必须满足 $dF_p(X_p)=Y_{F(p)}$。
  于是我们定义 $Y:N\to TN$ 为
  \[
    Y_q=dF_{F^{-1}(q)}\left(X_{F^{-1}(q)}\right).
  \]
  根据定义 $X$ 和 $Y$ 是 $F$-相关的。任取 $f\in C^\infty(N)$，那么
  \[
    Y_qf=dF_{F^{-1}(q)}\left(X_{F^{-1}(q)}\right)f=
    X_{F^{-1}(q)}(f\circ F)=\bigl(X(f\circ F)\bigr)(F^{-1}(q)),
  \]
  所以 $Yf=\bigl(X(f\circ F)\bigr)\circ F^{-1}$ 是光滑映射，
  这表明 $Y$ 是光滑向量场。
\end{proof}

在上述命题的情况下，我们将这个唯一的 $F$-相关于 $X$ 的向量场记为 $F_*X$，
称为\emph{$X$ 通过 $F$ 的推前}。需要注意只有 $F$ 是微分同胚的时候 $F_*X$
才有定义。上面的证明告诉我们，$F_*X$ 的定义为：
\begin{equation}
  (F_*X)_q=dF_{F^{-1}(q)}\left(X_{F^{-1}(q)}\right).
\end{equation}

\begin{example}[向量场推前的计算]
  令 $M,N$ 是 $\mathbb{R}^2$ 的开子流形：
  \begin{align*}
    M&=\{(x,y)\,|\, y>0,x+y>0\},\\
    N&=\{(u,v)\,|\, u>0,v>0\},
  \end{align*}
  定义 $F:M\to N$ 为 $F(x,y)=(x+y,x/y+1)$。那么 $F$ 是微分同胚，
  因为其有光滑逆映射 $F^{-1}(u,v)=(u-u/v,u/v)$。定义 $M$
  上的光滑向量场为：
  \[
    X_{(x,y)}=y^2\left.\frac{\partial}{\partial x}\right|_{(x,y)}  ,
  \]
  我们计算推前 $F_*X$。$F$ 在 $(x,y)$ 处的 Jacobi 矩阵为
  \[
    DF(x,y)=\begin{pmatrix}
      1 & 1 \\ 
      1/y & -x/y^2
    \end{pmatrix} ,
  \]
  所以
  \[
    dF_{(x,y)}(a,b)=\left(a+b,a/y-bx/y^2\right),  
  \]
  所以
  \[
    dF_{F^{-1}(u,v)}\left(X_{F^{-1}(u,v)}\right)=  
    dF_{F^{-1}(u,v)}(u^2/v^2,0)=
    \left(u^2/v^2,u/v\right),
  \]
  所以
  \[
    (F_*X)_{(u,v)}=\frac{u^2}{v^2}\left.\frac{\partial}{\partial u}\right|_{(u,v )}  
    +\frac{u}{v}\left.\frac{\partial}{\partial v}\right|_{(u,v)} .
  \]
\end{example}

\section{李括号}

令 $X,Y$ 是光滑流形 $M$ 上的两个光滑向量场。给定光滑函数 $f:M\to \mathbb{R}$，
我们可以将 $X$ 作用在 $f$ 上得到另一个光滑函数 $Xf$。进一步的，我们可以
将向量场 $Y$ 作用在这个函数上得到光滑函数 $YXf=Y(Xf)$。然而，算子 $f\mapsto YXf$
并不满足乘积法则，所以这样得到的 $YX$ 并不是 $C^\infty(M)$ 的导子。

我们可以以相反的顺序进行上述操作，得到函数 $XYf$，将这两个算子相减，
我们得到算子 $[X,Y]:C^\infty(M)\to C^\infty(M)$，被称为
\emph{$X$ 和 $Y$ 的李括号}，定义为
\[
  [X,Y]f=XYf-YXf.  
\]
一个关键的事实是这个算子是一个向量场。

\begin{lemma}
  两个光滑向量场的李括号是一个光滑向量场。
\end{lemma}
\begin{proof}
  \allowdisplaybreaks
  根据 \autoref{prop:derivation and vector field}，我们只需要说明
  $[X,Y]$ 是一个导子。任取 $f,g\in C^\infty(M)$，有
  \begin{align*}
    [X,Y](fg)&=X\bigl(Y(fg)\bigr)-Y\bigl(X(fg)\bigr)\\
    &=X\bigl(fYg+gYf\bigr)-Y\bigl(fXg+gXf\bigr)\\
    &=X(fYg)+X(gYf)-Y(fXg)-Y(gXf)\\
    &=fXYg+(Yg)(Xf)+gXYf+(Yf)(Xg)\\
    &\mathrel{-}fYXg-(Xg)(Yf)-gYXf-(Xf)(Yg)\\
    &=fXYg+gXYf-fYXg-gYXf\\
    &=f[X,Y]g+g[X,Y]f.\qedhere
  \end{align*}
\end{proof}

向量场 $[X,Y]$ 在点 $p\in M$ 处的值是 $p$ 处的导子，其满足
\[
  [X,Y]_pf=X_p(Yf)-Y_p(Xf).  
\]
然而，这个公式对于计算的用处有限，因为其需要计算涉及 $f$ 的二阶导数
的项，这些项里面总会相互抵消一部分，下一个命题给出了更有用的坐标公式。

\begin{proposition}[李括号的坐标公式]\label{prop:coordinate formula for lie bracket}
  令 $X,Y$ 是光滑流形 $M$ 上的光滑向量场，设 $X=X^i\partial/\partial x^i$
  和 $Y=Y^j\partial /\partial x^j$ 是 $X,Y$ 在同一组光滑坐标卡
  $(x^i)$ 下的分量表示。那么 $[X,Y]$ 可以表示为
  \[
    [X,Y]=\left(X^i\frac{\partial Y^j}{\partial x^i}-Y^i\frac{\partial X^j}{\partial x^i}\right)
    \frac{\partial}{\partial x^j},  
  \]
  或者更简洁地写为
  \[
    [X,Y]=\left(XY^j-YX^j\right)  \frac{\partial}{\partial x^j}.
  \]
\end{proposition}
\begin{proof}
  由于 $([X,Y]f)|_U=[X,Y](f|_U)$，所以我们只需要在某个坐标卡中
  计算即可。我们有
  \begin{align*}
    [X,Y]f&=X^i\frac{\partial (Yf)}{\partial x^i}-Y^j\frac{\partial (Xf)}{\partial x^j}\\
    &=X^i\frac{\partial}{\partial x^i}\left(Y^j\frac{\partial f}{\partial x^j}\right)
    -Y^j\frac{\partial}{\partial x^j}\left(X^i\frac{\partial f}{\partial x^i}\right)\\
    &=X^iY^j\frac{\partial^2f}{\partial x^i\partial x^j}
    +X^i\frac{\partial f}{\partial x^j}\frac{\partial Y^j}{\partial x^i}
    -Y^jX^i\frac{\partial^2 f}{\partial x^j\partial x^i}
    -Y^j\frac{\partial f}{\partial x^i}\frac{\partial X^i}{\partial x^j}\\
    &=X^i\frac{\partial Y^j}{\partial x^i}\frac{\partial f}{\partial x^j}-
    Y^j\frac{\partial X^i}{\partial x^j}\frac{\partial f}{\partial x^i},
  \end{align*}
  最后一步使用了光滑函数的高阶偏导数与次序无关。
\end{proof}

\autoref{prop:coordinate formula for lie bracket} 的一个直接应用是
对于坐标向量场而言，任取 $i,j$，都有
\[
  \left[\frac{\partial}{\partial x^i},\frac{\partial}{\partial x^j}\right]  
  =0,
\]
这是因为其坐标函数都是常值函数。

\begin{example}
  定义光滑向量场 $X,Y\in \mathfrak{X}(\mathbb{R}^3)$ 为
  \[
    X=x\frac{\partial}{\partial x}+\frac{\partial}{\partial y}
    +x(y+1)\frac{\partial }{\partial z},
    \quad 
    Y=\frac{\partial}{\partial x}+y\frac{\partial }{\partial z}.   
  \]
  那么它们的李括号为
  \begin{align*}
    [X,Y]&= \left(XY^1-YX^1\right)\frac{\partial}{\partial x}
    +\left(XY^2-YX^2\right)\frac{\partial}{\partial y}
    +\left(XY^3-YX^3\right)\frac{\partial}{\partial z}\\
    &=-\frac{\partial}{\partial x}-y\frac{\partial}{\partial z}.
  \end{align*}
\end{example}

\begin{proposition}[李括号的性质]
  对于任意 $X,Y,Z\in \mathfrak{X}(M)$，李括号满足：
  \begin{enumerate}
    \item 双线性性：对于 $a,b\in \mathbb{R}$，有
    \begin{align*}
      [aX+bY,Z]&=a[X,Z]+b[Y,Z],\\
      [Z,aX+bY]&=a[Z,X]+b[Z,Y].
    \end{align*}
    \item 反对称性：
    \begin{align*}
      [X,Y]=-[Y,X].
    \end{align*}
    \item Jacobi 恒等式：
    \begin{align*}
      [X,[Y,Z]]+[Y,[Z,X]]+[Z,[X,Y]]=0.
    \end{align*}
    \item 对于 $f,g\in C^\infty(M)$，有
    \begin{align*}
      [fX,gY]=fg[X,Y]+(fXg)Y-(gYf)X.
    \end{align*}
  \end{enumerate}
\end{proposition}


\begin{proposition}[李括号的自然属性]
  令 $F:M\to N$ 是光滑映射，向量场 $X_1,X_2\in \mathfrak{X}(M)$
  和 $Y_1,Y_2\in \mathfrak{X}(N)$，其中 $X_i,Y_i$ 是 $F$-相关的。
  那么 $[X_1,X_2]$ 和 $[Y_1,Y_2]$ 是 $F$-相关的。
\end{proposition}
\begin{proof}
  $X_i,Y_i$ 是 $F$-相关的表明对于任意的 $f\in C^\infty(N)$ 有
  \[
    X_i(f\circ F)=Y_if\circ F,  
  \] 
  所以
  \begin{align*}
    [X_1,X_2](f\circ F)&=X_1X_2(f\circ F)-X_2X_1(f\circ F)\\
    &=X_1(Y_2f\circ F)-X_2(Y_1f\circ F)\\
    &=(Y_1Y_2f)\circ F-(Y_2Y_1f)\circ F \\
    &=\bigl([Y_1,Y_2]f\bigr)\circ F,
  \end{align*}
  这就表明 $[X_1,X_2]$ 和 $[Y_1,Y_2]$ 是 $F$-相关的。
\end{proof}

\begin{corollary}[李括号的推前]
  设 $F:M\to N$ 是微分同胚，$X_1,X_2\in \mathfrak{X}(M)$，那么
  $F_*[X_1,X_2]=[F_*X_1,F_*X_2]$。
\end{corollary}
\begin{proof}
  由于 $X_i$ 和 $F_*X_i$ 是 $F$-相关的，所以
  $[X_1,X_2]$ 和 $[F_*X_1,F_*X_2]$ 是 $F$-相关的，根据
  唯一性，就有 $[F_*X_1,F_*X_2]=F_*[X_1,X_2]$。
\end{proof}

\section{李群的李代数}

假设 $G$ 是李群，$G$ 上的向量场 $X$ 如果在任意左平移下保持不变，那么我们说
$X$ 是\emph{左不变}的。确切地说，对于任意 $g\in G$，$X$ 与自身是
$L_g$-相关的，即
\[
  \forall g,g'\in G,\quad X_{gg'}=d(L_g)_{g'}(X_{g'}).  
\]
由于 $L_g$ 是微分同胚，所以可以表述为任取 $g\in G$ 都有
$(L_g)_*X=X$。

由于 $(L_g)_*(aX+bY)=a(L_g)_*X+b(L_g)_*Y$，所以 $G$ 上所有左不变的光滑向量场
构成 $\mathfrak{X}(G)$ 的一个子空间。更重要的是，这个子空间对于李括号是封闭的。

\begin{proposition}
  $G$ 是李群，设 $X,Y$ 是 $G$ 上的光滑左不变向量场，那么 $[X,Y]$
  也是左不变的。
\end{proposition}
\begin{proof}
  任取 $g\in G$，由于 $(L_g)_*X=X$ 以及 $(L_g)_*Y=Y$，所以 
  \[
    (L_g)_*[X,Y]=[(L_g)_*X,(L_g)_*Y]=[X,Y].\qedhere
  \]
\end{proof}

($\mathbb{R}$ 上的)\emph{李代数}指的是一个实向量空间 $\mathfrak{g}$，
其配备一个 $\mathfrak{g}\times \mathfrak{g}\to \mathfrak{g}$ 的\emph{李括号}，
通常记为 $(X,Y)\mapsto [X,Y]$，其对于任意 $X,Y,Z\in \mathfrak{g}$，满足
下面的性质：
\begin{enumerate}
  \item 双线性性：对于 $a,b\in \mathbb{R}$，有
  \begin{align*}
    [aX+bY,Z]&=a[X,Z]+b[Y,Z],\\
    [Z,aX+bY]&=a[Z,X]+b[Z,Y].
  \end{align*}
  \item 反对称性：
  \begin{align*}
    [X,Y]=-[Y,X].
  \end{align*}
  \item Jacobi 恒等式：
  \begin{align*}
    [X,[Y,Z]]+[Y,[Z,X]]+[Z,[X,Y]]=0.
  \end{align*}
\end{enumerate}
如果 $\mathfrak{g}$ 是李代数，子空间 $\mathfrak{h}\subseteq \mathfrak{g}$
对李括号封闭，那么 $\mathfrak{h}$ 被称为\emph{$\mathfrak{g}$ 的李子代数}。
在这种情况下，$\mathfrak{h}$ 的李括号就是 $\mathfrak{g}$ 的李括号的限制。

如果 $\mathfrak{g}$ 和 $\mathfrak{h}$ 是两个李代数，线性映射
$A:\mathfrak{g}\to \mathfrak{h}$ 保持李括号：$A[X,Y]=[AX,AY]$，
那么我们说 $A$ 是\emph{李代数同态}。如果 $A$ 是同构，那么我们说
$A$ 是\emph{李代数同构}。

\begin{example}[李代数]\label{exa:lie algebra}
  \mbox{}
  \begin{enumerate}
    \item 光滑流形 $M$ 上的所有光滑向量场 $\mathfrak{X}(M)$
    在李括号下成为李代数。
    \item 如果 $G$ 是李群，那么 $G$ 上所有光滑左不变向量场的集合
    是 $\mathfrak{X}(G)$ 的李子代数。
    \item 向量空间 $M(n,\mathbb{R})$ 在李括号(被称为\emph{换位子括号})
    \[
      [A,B]=AB-BA  
    \]
    下成为 $n^2$-维李代数。当我们将 $M(n,\mathbb{R})$ 视为李代数
    的时候，我们使用 $\mathfrak{gl}(n,\mathbb{R})$ 表示。
  \end{enumerate}
\end{example}

\ref{exa:lie algebra} 的 (2) 是最重要的例子，李群 $G$ 上所有光滑左不变向量场的集合
被称为\emph{$G$ 的李代数}，记为 $\Lie(G)$。一个基本事实是 $\Lie(G)$
是有限维的，并且维数与 $G$ 相同。

\begin{theorem}\label{thm:dim of lie algebra}
  $G$ 是李群，定义求值映射 $\varepsilon:\Lie(G)\to T_eG$ 为
  $\varepsilon(X)=X_e$，那么 $\varepsilon$ 是向量空间同构。
  这表明 $\Lie(G)$ 是维数为 $\dim G$ 的有限维向量空间。
\end{theorem}
\begin{proof}
  不难验证 $\varepsilon$ 是线性映射。令 $\varepsilon(X)=X_e=0$，
  那么任取 $g\in G$，$X$ 左不变表明
  \[
    X_g=d(L_g)_e(X_e)=0,
  \]
  所以 $X=0$，这表明 $\varepsilon$ 是单射。

  任取 $v\in T_eG$，我们要构造一个光滑左不变向量场 $X$ 使得 $X_e=v$。
  这样的 $X$ 必须满足 
  \[
    X_g=d(L_g)_e(X_e)=d(L_g)_e(v),  
  \]
  所以我们定义 $G$ 上的向量场 $v^{\mathrm{L}}$ 为
  \[
    v^{\mathrm{L}}\big|_g=d(L_g)_e(v).
  \]
  我们首先说明 $v^{\mathrm{L}}$ 是光滑的。任取 $f\in C^\infty(G)$，选取
  光滑曲线 $\gamma:(-\delta,\delta)\to G$ 满足 $\gamma(0)=e$ 以及
  $\gamma'(0)=v$，那么
  \[
    v^{\mathrm{L}}\big|_gf=d(L_g)_e\circ d\gamma_0\left(\left.\frac{d}{dt}\right|_0\right)f
    =\left.\frac{d}{dt}\right|_{t=0}(f\circ L_g\circ\gamma)(t),
  \]
  定义 $\varphi:(-\delta,\delta)\times G\to \mathbb{R}$ 为
  $\varphi(t,g)=f(L_g(\gamma(t)))$ 是光滑函数
  \[
    (-\delta,\delta)\times G\to G\times G\xrightarrow{m} G\xrightarrow{f} \mathbb{R}
  \]
  的复合，所以是光滑函数，
  所以 $\bigl(v^{\mathrm{L}}f\bigr)(g)=v^{\mathrm{L}}\big|_gf=\partial\varphi/\partial t(0,g)$ 
  是光滑函数，这就表明 $v^{\mathrm{L}}$ 是光滑向量场。

  现在说明 $v^{\mathrm{L}}$ 是左不变向量场，对于任意 $h\in G$，有
  \[
      d(L_h)_{g}\left(v^{\mathrm{L}}\big|_g\right)
      =d(L_h)_g\circ d(L_g)_e(v)=d(L_{hg})_e(v)=
      v^{\mathrm{L}}\big|_{hg},
  \]
  这就表明 $v^{\mathrm{L}}$ 是左不变的。所以 $v=\varepsilon(v^{\mathrm{L}})$，
  故 $\varepsilon$ 是满射。
\end{proof}

根据上面的证明，我们还可以发现 $G$ 上任意左不变向量场都自动是
光滑向量场。

\begin{corollary}
  李群上的任意左不变向量场都是光滑向量场。
\end{corollary}
\begin{proof}
  设 $X$ 是左不变向量场，那么
  \[
    X_g=d(L_g)(X_e)=(X_e)^{\mathrm{L}}\big|_g,
  \]
  所以 $X=(X_e)^{\mathrm{L}}$ 是光滑向量场。
\end{proof}

全局左不变向量场的存在性也导出了李群的另一个重要性质。回顾，
如果光滑流形有一个光滑的全局标架，那么我们说这个流形是\emph{可平行化的}。
如果 $G$ 是李群，左不变向量场构成的局部或者全局的标架被称为\emph{左不变标架}。

\begin{corollary}
  每个李群都有一组左不变的光滑全局标架，因此每个李群都是可平行化的。
\end{corollary}
\begin{proof}
  若 $G$ 的李群，那么 $\Lie(G)$ 的一组基就是左不变的光滑全局标架。
\end{proof}

下面我们通过分析 $\GL(n,\mathbb{R})$ 的李代数来结束本节。
我们已经知道了 $\Lie(\GL(n,\mathbb{R}))$ 和 $T_{I_n}\GL(n,\mathbb{R})$
之间存在向量空间同构。由于 $\GL(n,\mathbb{R})$ 是 $\mathfrak{gl}(n,\mathbb{R})$
的开子集，所以 $T_{I_n}\GL(n,\mathbb{R})$ 和 $\mathfrak{gl}(n,\mathbb{R})$
之间也存在向量空间同构，那么我们得到了向量空间同构
$\Lie(\GL(n,\mathbb{R}))\simeq \mathfrak{gl}(n,\mathbb{R})$.
而这两个向量空间我们都已经配备了独立的李代数结构，第一个是
向量场的李括号，第二个是矩阵的交换子括号。
下面我们证明上述向量空间同构实际上是李代数同构。

\begin{proposition}[一般线性群的李代数]
  复合映射
  \[
    \Lie(\GL(n,\mathbb{R}))\to T_{I_n}\GL(n,\mathbb{R})
    \to \mathfrak{gl}(n,\mathbb{R})  
  \]
  给出了 $\Lie(\GL(n,\mathbb{R}))$ 到 $\mathfrak{gl}(n,\mathbb{R})$
  的李代数同构。
\end{proposition}
\begin{proof}
  
\end{proof}

\subsection{诱导的李代数同态}

\begin{theorem}[李群同态诱导李代数同态]
  令 $G,H$ 是李群，$\mathfrak{g},\mathfrak{h}$ 是对应的李代数。
  设 $F:G\to H$ 是李群同态。对于每个 $X\in \mathfrak{g}$，存在
  唯一的与 $X$ $F$-相关的 $\mathfrak{h}$ 中的向量场，记为
  $F_*X$，映射 $F_*:\mathfrak{g}\to \mathfrak{h}$ 是李代数同态。
\end{theorem}
\begin{proof}
  如果 $Y$ 与 $X$ 是 $F$-相关的，那么其必须满足
  $Y_e=dF_e(X_e)$，$Y\in \mathfrak{h}$ 则必须满足
  \[
    Y=  \bigl(dF_e(X_e)\bigr)^{\mathrm{L}}.
  \]
  下面我们只需要说明这样的 $Y$ 与 $X$ 是 $F$-相关的即可。
  任取 $g\in G$，有
  \[
    Y_{F(g)}=d\bigl(L_{F(g)}\bigr)_{e}\bigl(dF_e(X_e)\bigr)=d\bigl(L_{F(g)}\circ F\bigr)_e
    (X_e),
  \]
  $F$ 是李群同态表明 $L_{F(g)}\circ F=F\circ L_g$，所以
  \[
    Y_{F(g)}=d\bigl(F\circ L_g\bigr)_e(X_e)=dF_g\bigl(d(L_g)_e(X_e )\bigr)
    =dF_g\bigl(X_g\bigr),
  \]
  这就表明 $X$ 和 $Y$ 是 $F$-相关的向量场。

  任取两个左不变向量场 $X,Y\in \mathfrak{g}$，由于 $X,Y$ 分别和 $F_*X,F_*Y$ 
  是 $F$-相关的，根据李括号的自然属性，所以 $[X,Y]$ 和 $[F_*X,F_*Y]$
  是 $F$-相关的，所以 $F_*[X,Y]=[F_*X,F_*Y]$，即 $F_*$ 是李代数同态。
\end{proof}

需要注意的是，上述定理表明对于任意左不变向量场 $X\in \mathfrak{g}$，
即使 $F$ 不是微分同胚，也可以将 $X$ 推前到一个 $F$-相关的左不变向量场
$F_*X$。

\subsection{李子群的李代数}

如果 $G$ 是李群，$H\subseteq G$ 是李子群，我们希望 $H$
的李代数可以视为 $G$ 的李代数的李子代数。但是，$\Lie(H)$
的元素严格来说是 $H$ 上的向量场而不是 $G$ 上的向量场。
下面的命题给我们一种将 $\Lie(H)$ 视为 $\Lie(G)$ 的李子代数的方式。

\begin{theorem}[李子群的李代数]
  设 $H\subseteq G$ 是李子群，$\iota:H\hookrightarrow G$ 是包含映射。
  那么存在李子代数 $\mathfrak{h}\subseteq\Lie(G)$，其典范同构于
  $\Lie(H)$，并且可以刻画为
  \[
    \mathfrak{h}=\iota_*(\Lie(H))=\{X\in \Lie(G)\,|\, X_e\in T_eH\}.  
  \]
\end{theorem}
\begin{proof}
  我们有如下交换图
  \[
    \begin{tikzcd}
      \Lie(H)\arrow[r,"\iota_*"]\arrow[d,"\simeq"] & \Lie(G)\arrow[d,"\simeq"]\\
      T_eH\arrow[r,"d\iota_e"] & T_eG
    \end{tikzcd}  
  \]
  所以 $\iota_*$ 是单射，故 $\iota_*(\Lie(H))$ 典范同构于
  $\Lie(H)$。另一方面，$\iota_*(\Lie(H))$ 同构于 $d\iota_e(T_eH)$，
  即 $\iota_*(\Lie(H))$ 由所有满足 $X_e\in T_eH$ 的 $X\in\Lie(G)$ 构成。
\end{proof}

\begin{example}[$\Orth(n)$ 的李代数]
  \autoref{exa:orthogonal group} 表明正交群 $\Orth(n)$ 是常秩映射
  $\varPhi:\GL(n,\mathbb{R})\to M(n,\mathbb{R})$ 的水平集，再根据
  \autoref{exer:tangent space of submanifold}，切空间
  $T_{I_n}\Orth(n)=\ker d\varPhi_{I_n}$，由于
  $d\varPhi_{I_n}(B)=B+B^T$，所以
  \[
    T_{I_n}\Orth(n)=\{B\in \mathfrak{gl}(n,\mathbb{R})\,|\, B+B^T=0\},  
  \]
  于是 $\Lie(\Orth(n))\simeq T_{I_n}\Orth(n)$ 典范同构于所有反对称矩阵构成的
  $\mathfrak{gl}(n,\mathbb{R})$ 的子代数 $\mathfrak{o}(n)$。注意，我们甚至
  没有验证 $\mathfrak{o}(n)$ 是一个李代数。
\end{example}

\chapter{积分曲线和流}

\section{积分曲线}

设 $M$ 是光滑流形，$\gamma:J\to M$ 是光滑曲线，那么
对于 $t\in J$，速度向量 $\gamma'(t)\in T_{\gamma(t)}M$。
本节我们研究逆向的方法：给定每个点的切向量，寻找一条曲线
使得其在每个点的速度向量等于给定的切向量。

如果 $V$ 是 $M$ 上的向量场，定义\emph{$V$ 的积分曲线}为
可微曲线 $\gamma:J\to M$，其在每个点处的速度等于 $V$ 在该点处的值：
\[
  \gamma'(t)=V_{\gamma(t)}\quad \forall t\in J.  
\]
如果 $0\in J$，点 $\gamma(0)$ 被称为\emph{$\gamma$ 的起点}。

寻找积分曲线可以归结为求解光滑坐标卡中的常微分方程组。设
$V$ 是一个光滑向量场，$\gamma:J\to M$ 是光滑曲线。在一个光滑坐标
开集 $U\subseteq M$ 中，我们可以将 $\gamma$ 表示为
$\gamma(t)=\bigl(\gamma^1(t),\dots,\gamma^n(t)\bigr)$。那么
$\gamma'(t)=V_{\gamma(t)}$ 当且仅当
\[
  \dot\gamma^i(t)\left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)}  
  =V^i(\gamma(t))\left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)} ,
\] 
这导出了一个常微分方程组：
\begin{align*}
  \dot\gamma^1(t)
  &=V^1(\gamma^1(t),\dots,\gamma^n(t)) ,\\
  &\vdots \\
  \dot\gamma^n(t)
  &=V^n(\gamma^1(t),\dots,\gamma^n(t)).
\end{align*}

\begin{proposition}
  令 $V$ 是光滑流形 $M$ 上的光滑向量场。对于每个 $p\in M$，都存在
  $\varepsilon>0$ 和光滑曲线 $\gamma:(-\varepsilon,\varepsilon)\to M$
  使得 $\gamma$ 是 $V$ 的起点为 $p$ 的积分曲线。
\end{proposition}

\begin{lemma}[缩放引理]
  令 $V$ 是光滑流形 $M$ 上的光滑向量场。$J\subseteq \mathbb{R}$
  是区间，$\gamma:J\to M$ 是 $V$ 的积分曲线。对于任意 $a\in \mathbb{R}$，
  定义曲线 $\tilde \gamma:\tilde{J}\to M$ 为 $\tilde{\gamma}(t)=\gamma(at)$，
  其中 $\tilde{J}=\{t\,|\, at\in J\}$，那么 $\tilde{\gamma}$ 是向量场
  $aV$ 的积分曲线。
\end{lemma}
\begin{proof}
  任取 $f\in C^\infty(M)$，有
  \begin{align*}
    \tilde{\gamma}'(t_0)f&=d\tilde{\gamma}_{t_0}\left(
      \left.\frac{d}{dt}\right|_{t_0}
    \right)f
    =\left.\frac{d}{dt}\right|_{t_0}(f\circ\tilde\gamma)(t)
    =\left.\frac{d}{dt}\right|_{t_0}(f\circ\gamma)(at)\\
    &=a (f\circ\gamma)'(at_0)
    =a\gamma'(at_0)f=aV_{\gamma(at_0)}f=
    aV_{\tilde{\gamma}(t_0)}f,
  \end{align*}
  所以 $\tilde{\gamma}'(t_0)=aV_{\tilde{\gamma}(t_0)}$。
\end{proof}

\begin{lemma}[平移引理]
  令 $V,M,J$ 和 $\gamma$ 的含义同上一个引理。对于任意
  $b\in \mathbb{R}$，定义曲线 $\hat\gamma:\hat J\to M$
  为 $\hat \gamma(t)=\gamma(t+b)$，其中
  $\hat J=\{t\,|\, t+b\in J\}$，那么 $\hat J$ 是向量场
  $V$ 的积分曲线。
\end{lemma}

\begin{proposition}[积分曲线的自然性]\label{prop:naturality of integral curve}
  设 $M,N$ 是光滑流形，$F:M\to N$ 是光滑映射。那么 $X\in \mathfrak{X}(M)$
  和 $Y\in \mathfrak{X}(N)$ 是 $F$-相关的当且仅当 $F$ 将 $X$ 的积分曲线
  送到 $Y$ 的积分曲线，也就是说，对于 $X$ 的积分曲线 $\gamma$，
  $F\circ\gamma$ 是 $Y$ 的积分曲线。
\end{proposition}
\begin{proof}
  假设 $X,Y$ 是 $F$-相关的，这意味着对于任意 $p\in M$，有
  \[
    Y_{F(p)}=dF_p(X_p),
  \]
  于是
  \[
    (F\circ\gamma)'(t)
    =dF_{\gamma(t)}\bigl(\gamma'(t)\bigr)
    =dF_{\gamma(t)}(V_{\gamma(t)})=Y_{F(\gamma(t))}
    =Y_{(F\circ\gamma)(t)},
  \]
  这就说明 $F\circ\gamma$ 是 $Y$ 的积分曲线。

  反之，若对于任意 $X$ 的积分曲线 $\gamma$，$F\circ\gamma$ 都是
  $Y$ 的积分曲线。那么任取 $p\in M$，选取 $X$ 的以 $p$ 为起点
  的积分曲线 $\gamma$，有
  \[
    Y_{F(p)}=Y_{F(\gamma(0))}=(F\circ\gamma)'(0)
    =dF_{\gamma(0)}(\gamma'(0))=dF_p(X_p),  
  \]
  即 $X,Y$ 是 $F$-相关的。
\end{proof}

\section{流}

令 $M$ 是光滑流形，$V\in \mathfrak{X}(M)$。假设对于每个点 $p\in M$，
$V$ 有唯一的一条定义在 $t\in \mathbb{R}$ 上的以 $p$ 为起点的积分曲线，
记为 $\theta^{(p)}:\mathbb{R}\to M$。那么对于每个 $t\in \mathbb{R}$，我们可以
定义映射 $\theta_t:M\to M$，将点 $p$ 送到以 $p$ 为起点的积分曲线
在 $t$ 时刻的值：
\[
  \theta_t(p)=\theta^{(p)}(t).  
\]
那么每个 $\theta_t$ 看起来就像将流形沿着 $t$ 时刻的积分曲线进行“滑动”。
平移引理表明 $t\mapsto \theta^{(p)}(t+s)$ 是 $V$ 的以 $q=\theta^{(p)}(s)$
为起点的积分曲线，因为我们假设了积分曲线的唯一性，所以
$\theta^{(q)}(t)=\theta^{(p)}(t+s)$，也就是
\[
  \theta_t\circ\theta_s(p)=\theta_t(q)=\theta_{t+s}(p).
\]
结合 $\theta_0(p)=\theta^{(p)}(0)=p$，这导出了一个加法群 $\mathbb{R}$
在 $M$ 上的群作用 $\theta:\mathbb{R}\times M\to M$。

出于这个动机，我们定义 $M$ 上的\emph{全局流}为一个 $M$
上的连续左 $\mathbb{R}$-作用，即一个连续映射 $\theta:\mathbb{R}\times M\to M$
满足对于任意 $s,t\in \mathbb{R}$ 和 $p\in M$ 有
\begin{equation}
  \theta\bigl(t,\theta(s,p)\bigr)=\theta(t+s,p),\quad
  \theta(0,p)=p.
\end{equation}

下面的命题表明，每个光滑的全局流都是按照我们上面所述的方式
从某个光滑向量场的积分曲线导出的。如果 $\theta:\mathbb{R}\times M\to M$
是光滑的全局流，对于每个 $p\in M$，我们定义切向量 $V_p\in T_pM$ 为
\[
  V_p=\smash{\theta^{(p)}}'(0),
\]
那么 $p\mapsto V_p$ 是 $M$ 上的一个向量场，被称为\emph{$\theta$ 的无穷小生成元}。

\begin{proposition}
  令 $\theta:\mathbb{R}\times M\to M$ 是光滑的全局流，那么
  $\theta$ 的无穷小生成元 $V$ 是 $M$ 上的光滑向量场，并且每个
  曲线 $\theta^{(p)}$ 都是 $V$ 的积分曲线。
\end{proposition}
\begin{proof}
  任取 $f\in C^\infty(M)$ 和 $p\in M$，有
  \[
    Vf(p)=V_pf=  \smash{\theta^{(p)}}'(0)f=
    \left.\frac{d}{dt}\right|_{t=0}f\bigl(\theta^{(p)}(0)\bigr)
    =\frac{\partial (f\circ\theta)}{\partial t}(0,p),
  \]
  由于 $f\circ\theta$ 是光滑函数，所以 $Vf$ 也是光滑函数，故
  $V$ 是光滑向量场。

  下面证明 $\theta^{(p)}$ 是 $V$ 的积分曲线。记 $q=\theta^{(p)}(t)$，那么
  \[
    V_{\theta^{(p)}(t)}f=\smash{\theta^{(q)}}'(0)f
    =\left.\frac{d}{ds}\right|_{s=0}f(\theta(s,q))
    =\left.\frac{d}{ds}\right|_{s=0}f(\theta(s+t,p))
    =\smash{\theta^{(p)}}'(t)f,
  \]
  即 $\smash{\theta^{(p)}}'(t)=V_{\theta^{(p)}(t)}$。
\end{proof}

\subsection{流的基本定理}

我们已经说明了每个光滑的全局流都会产生一个光滑的向量场，即无穷小生成元。反之，
我们希望能说明每个光滑向量场都是某个光滑全局流的无穷小生成元。然而，很容易看出
这是不成立的，因为存在光滑向量场使得其积分曲线不可能对所有的 $t\in \mathbb{R}$
都有定义。

\begin{example}
  令 $M=\mathbb{R}^2 \smallsetminus\{0\}$ 附带标准坐标 $(x,y)$，$V=\partial/\partial x$ 是 $M$
  上的向量场。$V$ 的唯一的以 $(-1,0)$ 为起点的积分曲线为 $\gamma(t)=(t-1,0)$。
  但是此时 $\gamma$ 不能被连续地延拓为一条经过 $t=1$ 的积分曲线，这直观上是明显的，
  因为 $M$ 在原点处有个洞。为了证明这一点，假设 $\tilde\gamma$ 是 $\gamma$ 的连续延拓且
  经过 $t=1$，那么 $t\to 1_+$ 的时候有 $\gamma(t)\to\tilde{\gamma}(1)\in \mathbb{R}^2 \smallsetminus\{0\}$。
  同时我们可以将 $\gamma$ 视为值域在 $\mathbb{R}^2$ 中的曲线，于是 $t\to 1_+$ 时有 $\gamma(t)\to (0,0)$，
  出于极限的唯一性，必须有 $\tilde{\gamma}(1)=(0,0)\in \mathbb{R}^2 \smallsetminus\{0\}$，
  这是矛盾的。
\end{example}

出于上述原因，我们给出下面的定义。如果 $M$ 是流形，定义 $M$ 的\emph{流域}指的是一个开集
$\mathcal{D}\subseteq \mathbb{R}\times M$，其满足任取 $p\in M$，集合
$\mathcal{D}^{(p)}=\{t\in \mathbb{R}\,|\, (t,p)\in \mathcal{D}\}$ 是
包含 $0$ 的一个开区间。定义 $M$ 上的\emph{流}为一个连续映射 $\theta:\mathcal{D}\to M$，
其中 $\mathcal{D}\subseteq \mathbb{R}\times M$ 是流域，这个映射满足：对于任意 $p\in M$，
\[
  \theta(0,p)=p,
\]
对于 $s\in \mathcal{D}^{(p)}$ 和 $t\in \mathcal{D}^{(\theta(s,p))}$，如果
$s+t\in \mathcal{D}^{(p)}$，那么
\[
  \theta\bigl(t,\theta(s,p)\bigr)=\theta(t+s,p).
\]
有时我们将 $\theta$ 称为\emph{局部流}来和全局流区分。

如果 $\theta$ 是流，只要 $(t,p)\in \mathcal{D}$，我们定义 $\theta_t(p)=\theta^{(p)}(t)=\theta(t,p)$，
这与全局流一致。对于每个 $t\in \mathbb{R}$，我们还定义
\[
  M_t=\{p\in M\,|\, (t,p)\in \mathcal{D}\},
\]
所以
\[
  p\in M_t\Leftrightarrow (t,p)\in \mathcal{D}\Leftrightarrow t\in \mathcal{D}^{(p)}.
\]
如果 $\theta$ 是光滑的，定义 $\theta$ 的\emph{无穷小生成元} $V$ 为 $V_p=\smash{\theta^{(p)}}'(0)$。

\begin{proposition}
  如果 $\theta:\mathcal{D}\to M$ 是光滑流，那么无穷小生成元 $V$ 是光滑向量场，并且
  每条曲线 $\theta^{(p)}$ 都是 $V$ 的积分曲线。
\end{proposition}

下面的定理是本节的主要结果。\emph{极大积分曲线}指的是不能延拓到任意更大开区间的一条积分曲线，
\emph{极大流}指的是不能延拓到任意更大流域的流。

\begin{theorem}[流的基本定理]
  令 $V$ 是光滑流形 $M$ 上的光滑向量场，那么存在唯一的光滑极大流 $\theta:\mathcal{D}\to M$
  使得其无穷小生成元为 $V$，此外，这个流有下面的性质：
  \begin{enumerate}
    \item 对于每个 $p\in M$，曲线 $\theta^{(p)}:\mathcal{D}^{(p)}\to M$ 是 $V$ 的唯一的
    以 $p$ 为起点的极大积分曲线。
    \item 如果 $s\in \mathcal{D}^{(p)}$，那么 $\mathcal{D}^{(\theta(s,p))}$ 是区间
    $\mathcal{D}^{(p)}-s=\{t-s\,|\, t\in \mathcal{D}^{(p)}\}$。
    \item 对于每个 $t\in \mathbb{R}$，$M_t$ 是 $M$ 的开集，并且 $\theta_t:M_t\to M_{-t}$
    是微分同胚，其逆为 $\theta_{-t}$。
  \end{enumerate}
\end{theorem}

上述基本定理中断言的存在且唯一的流称为\emph{$V$ 生成的流}，或者简称为\emph{$V$ 的流}。

\begin{proposition}[流的自然性]
  设 $M,N$ 是光滑流形，$F:M\to N$ 是光滑映射，$X\in \mathfrak{X}(M)$，
  $Y\in \mathfrak{X}(N)$。令 $\theta$ 是 $X$ 的流，$\eta$ 是 $Y$ 的流。
  如果 $X$ 和 $Y$ 是 $F$-相关的，那么对于每个 $t\in \mathbb{R}$，
  $F(M_t)\subseteq N_t$ 并且 $\eta_t\circ F=F\circ\theta_t$：
  \[
    \begin{tikzcd}
      M_t\arrow[r,"F"]\arrow[d,"\theta_t"'] & N_t\arrow[d,"\eta_t"]\\
      M_{-t}\arrow[r,"F"] & N_{-t}
    \end{tikzcd}  
  \]
\end{proposition} 
\begin{proof}
  根据 \autoref{prop:naturality of integral curve}，对于任意 $p\in M$，
  曲线 $F\circ\theta^{(p)}$ 是 $Y$ 的以 $F(p)$ 为起点的积分曲线，根据积分曲线
  的唯一性，极大积分曲线 $\eta^{(F(p))}$ 至少定义在区间 $\mathcal{D}^{(p)}$
  上并且在这个区间上有 $F\circ\theta^{(p)}=\eta^{(F(p))}$。这意味着
  \[
    p\in M_t\Rightarrow t\in \mathcal{D}^{(p)}  
    \Rightarrow t\in \mathcal{D}^{(F(p))}\Rightarrow F(p)\in N_t,
  \]
  所以 $F(M_t)\subseteq N_t$。并且在 $t\in \mathcal{D}^{(p)}$
  时，有 $F\bigl(\theta^{(p)}(t)\bigr)=\eta^{(F(p))}(t)$，
  这等价于 $\eta_t(F(p))=F(\theta_t(p))$。
\end{proof}

\begin{corollary}[流的微分同胚不变性]
  令 $F:M\to N$ 是微分同胚，如果 $X\in \mathfrak{X}(M)$ 以及
  $\theta$ 是 $X$ 的流，那么 $F_*X$ 的流为任取 $t\in \mathbb{R}$，$\eta_t=F\circ\theta_t\circ F^{-1}$，
  流域满足 $N_t=F(M_t)$。
\end{corollary}

\subsection{完备向量场}

我们已经注意到不是所有的光滑向量场都生成一个全局流，能够生成全局流
的光滑向量场足够重要，所以我们给它们一个名字。我们称一个光滑向量场
是\emph{完备的}当且仅当其能够生成一个全局流，或者等价地说，
它的极大积分曲线对所有的 $t\in \mathbb{R}$ 都有定义。
我们将表明所有的紧支向量场是完备的，因此紧流形上的所有光滑向量场都是完备的。


\begin{theorem}
  光滑流形上的紧支光滑向量场是完备的。
\end{theorem}

\begin{corollary}
  紧流形上的光滑向量场是完备的。
\end{corollary}

李群上的左不变向量场构成了另一类重要的完备向量场。

\begin{theorem}
  李群上的左不变向量场是完备的。
\end{theorem}




\chapter{向量丛}

\section{向量丛}

令 $M$ 是拓扑空间，\emph{$M$ 上的秩 $k$ 的(实)向量丛}指的是一个拓扑空间
$E$ 附带一个连续满射 $\pi:E\to M$，其满足下面的条件：
\begin{enumerate}
  \item 对于每个 $p\in M$，$p$ 上的纤维 $E_p=\pi^{-1}(p)$ 有一个
  $k$-维的实向量空间结构。
  \item 对于每个 $p\in M$，都存在 $p$ 的邻域 $U$ 和一个同胚
  $\varPhi:\pi^{-1}(U)\to U\times \mathbb{R}^k$ (这个同胚被称为
  \emph{$E$ 在 $U$ 上的局部平凡化})，并且 $\varPhi$ 满足：
  \begin{itemize}[nosep]
    \item 记 $\pi_U:U\times \mathbb{R}^k\to U$ 是投影，
    有 $\pi_U\circ\varPhi=\pi$；
    \item 对于每个 $q\in U$，$\varPhi|_{{E_q}}$ 都是
    $E_q$ 到 $\{q\}\times \mathbb{R}^k$ 的向量空间同构。
  \end{itemize}
\end{enumerate} 
如果 $M,E$ 都是光滑流形，$\pi$ 是光滑映射并且局部平凡化可以
选取为微分同胚，那么 $E$ 被称为\emph{光滑向量丛}。在这种情况下，
我们将局部平凡化成为\emph{光滑局部平凡化}。

空间 $E$ 被称为\emph{丛的全空间}，$M$ 被称为\emph{底空间}，
$\pi$ 被称为\emph{投影}。

\begin{exercise}
  设 $E$ 是 $M$ 上的光滑向量丛，证明投影 $\pi:E\to M$
  是满射的光滑浸没。
\end{exercise}
\begin{proof}
  根据定义 $\pi$ 是满射。任取 $p\in M$，设 $U$ 是 $p$ 的邻域，
  $\varPhi:\pi^{-1}(U)\to U\times \mathbb{R}^k$ 是光滑局部平凡化，那么
  $\pi_U\circ\varPhi=\pi$。由于 $\pi_U$ 是光滑浸没，$\varPhi$
  是微分同胚，所以 $\pi$ 是光滑浸没。
\end{proof}

如果存在 $E$ 在整个 $M$ 上的局部平凡化(这被称为\emph{$E$ 的全局平凡化})，
那么 $E$ 被称为\emph{平凡丛}。在这种情况下，$E$ 本身同胚于
$M\times \mathbb{R}^k$。如果 $E\to M$ 是光滑丛并且有一个光滑
的全局平凡化，那么我们说 $E$ 是\emph{光滑平凡丛}，此时
$E$ 微分同胚于 $M\times \mathbb{R}^k$。

\begin{example}[积丛]
  任意空间 $M$ 上的最简单的秩 $k$ 的向量丛是积空间 $E=M\times \mathbb{R}^k$，
  投影 $\pi=\pi_1:M\times \mathbb{R}^k\to M$。这样的丛被称为\emph{积丛}，那么恒等映射
  $\Id_E$ 就是一个全局平凡化，所以积丛是平凡丛。
\end{example}

\begin{proposition}[切丛作为向量丛]
  令 $M$ 是一个光滑 $n$-流形，$TM$ 是切丛。那么
  $TM$ 是 $M$ 上的秩 $n$ 的光滑向量丛。
\end{proposition}
\begin{proof}
  记 $\pi:TM\to M$ 是投影映射。对于每个 $p\in M$，$\pi^{-1}(p)=T_pM$
  是 $n$ 维向量空间。取 $p$ 处的光滑坐标卡 $(U,(x^i))$，那么
  $\varPhi:\pi^{-1}(U)\to U\times \mathbb{R}^n$ 可以定义为
  \[
    \varPhi\left(v^i\left.\frac{\partial}{\partial x^i}\right|_q\right) 
    =\left(q,\bigl(v^1,\dots,v^n\bigr)\right),
  \]
  那么 $\varPhi$ 的坐标表示为恒等映射，所以是微分同胚。
  对于每个 $q\in U$，$\varPhi$ 限制在 $T_qM$ 上显然都是
  向量空间同构。此外容易验证 $\pi_U\circ \varPhi=\pi$。
\end{proof}
 
\begin{lemma}
  令 $\pi:E\to M$ 是秩 $k$ 的光滑向量丛，假设 $\varPhi:\pi^{-1}(U)\to U\times \mathbb{R}^k$
  和 $\varPsi:\pi^{-1}(V)\to V\times \mathbb{R}^k$ 是两个 $E$ 的光滑局部平凡化
  并且 $U\cap V\neq\emptyset$。那么存在一个光滑映射 $\tau:U\cap V\to \GL(k,\mathbb{R})$
  使得复合映射 $\varPhi\circ\varPsi^{-1}:(U\cap V)\times \mathbb{R}^k\to (U\cap V)\times \mathbb{R}^k$
  形如
  \[
    \varPhi\circ\varPsi^{-1}(p,v)=\bigl(p,\tau(p)v\bigr)  .
  \]
\end{lemma}
\begin{proof}
  我们有下面的交换图：
  \[
    \begin{tikzcd}[column sep=2.4em]
      (U\cap V)\times \mathbb{R}^k\arrow[dr,"\pi_1"']
      &
      \pi^{-1}(U\cap V)\arrow[l,"\varPsi"']\arrow[r,"\varPhi"]\arrow[d,"\pi"]
      &
      (U\cap V)\times \mathbb{R}^k\arrow[dl,"\pi_1"]\\
      & 
      U\cap V
      &
    \end{tikzcd}  
  \]
  其中 $\varPhi,\varPsi$ 都是微分同胚。那么对于任意的
  $(p,v)\in(U\cap V)\times \mathbb{R}^k$，有
  \[
    p=\pi_1(p,v)=\pi\circ\varPsi^{-1}(p,v)=\pi_1\circ(\varPhi\circ\varPsi^{-1})
    (p,v),  
  \]
  这表明
  \[
    \varPhi\circ\varPsi^{-1}(p,v)=\bigl(p,\sigma(p,v)\bigr),
  \]
  其中 $\sigma:(U\cap V)\times \mathbb{R}^k\to \mathbb{R}^k$ 是光滑映射。
  对于每个固定的 $p\in U\cap V$，
  \[ 
    \varPhi\circ\varPsi^{-1}:\{p\}\times \mathbb{R}^k\xrightarrow{\varPsi^{-1}}
    E_p\xrightarrow{\varPhi}\{p\}\times \mathbb{R}^k
  \]
  是向量空间 $\{p\}\times \mathbb{R}^k$ 上的可逆线性变换，所以
  $\sigma(p,v)=\tau(p)v$，其中 $\tau(p)\in\GL(k,\mathbb{R})$。
\end{proof}

上述光滑映射 $\tau:U\cap V\to\GL(k,\mathbb{R})$ 被称为局部平凡化
$\varPhi$ 和 $\varPsi$ 之间的\emph{转移函数}。

\begin{lemma}[向量丛坐标卡引理]
  令 $M$ 是光滑流形，假设对于每个 $p\in M$ 我们都赋予一个 $k$ 维实向量空间
  $E_p$。令 $E=\coprod_{p\in M}E_p$，$\pi:E\to M$ 将 $E_p$ 的每个元素
  送到点 $p$。如果我们还有下面的资料：
  \begin{enumerate}
    \item $M$ 的一个开覆盖 $\{U_\alpha\}_{\alpha\in A}$；
    \item 对于每个 $\alpha\in A$，有双射 $\varPhi_\alpha:\pi^{-1}(U_\alpha)\to U_\alpha\times \mathbb{R}^k$，
    并且 $\varPhi$ 限制在每个 $E_p$ 上是向量空间 $E_p$ 到 $\{p\}\times \mathbb{R}^k$ 的同构；
    \item 对于每个 $\alpha,\beta\in A$ 并且 $U_\alpha\cap U_\beta\neq\emptyset$，存在光滑映射
    $\tau_{\alpha\beta}:U_\alpha\cap U_\beta\to \GL(k,\mathbb{R})$ 使得映射
    $\varPhi_\alpha\circ\varPhi_\beta^{-1}:(U_\alpha\cap U_\beta)\times \mathbb{R}^k\to (U_\alpha\cap U_\beta)\times \mathbb{R}^k$
    形如
    \[
      \varPhi_\alpha\circ\varPhi_\beta^{-1}(p,v)=\bigl(p,\tau_{\alpha\beta}(p)v\bigr).  
    \]
  \end{enumerate}
  那么，$E$ 有唯一的拓扑和光滑结构使得其成为 $M$ 上的秩 $k$ 的光滑向量丛，
  且 $\pi$ 是投影映射，$\{(U_\alpha,\varPhi_\alpha)\}$ 是光滑局部平凡化。
\end{lemma}

\begin{remark}
  $E$ 上的拓扑结构为：对于每个 $p\in M$，选取所有满足 $p\in V_p\subseteq U_\alpha$
  的光滑坐标卡 $(V_p,\varphi_p)$，令 $\tilde\varphi_p=(\varphi_p\times \Id_{\mathbb{R}^k})\circ\varPhi_\alpha$，
  那么拓扑基 $\{\tilde\varphi_p^{-1}(W)\}$ (其中 $W\subseteq \varphi_p(V_p)\times \mathbb{R}^k$ 是开集)
  生成 $E$ 上的拓扑。$E$ 的光滑结构为：$\{(\pi^{-1}(V_p),\tilde\varphi_p)\}$
  构成 $E$ 的一组光滑坐标卡。
\end{remark} 


\begin{example}[向量丛的限制]
  设 $\pi:E\to M$ 是秩 $k$ 的向量丛，$S\subseteq M$ 是任意子集。定义\emph{$E$ 到 $S$ 的限制}
  为 $E|_S=\bigcup_{p\in S}E_p$，投影 $E|_S\to S$ 就是 $\pi$ 的限制。
  如果 $\varPhi:\pi^{-1}(U)\to U\times \mathbb{R}^k$ 是局部平凡化，那么其可以限制为双射
  $\varPhi|_S:(\pi|_S)^{-1}(U\cap S)\to (U\cap S)\times \mathbb{R}^k$。如果 $E$
  是光滑向量丛，$S\subseteq M$ 是浸入或者嵌入子流形，容易验证 $E|_S$ 是光滑向量丛。
\end{example}

\section{向量丛的局部或者全局截面}

令 $\pi:E\to M$ 是向量丛，\emph{$E$ 的(全局)截面}指的是连续映射 $\sigma:M\to E$ 使得
$\pi\circ\sigma=\Id_M$。这意味着对于每个 $p\in M$，$\sigma(p)$ 是纤维 $E_p$ 的元素。

\emph{$E$ 的局部截面}指的是一个连续映射 $\sigma:U\to E$，其中 $U\subseteq M$ 是开集，
使得 $\pi\circ\sigma=\Id_U$。

\emph{$E$ 的零截面}指的是一个全局截面 $\zeta:M\to E$，其定义为
\[
  \zeta(p)=0\in E_p\quad \forall p\in M.
\]
与向量场的情况一样，截面 $\sigma$ 的\emph{支集}定义为集合 $\{p\in M\,|\, \sigma(p)\neq 0\}$ 的闭包。

\begin{example}[向量丛的截面]
  设 $M$ 是光滑流形。
  \begin{enumerate}
    \item $TM$ 的截面就是 $M$ 上的向量场。
    \item 如果 $E=M\times \mathbb{R}^k$ 是积丛，那么在 $E$ 的截面和
    $M\to \mathbb{R}^k$ 的连续映射之间有一个自然的一一对应。一个连续映射 $F:M\to \mathbb{R}^k$
    决定了截面 $\tilde F:M\to E$ 为 $\tilde F(p)=(p,F(p))$，反之依然。如果 $M$
    是光滑流形，那么截面 $\tilde F$ 光滑当且仅当 $F$ 光滑。
  \end{enumerate}
\end{example}

如果 $\pi:E\to M$ 是光滑向量丛，那么 $E$ 的所有全局截面在逐点加法和数乘下成为一个向量空间，记为
$\Gamma(E)$。与向量场类似，光滑向量丛的截面可以左乘一个光滑实值函数：
如果 $f\in C^\infty(M),\sigma\in\Gamma(E)$，我们可以定义 $f\sigma$ 为
\[
  (f\sigma)(p)=f(p)\sigma(p).
\] 

\begin{lemma}[向量丛的延拓引理]
  令 $\pi:E\to M$ 是光滑流形 $M$ 上的向量丛，$A$ 是 $M$ 的闭子集，$\sigma:A\to E$
  是 $E|_A$ 的截面，如果对于每个 $p\in A$，都存在 $p$ 的邻域 $V$ 和
  $V$ 上的光滑截面与 $\sigma$ 在 $V\cap A$ 上重合，那么对于包含 $A$ 的任意开子集
  $U\subseteq M$，都存在光滑全局截面 $\tilde\sigma\in \Gamma(E)$ 使得
  $\tilde{\sigma}|_A=\sigma$ 以及 $\supp\tilde{\sigma}\subseteq U$。
\end{lemma}


\section{丛同态}

如果 $\pi:E\to M$ 和 $\pi':E'\to M'$ 是向量丛，连续映射 $F:E\to E'$
被称为\emph{丛同态}，如果存在映射 $f:M\to M'$ 使得
$\pi'\circ F=f\circ\pi$，即
\[
  \begin{tikzcd}
    E\arrow[r,"F"]\arrow[d,"\pi"'] & E'\arrow[d,"\pi'"]\\
    M\arrow[r,"f"'] & M' 
  \end{tikzcd}  
\]
此外，对于每个 $p\in M$，限制映射 $F|_{E_p}:E_p\to E'_{f(p)}$
是线性映射。此时我们还称 \emph{$F$ 覆盖 $f$}。

\begin{proposition}
  设 $\pi:E\to M$ 和 $\pi':E'\to M'$ 是向量丛，$F:E\to E'$
  是覆盖 $f:M\to M'$ 的丛同态，那么 $f$ 是连续映射并且由 $F$
  唯一确定。如果丛和 $F$ 都是光滑的，那么 $f$ 也是光滑的。
\end{proposition}
\begin{proof}
  记 $\zeta:M\to E$ 是零截面，那么 $f=\pi'\circ F\circ\zeta$。
\end{proof}


\section{子丛}





\chapter{余切丛}

\section{余向量}

\subsection{流形上的余向量}

$M$ 是光滑流形，对于每个 $p\in M$，定义\emph{$p$ 处的余切空间}
$T_p^*M$ 为切空间 $T_pM$ 的对偶空间：
\[
  T_p^*M=(T_pM)^*.  
\]
$T_p^*M$ 的元素被称为\emph{$p$ 处的余切向量}，或者简称为\emph{$p$ 处的余向量}。

给定开子集 $U\subseteq M$ 上的一个光滑局部坐标 $\left(x^i\right)$，
对于每个 $p\in U$，坐标基 $\left(\partial /\partial x^i|_p\right)$
给出了 $T_p^*M$ 的一组对偶基 $\left(\lambda^i|_p\right)$。
那么任意余向量 $\omega\in T_p^*M$ 都可以唯一地表示为 $\omega=\omega_i\lambda^i|_p$，
此时
\[
  \omega\left(\left.\frac{\partial}{\partial x^j}\right|_p\right)=\omega_i  
  \lambda^i|_p\left(\left.\frac{\partial}{\partial x^j}\right|_p\right)
  =\omega_j.
\]

假设 $\left(\tilde{x}^i\right)$ 是 $p$ 处的另一个光滑局部坐标，
$\left(\tilde{\lambda}^j|_p\right)$ 是关于 $\left(\tilde{x}^i\right)$
的一族对偶基。此时切空间 $T_pM$ 的两组基之间有基变换
\[
  \left.\frac{\partial}{\partial x^i}\right|_p=
  \frac{\partial\tilde x^j}{\partial x^i}(\hat p)
  \left.\frac{\partial}{\partial \tilde x^j}\right|_p.
\]
现在假设 $\omega\in T_p^*M$ 有表示 
$\omega=\omega_i\lambda^i|_p=\tilde{\omega}_j\tilde{\lambda}^j|_p$，
那么我们有
\[
  \omega_i=\omega\left(
    \left.\frac{\partial}{\partial x^i}\right|_p
  \right)=
  \frac{\partial\tilde x^j}{\partial x^i}(\hat p)
  \tilde{\omega}_j.
\]


\subsection{余向量场}

对于光滑流形 $M$，无交并
\[
  T^*M=\coprod_{p\in M}T_p^*M  
\]
被称为\emph{$M$ 的余切丛}。其有一个自然的投影映射 $\pi:T^*M\to M$，
将 $\omega\in T_p^*M$ 送到 $p$。给定开子集 $U$ 上的光滑局部坐标
$\left(x^i\right)$，对于每个 $p\in U$，记 $\left(\partial/\partial x^i|_p\right)$
的对偶基为 $\left(\lambda^i|_p\right)$，这定义了 $n$ 个映射
$\lambda^1,\dots,\lambda^n:U\to T^*M$，被称为\emph{坐标余向量场}。

\begin{proposition}[余切丛作为向量丛]
  $M$ 是一个光滑流形。配备标准的投影映射和每个纤维上的自然的向量空间结构，
  余切丛 $T^*M$ 有唯一的拓扑和光滑结构使得其成为 $M$ 
  上的秩 $n$ 的光滑向量丛使得所有的坐标余向量场
  都是光滑的局部截面。
\end{proposition}

与切丛一样，$M$ 的光滑局部坐标导出了余切丛的光滑局部坐标。如果 
$\left(x^i\right)$ 是开子集 $U\subseteq M$ 上的光滑局部坐标，
那么从 $\pi^{-1}(U)$ 到 $\mathbb{R}^{2n}$ 的映射
\[
  \xi_i\lambda^i|_p \mapsto 
  \left(x^1(p),\dots,x^n(p),\xi_1,\dots,\xi_n\right)
\]
是 $T^*M$ 上的光滑局部坐标。我们说 $\left(x^i,\xi_i\right)$ 是
$T^*M$ 关于 $\left(x^i\right)$ 的\emph{自然坐标}。

$T^*M$ 的一个(局部或者全局的)截面被称为\emph{余向量场}或者
\emph{$1$-形式}。与其他丛的截面一样，没有任何限定词的余向量场
仅仅假设是连续的。我们将余向量场 $\omega$ 在 $p$ 处的值记为
$\omega_p$。在开集 $U$ 上的光滑局部坐标中，余向量场 $\omega$
可以由坐标余向量场 $\left(\lambda^i\right)$ 表示为
$\omega=\omega_i\lambda^i$，其中 $\omega_i:U\to \mathbb{R}$
被称为\emph{$\omega$ 的分量函数}，它们刻画为
\[
  \omega_i(p)=\omega_p\left(\left.\frac{\partial}{\partial x^i}\right|_p\right).  
\]

如果 $\omega$ 是 $M$ 上的余向量场，$X$ 是 $M$ 上的向量场，我们可以构造
一个函数 $\omega(X):M\to \mathbb{R}$ 为
\[
  \omega(X)(p)=\omega_p(X_p).  
\]
如果我们用坐标表示 $\omega=\omega_i\lambda^i$ 和 $X=X^j\partial/\partial x^j$，那么
\[
  \omega(X)(p)=\left(\omega_i(p)\lambda^i|_p\right) 
  \left(X^j(p)\left.\frac{\partial}{\partial x^j}\right|_p\right)
  =\omega_i(p)X^i(p),
\]
所以 $\omega(X)$ 有局部坐标表示 $\omega(X)=\omega_iX^i$。

与向量场一样，我们有很多方法可以检验余向量场的光滑性。

\begin{proposition}[余向量场的光滑性判别]
  $M$ 是一个光滑流形，$\omega:M\to T^*M$ 是余向量场，那么下面的说法等价：
  \begin{enumerate}
    \item $\omega$ 是光滑的。
    \item 在每个光滑坐标卡下，$\omega$ 的分量都是光滑的。
    \item 对于每个光滑向量场 $X\in \mathfrak{X}(M)$，
    函数 $\omega(X)$ 是光滑函数。
    \item 对于每个开集 $U\subseteq M$ 和光滑向量场 $X\in \mathfrak{X}(U)$，
    函数 $\omega(X):U\to \mathbb{R}$ 是光滑的。
  \end{enumerate}
\end{proposition}
\begin{proof}
  $(1)\Rightarrow (2)$ 设 $(U,(x^i))$ 是一个光滑坐标卡，
  此时 $\omega=\omega_i\lambda^i$，即对于任意 $p\in U$，有
  $\omega_p=\omega_i(p)\lambda^i|_p$。$\omega$ 光滑表明
  其在这个坐标卡下的坐标表示
  \[
    (x^1,\dots,x^n)\mapsto \bigl(x^1,\dots,x^n,\omega_1(x),\dots,\omega_n(x)\bigr)
  \]
  是光滑的，这就表明 $\omega_i$ 都是光滑的。
\end{proof}

\subsection{余标架}

令 $M$ 是光滑流形，$U\subseteq M$ 是开集。\emph{$U$ 上的局部余标架}
指的是一组 $U$ 上的余向量场 $(\varepsilon^1,\dots,\varepsilon^n)$
使得对于每个 $p\in U$，$\bigl(\varepsilon^i|_p\bigr)$ 构成
$T_p^*M$ 的一组基。如果 $U=M$，那么我们说这是一个\emph{全局余标架}。

\begin{example}[坐标余标架]
  对于每个光滑坐标卡 $\bigl(U,(x^i)\bigr)$，坐标余向量场
  $\bigl(\lambda^i\bigr)$ 都定义了 $U$ 上的一个局部余标架，
  被称为\emph{坐标余标架}。
\end{example}

给定开集 $U$ 上关于 $TM$ 的一个局部标架 $(E_1,\dots,E_n)$，
唯一确定了 $U$ 上的一个局部余标架 $(\varepsilon^1,\dots,\varepsilon^n)$
使得 $\bigl(\varepsilon^i|_p\bigr)$ 是 $\bigl(E_i|_p\bigr)$
的对偶基，等价地说，有 $\varepsilon^i(E_j)=\delta_j^i$。
这个余标架被称为对偶于 $(E_i)$ 的余标架。反之，给定
$U$ 上的一个局部余标架 $(\varepsilon^i)$，唯一确定了
一个局部标架 $(E_i)$，被称为对偶于 $(\varepsilon^i)$
的标架。例如，在光滑坐标卡中，坐标标架 $\bigl(\partial/\partial x^i\bigr)$
和坐标余标架 $\bigl(\lambda^i\bigr)$ 互为对偶。

\begin{lemma}
  令 $M$ 是光滑流形，$U\subseteq M$ 是开集。如果 $(E_i)$
  是 $U$ 上的局部标架，$(\varepsilon^i)$ 是其对偶标架，
  那么 $(E_i)$ 光滑当且仅当 $(\varepsilon^i)$ 光滑。
\end{lemma}
\begin{proof}
  只需要说明对于每个 $p\in U$，$(E_i)$ 在 $p$ 的某个邻域上光滑
  当且仅当 $(\varepsilon^i)$ 也在该邻域上光滑即可。
  令 $\bigl(V,\bigl(x^i\bigr)\bigr)$ 是使得 $p\in V\subseteq U$
  的光滑坐标卡，那么在 $V$ 中有
  \[
    E_i=a_i^k\frac{\partial}{\partial x^k},\quad
    \varepsilon^j=b_l^j\lambda^l,
  \]
  其中 $\bigl(a_i^k\bigr)$ 和 $\bigl(b_l^j\bigr)$ 是实值函数矩阵。
  $E_i$ 在 $V$ 上光滑当且仅当 $a_i^k$ 光滑，$\varepsilon^j$ 
  在 $V$ 上光滑当且仅当 $b_l^j$ 光滑。由于 $\varepsilon^j(E_i)=\delta_i^j$，
  所以矩阵 $\bigl(a_i^k\bigr)$ 和 $\bigl(b_l^j\bigr)$ 互为逆矩阵，
  所以 $a_i^k$ 光滑当且仅当 $b_l^j$ 光滑。
\end{proof}





\section{函数的微分}

在初等微积分中，在 $\mathbb{R}^n$ 的光滑实值函数 $f$ 的梯度
被定义为向量场，其分量是 $f$ 的偏导数，即
\begin{equation}
  \grad f= \sum_{i=1}^n\frac{\partial f}{\partial x^i}\frac{\partial}{\partial x^i}.
\end{equation}
不幸的是，这种梯度的形式并不是与坐标无关的。

\begin{example}
  令 $f(x,y)=x^2$，$X$ 是向量场
  \[
    X=\grad f=2x\frac{\partial}{\partial x},  
  \]
  考虑极坐标 $(r,\theta)$，由于
  \[
    \left.\frac{\partial}{\partial x}\right|_{(x,y)} 
    =\frac{\partial r}{\partial x}\left.\frac{\partial}{\partial r}\right|_{(r,\theta)} 
    +\frac{\partial \theta}{\partial x}\left.\frac{\partial}{\partial \theta}\right|_{(r,\theta)} 
    =\frac{x}{r}\left.\frac{\partial}{\partial r}\right|_{(r,\theta)} 
    -\frac{xy^2}{r}\left.\frac{\partial}{\partial \theta}\right|_{(r,\theta)},
  \]
  所以 $X$ 使用极坐标的表达为
  \[
    X=  \frac{2x^2}{r}\frac{\partial}{\partial r}
    -\frac{2x^2y^2}{r}\frac{\partial}{\partial \theta}
    =2r\cos^2\theta\frac{\partial}{\partial r}-
    \frac{1}{2}r^3\sin^22\theta\frac{\partial}{\partial \theta}.
  \]
  但是
  \[
    X\neq \frac{\partial f}{\partial r}\frac{\partial}{\partial r}
    +\frac{\partial f}{\partial\theta}\frac{\partial}{\partial \theta}
    =2r\cos\theta  \frac{\partial}{\partial r}-r^2\sin 2\theta
    \frac{\partial}{\partial \theta}.
  \]
\end{example}

这表明光滑函数的偏导数不能以与坐标无关的方式解释为向量场的分量，但是可以
证明它们可以解释为余向量场的分量，这是余向量场最重要的应用。

令 $f$ 是光滑流形 $M$ 上的实值函数。我们定义余向量场 $df$ 为
\[
  df_p(v)=vf\quad \forall v\in T_pM,  
\]
$df$ 被称为\emph{$f$ 的微分}。

\begin{proposition}
  光滑函数的微分是一个光滑余向量场。
\end{proposition}
\begin{proof}
  任取 $p\in M$，不难验证 $df_p:T_pM\to \mathbb{R}$ 是线性映射，所以
  $df_p\in T_p^*M$ 确实是余向量。任取 $X\in \mathfrak{X}(M)$，有
  $df(X)(p)=df_p(X_p)=X_pf=(Xf)(p)$，所以 $df(X)=Xf$ 是光滑函数，
  即 $df$ 是光滑余向量场。
\end{proof}

为了更具体地了解 $df$，我们计算它的坐标表示。令 $\left(x^i\right)$ 是
开子集 $U\subseteq M$ 上的光滑局部坐标，$\left(\lambda^i\right)$
是对应的坐标余标架。那么 $df$ 可以表示为 $df_p=A_i(p)\lambda^i|_p$，
其中 $A_i:U\to \mathbb{R}$，此时根据定义，有
\[
  \frac{\partial f}{\partial x^j}(p)=df_p\left(\left.\frac{\partial}{\partial x^j}\right|_p\right)
  =  A_i(p)\lambda^i|_p \left(\left.\frac{\partial}{\partial x^j}\right|_p\right)
  =A_j(p),
\]
于是我们得到 $df$ 的坐标表示：
\begin{equation}\label{eq:coordinate represent of df}
  df_p=\frac{\partial f}{\partial x^i}(p)\lambda^i|_p.
\end{equation}
因此，任何光滑坐标卡中 $df$ 的分量函数都是 $f$ 关于这些局部坐标
的偏导数。这表明我们可以将 $df$ 视为梯度的类似物，只不过将其以
一种坐标无关的方式重新解释。

特别地，如果我们将 $f$ 取为坐标函数 $x^j:U\to \mathbb{R}$，那么
\[
  dx^j|_p=  \frac{\partial x^j}{\partial x^i}(p)\lambda^i|_p
  =\lambda^j|_p,
\]
也就是说，坐标余向量场 $\lambda^j$ 就是微分 $dx^j$。因此，我们可以将
\eqref{eq:coordinate represent of df} 写为：
\[
  df_p=  \frac{\partial f}{\partial x^i}(p)dx^i|_p,
\]
或者作为余向量场之间的等式：
\begin{equation}
  df=\frac{\partial f}{\partial x^i}dx^i.
\end{equation}
特别地，在 $1$ 维的情况下，简化为
\[
  df=\frac{df}{dx}dx,  
\]
这正是一元微积分中我们熟悉的写法。从今以后，我们放弃记号
$\lambda^i$，转而用 $dx^i$ 替代。

\begin{proposition}[微分的性质]
  令 $M$ 是光滑流形，$f,g\in C^\infty(M)$，
  \begin{enumerate}
    \item 如果 $a,b\in \mathbb{R}$，那么
    $d(af+bg)=adf+bdg$。
    \item $d(fg)=fdg+gdf$。
    \item 如果 $g\neq 0$，那么 $d(f/g)=(gdf-fdg)/g^2$。
    \item 如果 $J\subseteq \mathbb{R}$ 包含 $f$ 的像集，
    $h:J\to \mathbb{R}$ 是光滑函数，那么
    $d(h\circ f)=(h'\circ f)df$。
    \item 如果 $f$ 是常值函数，那么 $df=0$。
  \end{enumerate}
\end{proposition}

\begin{proposition}[微分为零的函数]\label{prop:functions with vanishing differential}
  如果 $f$ 是光滑流形 $M$ 上的光滑实值函数，那么 $df=0$
  当且仅当 $f$ 在 $M$ 的每个连通分支上是常值函数。
\end{proposition}
\begin{proof}
  只需要假设 $M$ 是连通的。如果 $f$ 是常值函数，那么显然 $df=0$。
  反之，假设 $df=0$，令 $p\in M$，$\mathcal{C}=\{q\in M\,|\, f(q)=f(p)\}$。
  任取 $q\in \mathcal{C}$，令 $U$ 是以 $q$ 为中心的光滑坐标球，那么
  $df=0=\partial f/\partial x^i \d x^i$ 表明在 $U$ 上有
  $\partial f/\partial x^i\equiv 0$，根据基本的微积分内容可知
  $f$ 在 $U$ 上是常值函数，所以 $U\subseteq \mathcal{C}$，
  即 $\mathcal{C}$ 是开集。由于 $\mathcal{C}=f^{-1}(f(p))$，
  所以 $\mathcal{C}$ 是闭集。所以 $\mathcal{C}=M$。
\end{proof}


注意，对于光滑函数 $f:M\to \mathbb{R}$，我们现在定义了两种微分，
一种是在 \ref{sec:differential of map} 中定义的
$\tilde{d}\!f_p:T_pM\to T_{f(p)}\mathbb{R}$，一种是本节定义的
$df_p:T_pM\to \mathbb{R}$，这二者本质上是相同的，因为我们在给定的坐标
中，我们有典范的同构 $T_{f(p)}\mathbb{R}\simeq \mathbb{R}$。
此时，可以计算
\[
  \tilde d\!f_p\left(\left.\frac{\partial}{\partial x^i}\right|_p\right)
  =\frac{\partial f}{\partial x^i}(p)\left.\frac{d}{dt}\right|_{f(p)},
\]
以及
\[
  df_p   \left(\left.\frac{\partial}{\partial x^i}\right|_p\right)
  =\frac{\partial f}{\partial x^i}(p),
\]
所以这二者的值在同构的意义下是相同的。

\section{余向量场的拉回}

令 $F:M\to N$ 是光滑映射，$p\in M$，微分 $dF_p:T_pM\to T_{F(p)}N$
导出了对偶的线性映射
\[
  dF_p^*:T_{F(p)}^*N\to T_p^*M,  
\]
被称为 \emph{$F$ 在 $p$ 处的拉回} 或者 \emph{$F$ 的余切映射}。
根据对偶映射的定义，其刻画为：
\[
  dF_p^*(\omega)(v)= \omega(dF_p(v)),\quad \omega\in T_{F(p)}^*N,
  v\in T_pM.
\]
也即
\[
  dF_p^*(\omega)=\omega\circ dF_p.  
\]

对于向量场而言，我们注意到光滑向量场的推前仅在微分同胚或者李群同态
的特殊情况下有定义。而余向量场的情况则大有不同，事实上余向量场
总是能够拉回到一个余向量场。给定光滑映射 $F:M\to N$ 和
$N$ 上的余向量场 $\omega$，定义 $M$ 上的余向量场 $F^*\omega$
为
\[
  (F^*\omega)_p =dF_p^*(\omega_{F(p)}),
\]
这个余向量场被称为\emph{$\omega$ 通过 $F$ 的拉回}。其在切向量 $v\in T_pM$
上的作用为
\[
  (F^*\omega)_p(v)=\omega_{F(p)}\bigl(dF_p(v)\bigr)  .
\]

\begin{proposition}\label{prop:pullback of covector field}
  令 $F:M\to N$ 是光滑映射，$u$ 是 $N$ 上的连续实值函数，$\omega$ 是
  $N$ 上的余向量场，那么
  \[
    F^*(u\omega)=(u\circ F)F^*\omega,  
  \]
  此外，若 $u$ 是光滑的，那么
  \[
    F^*du=d(u\circ F).  
  \]
\end{proposition}
\begin{proof}
  直接计算得
  \begin{align*}
    \bigl(F^*(u\omega)\bigr)_p&=dF_p^*\bigl(u(F(p))\omega_{F(p)}\bigr)
    =u(F(p))dF_p^*(\omega_{F(p)})\\
    &=\bigl(u\circ F(p)\bigr) (F^*\omega)_p=\bigl((u\circ F)F^*\omega\bigr)_p.
  \end{align*}
  若 $u$ 是光滑的，那么
  \begin{align*}
    (F^*du)_p(v)&=dF_p^*(du_{F(p)})(v)=du_{F(p)}\bigl(dF_p(v)\bigr)\\
    &=dF_p(v)u=v(u\circ F)=d(u\circ F)_p(v).\qedhere
  \end{align*}
\end{proof}

\begin{proposition}
  令 $F:M\to N$ 是光滑映射，$\omega$ 是
  $N$ 上的余向量场，那么 $F^*\omega$ 是 $M$ 上的余向量场。如果
  $\omega$ 光滑，那么 $F^*\omega$ 也光滑。
\end{proposition}
\begin{proof}
  任取 $p\in M$，选取 $F(p)$ 处的光滑坐标卡 $(V,(y^j))$，令
  $U=F^{-1}(V)$。设 $\omega=\omega_jdy^j$，那么
  根据 \autoref{prop:pullback of covector field}，有
  \[
    F^*\omega=F^*\left(\omega_jdy^j\right)=
    (\omega_j\circ F)F^*dy^j=
    (\omega_j\circ F)d(y^j\circ F)=(\omega_j\circ F)dF^j,  
  \]
  所以 $F^*\omega:U\to T^*M$ 是连续映射。若 $\omega$ 光滑，显然
  $F^*\omega$ 光滑。
\end{proof}

\begin{example}
  令 $F:\mathbb{R}^3\to \mathbb{R}^2$ 为映射
  \[
    (u,v)=F(x,y,z) =(x^2y,y\sin z),
  \]
  余向量场 $\omega\in \mathfrak{X}^*(\mathbb{R}^2)$ 为
  \[
    \omega=vdu+udv,  
  \]
  那么拉回可以计算为
  \begin{align*}
    F^*\omega&=(v\circ F)dF^1+(u\circ F)dF^2\\
    &=y\sin z (2xydx+x^2dy)+x^2y(\sin zdy+y\cos zdz)\\
    &=2xy^2\sin z dx+2x^2y\sin zdy+x^2y^2\cos zdz.
  \end{align*}
\end{example}

换句话说，要计算 $F^*\omega$，只需要将 $F$ 的分量函数
复合上对应 $\omega$ 系数的分量函数即可。

\subsection{余向量场限制在子流形上}



\section{线积分}

余向量场的另一个重要应用是使得线积分的概念具有与坐标无关的意义。

我们丛最简单的情况开始：假设 $[a,b]\subseteq \mathbb{R}$
是一个区间，$\omega$ 是 $[a,b]$ 上的光滑余向量场。
（这意味着 $\omega$ 的分量函数在 $[a,b]$ 的某个邻域上有一个光滑延拓）。
令 $t$ 是 $\mathbb{R}$ 上的标准坐标，那么 $\omega$ 可以写为
$\omega_t=f(t)dt$，其中 $f$ 是光滑函数 $f:[a,b]\to \mathbb{R}$。
我们定义\emph{$\omega$ 在 $[a,b]$ 上的积分}为
\[
  \int_{[a,b]}\omega=\int_a^b f(t) \, dt.  
\]
下面的命题告诉我们这不仅仅是一个符号上的小技巧。

\begin{proposition}[积分的微分同胚不变性]\label{prop:diffeomorphic invariance of line integral}
  令 $\omega$ 是 $[a,b]\subseteq \mathbb{R}$ 上的光滑余向量场。
  如果 $\varphi:[c,d]\to[a,b]$ 是单调递增的微分同胚，那么
  \[
    \int_{[c,d]}\varphi^*\omega=\int_{[a,b]}\omega.  
  \]
\end{proposition}
\begin{proof}
  任取 $s\in [c,d]$，那么 
  $(\varphi^*\omega)_s=f(\varphi(s)) d\varphi=f(\varphi(s))\varphi'(s)ds$，于是
  \[
    \int_{[c,d]}\varphi^*\omega=\int_c^d f(\varphi(s))\varphi'(s)\, ds
    =\int_a^b f(t)\, dt=\int_{[a,b]}\omega.\qedhere
  \]
\end{proof}

令 $M$ 是一个光滑流形，\emph{$M$ 中的曲线段} 指的是一条定义域为紧区间
的连续曲线 $\gamma:[a,b]\to M$。将 $[a,b]$ 视为带边流形，如果
$\gamma$ 是光滑映射（等价地说，$\gamma$ 在端点处的某个邻域中有光滑的延拓），
那么我们说这是\emph{光滑曲线段}。如果存在 $[a,b]$ 的划分 $a=a_0<a_1<\cdots<a_k=b$
使得 $\gamma|_{[a_{i-1},a_i]}$ 是光滑的，那么我们说 $\gamma$
是\emph{分段光滑曲线段}。

\begin{proposition}
  令 $M$ 是连通的光滑流形，那么 $M$ 的任意两个点可以用分段光滑曲线段连接。
\end{proposition}
\begin{proof}
  任取 $p\in M$，定义集合 $\mathcal{C}\subseteq M$，点 $q\in \mathcal{C}$
  当且仅当存在从 $p$ 到 $q$ 的分段光滑曲线段。显然 $p\in \mathcal{C}$，
  所以 $\mathcal{C}$ 非空，我们只需要说明 $\mathcal{C}$ 既开又闭即可表明
  $\mathcal{C}=M$。

  任取 $q\in \mathcal{C}$，那么存在 $p$ 到 $q$ 的分段光滑曲线段。
  令 $U$ 是以 $q$ 为中心的光滑坐标球，那么对于任意的 $q'\in U$，
  我们可以构造从 $q$ 到 $q'$ 的光滑曲线（在坐标球中用直线连接即可），
  将这两条曲线段连接即可得到 $p$ 到 $q'$ 的分段光滑曲线段，所以
  $q'\in \mathcal{C}$，这表明 $\mathcal{C}$ 是开集。
  另一方面，任取 $q\in\partial \mathcal{C}$，同样取以 $q$ 为中心
  的光滑坐标球 $U$，那么存在 $q'\in U\cap \mathcal{C}$，
  于是存在从 $p$ 到 $q'$ 的分段光滑曲线段以及从 $q'$ 到 $q$
  的光滑曲线段，所以存在从 $p$ 到 $q$ 的分段光滑曲线段，
  所以 $q\in \mathcal{C}$，即 $\mathcal{C}$ 是闭集。
\end{proof}

如果 $\gamma:[a,b]\to M$ 是光滑曲线段，$\omega$ 是 $M$ 上的光滑余向量场，
我们定义 \emph{$\omega$ 在 $\gamma$ 上的线积分} 为
\[
  \int_\gamma\omega=\int_{[a,b]}\gamma^*\omega.  
\]
更一般地，如果 $\gamma$ 是分段光滑的，我们定义
\[
    \int_\gamma\omega=\sum_{i=1}^k\int_{[a_{i-1},a_i]}\gamma^*\omega.
\]

\begin{proposition}[线积分的性质]
  令 $M$ 是光滑流形，$\gamma:[a,b]\to M$ 是分段光滑曲线段，
  $\omega,\omega_1,\omega_2\in \mathfrak{X}^*(M)$，
  \begin{enumerate}
    \item 对于任意 $c_1,c_2\in \mathbb{R}$，有
    \[
      \int_\gamma(c_1\omega_1+c_2\omega_2)=c_1\int_\gamma\omega_1+
      c_2\int_\gamma\omega_2.  
    \]
    \item 如果 $\gamma$ 是常值映射，那么 $\int_\gamma\omega=0$。
    \item 如果 $\gamma_1=\gamma|_{[a,c]}$ 以及 $\gamma_2=\gamma|_{[c,b]}$，
    其中 $a<c<b$，那么
    \[
      \int_\gamma\omega=\int_{\gamma_1} \omega+\int_{\gamma_2}\omega.
    \]
    \item 如果 $F:M\to N$ 是任意光滑映射，$\eta\in \mathfrak{X}^*(N)$，
    那么
    \[
      \int_\gamma F^*\eta=\int_{F\circ\gamma}\eta.  
    \]
  \end{enumerate}
\end{proposition}
\begin{proof}
  (4) 只需要对 $\gamma$ 光滑的情况进行证明。我们有
  \[
    \int_\gamma F^*\eta=  \int_{[a,b]}\gamma^*(F^*\eta),
  \]
  由于
  \[
    \bigl(\gamma^*(F^*\eta)\bigr)_s(v)=
    (F^*\eta)_{\gamma(s)}(d\gamma(v))=
    \eta_{F(\gamma(s))}\bigl(d(F\circ\gamma)(s)\bigr)
    =\bigl((F\circ\gamma)^*\eta\bigr)_s(v),
  \]
  其中 $s\in[a,b]$，$v\in T_s \mathbb{R}$。所以
  \[
    \int_\gamma F^*\eta=  \int_{[a,b]}\gamma^*(F^*\eta)
    =\int_{[a,b]}(F\circ\gamma)^*\eta=\int_{F\circ\gamma}\eta.\qedhere
  \]
\end{proof}

\begin{example}\label{exa:covector field on R2-0}
  令 $M=\mathbb{R}^2 \smallsetminus\{0\}$，$\omega$ 是余向量场
  \[
    \omega=\frac{xdy-ydx}{x^2+y^2}.  
  \]
  $\gamma:[0,2\pi]\to M$ 是曲线段 $\gamma(t)=(\cos t,\sin t)$。
  那么
  \[
    \int_\gamma\omega=\int_{[0,2\pi]}\gamma^*\omega=
    \int_{[0,2\pi]}\frac{\cos t(\cos t\d t)-\sin t(-\sin t\d t)}{\cos^2 t+\sin ^2t} 
    =2\pi. 
  \]
\end{example}

线积分的一个重要性质是其独立于曲线的参数化。令 $\gamma:[a,b]\to M$
和 $\tilde\gamma:[c,d]\to M$ 是分段光滑曲线段，如果 $\tilde\gamma=\gamma\circ\varphi$，
其中 $\varphi:[c,d]\to [a,b]$ 是微分同胚，那么我们说 $\tilde{\gamma}$
是 $\gamma$ 的\emph{重参数化}。如果 $\varphi$ 是递增函数，那么
我们说 $\tilde{\gamma}$ 是\emph{向前重参数化}，反之称为%
\emph{向后重参数化}。

\begin{proposition}[线积分的参数独立性]
  令 $M$ 是光滑流形，$\omega\in \mathfrak{X}^*(M)$，$\gamma$
  是分段光滑曲线段，对于 $\gamma$ 的重参数化 $\tilde{\gamma}$，
  我们有
  \[
    \int_{\tilde{\gamma}}\omega=\begin{dcases}
      \hphantom{-}\int_\gamma\omega & \text{$\tilde{\gamma}$ 是向前重参数化},\\
      -\int_\gamma\omega & \text{$\tilde{\gamma}$ 是向后重参数化}.
    \end{dcases}  
  \]
\end{proposition}
\begin{proof}
  根据 \autoref{prop:diffeomorphic invariance of line integral}，
  对于向前重参数化的情况，我们有
  \[
    \int_{\tilde{\gamma}}\omega=\int_{[c,d]}(\gamma\circ\varphi)^*\omega
    =\int_{[c,d]}\varphi^*\gamma^*\omega=\int_{[a,b]}\gamma^*\omega
    =\int_\gamma\omega.\qedhere
  \]
\end{proof}

\begin{proposition}
  如果 $\gamma:[a,b]\to M$ 是分段光滑曲线段，那么 $\omega$ 在 $\gamma$
  上的线积分可以表示为
  \begin{equation}\label{eq:caculate line integral}
    \int_\gamma\omega=\int_a^b \omega_{\gamma(t)}\bigl(\gamma'(t)\bigr)
    \d t.
  \end{equation}
\end{proposition}
\begin{proof}
  假设 $\gamma$ 是光滑的即可。在局部坐标中，设 $\omega=\omega_i \d x^i$，
  那么
  \begin{align*}
    \omega_{\gamma(t)}\bigl(\gamma'(t)\bigr)
    &=\omega_i\bigl(\gamma(t)\bigr)\d x^i\bigl(\gamma'(t)\bigr)
    =\omega_i\bigl(\gamma(t)\bigr) \bigl(\gamma'(t) x^i\bigr)\\
    &=\omega_i\bigl(\gamma(t)\bigr)
    \left(\d \gamma_t\left(\frac{d}{ds}\bigg|_{t}\right)x^i\right)
    =\omega_i\bigl(\gamma(t)\bigr) \dot{\gamma}^i(t),
  \end{align*}
  所以
  \[
    (\gamma^*\omega)_t=\omega_i\bigl(\gamma(t)\bigr)
    \d(\gamma^i)_t=\omega_i\bigl(\gamma(t)\bigr)
    \dot{\gamma}(t)\d t=\omega_{\gamma(t)}\bigl(\gamma'(t)\bigr)\d t,
  \]
  所以
  \[
    \int_\gamma\omega=\int_{[a,b]}\gamma^*\omega
    =\int_a^b   \omega_{\gamma(t)}\bigl(\gamma'(t)\bigr)\d t.\qedhere
  \]
\end{proof}

有一种情况下的线积分计算非常简单：函数微分的线积分。

\begin{theorem}[线积分基本定理]\label{thm:fundamental theorem for line integral}
  令 $M$ 是光滑流形，$f\in C^\infty(M)$，$\gamma:[a,b]\to M$
  是分段光滑曲线段，那么
  \[
    \int_\gamma \d f =f\bigl(\gamma(b)\bigr)-
    f\bigl(\gamma(a)\bigr).
  \]
\end{theorem}
\begin{proof}
  假设 $\gamma$ 是光滑的即可。那么我们有
  \[
    \int_\gamma \d f =
    \int_a^b \d f_{\gamma(t)}\bigl(\gamma'(t)\bigr)\d t
    =\int_a^b (f\circ\gamma)'(t)\d t
    =f\bigl(\gamma(b)\bigr)-
    f\bigl(\gamma(a)\bigr).\qedhere
  \]
\end{proof}

\section{保守场}

\autoref{thm:fundamental theorem for line integral} 
表明当余向量场是光滑函数微分的时候，其线积分的计算极为简单。
出于这个原因，当余向量场拥有这个性质的时候我们给它一个术语。
对于光滑流形 $M$ 上的光滑余向量场 $\omega$，如果存在函数
$f\in C^\infty(M)$ 使得 $\omega=df$，那么我们说 $\omega$
是\emph{恰当的}。在这种情况下，函数 $f$ 称为 $\omega$ 的\emph{势}。
这个势不是唯一确定的，但是根据 \autoref{prop:functions with vanishing differential}，
$\omega$ 的任意两个势仅仅是在 $M$ 的每个连通分支上相差一个常数。

由于恰当微分很容易计算积分，所以确定余向量场是否恰当是非常重要的，
\autoref{thm:fundamental theorem for line integral} 提供了
一条重要的线索。\autoref{thm:fundamental theorem for line integral}
表明恰当余向量场的线积分仅仅与端点 $p=\gamma(a)$ 和 $q=\gamma(b)$
有关！特别地，如果 $\gamma$ 是\emph{闭合曲线段}，即 $\gamma(a)=\gamma(b)$，
那么 $df$ 在 $\gamma$ 上的积分为零。

如果 $\omega$ 在任意分段光滑闭合曲线段上的线积分为零，那么我们说
$\omega$ 是\emph{保守的}。这个术语来源于物理学：如果沿任何
闭合路径作用的力引起的能量变化为零，那么这个力场被称为保守场。

\begin{proposition}
  光滑余向量场 $\omega$ 是保守的当且仅当其线积分是路径无关的，
  也就是说，只要分段光滑曲线段 $\gamma$ 和 $\tilde{\gamma}$
  有相同的起点和终点，那么 $\int_\gamma\omega=\int_{\tilde{\gamma}}\omega$。
\end{proposition}
\begin{proof}
  假设 $\omega$ 是保守场，$\gamma(a)=\tilde{\gamma}(a)=p$，
  $\gamma(b)=\tilde{\gamma}(b)=q$，记 $\xi$ 是以 $q$ 为起点
  $p$ 为终点的分段光滑曲线段，$\zeta$ 是连接 $\gamma$ 和
  $\xi$ 的分段光滑曲线段，$\tilde\zeta$ 是连接 $\tilde\gamma$ 和
  $\xi$ 的分段光滑曲线段，根据 $\omega$ 的保守性，就有
  \[
    \int_{\tilde\gamma}\omega+\int_{\xi}\omega=\int_{\tilde{\zeta}}\omega=0=\int_{\zeta}\omega=\int_{\gamma}\omega+\int_{\xi}\omega,  
  \]
  即 $\int_\gamma\omega=\int_{\tilde\gamma}\omega$。

  反之，假设 $\int_\gamma\omega=\int_{\tilde{\gamma}}\omega$。
  那么任取分段光滑闭合曲线段 $\gamma$，设 $\zeta$ 是值为 $\gamma(a)=\gamma(b)$
  的常值曲线，那么 
  \[
    \int_\gamma\omega=\int_\zeta\omega=0,  
  \]
  即 $\omega$ 是保守场。
\end{proof}

\begin{theorem}
  令 $M$ 是光滑流形，$M$ 上的光滑余向量场是保守的当且仅当其是恰当的。
\end{theorem}

如果每个光滑余向量场都是恰当的自然是最好不过，因为此时线积分
的计算只需要找到一个势函数然后计算端点处的值即可，但是，
这个假设是不成立的。

\begin{example}
  \autoref{exa:covector field on R2-0} 中的余向量场 $\omega$
  不是恰当的，因为其不是保守的，当 $\gamma$ 取逆时针的圆周时，
  $\gamma$ 是闭合光滑曲线段，但是 $\int_\gamma\omega=2\pi\neq 0$。
\end{example}






\chapter{张量}

\section{多重线性代数}

\subsection{向量空间的张量积}

\begin{proposition}[抽象的张量积 vs. 具体的张量积]
  如果 $V_1,\dots,V_k$ 是有限维向量空间，那么存在典范同构：
  \[
    V_1^*\otimes \cdots\otimes V_k^*\simeq \LL(V_1,\dots,V_k;\mathbb{R}),
  \]
  其中抽象的单张量 $\omega^1\otimes \cdots\otimes\omega^k$ 对应到
  多重线性映射
  \[
    \omega^1\otimes\cdots\otimes\omega^k(v_1,\dots,v_k)=
    \omega^1(v_1)\cdots \omega^k(v^k).  
  \]
\end{proposition}

\subsection{向量空间上的协变张量和逆变张量}

$V$ 是有限维向量空间，\emph{$V$ 上的协变 $k$-张量}指的是
$k$ 重张量积 $V^*\otimes\cdots\otimes V^*$ 中的元素，我们可以将其视为
$V$ 上的 $k$-重多重线性映射
\[
  \alpha:V\times\cdots\times V\to \mathbb{R},
\]
$k$ 被称为\emph{$\alpha$ 的秩}。出于惯例，将 $0$-张量定义为实数。我们将 $V$ 上的所有协变 $k$-张量构成的
向量空间简记为
\[
  T^k(V^*)=V^*\otimes\cdots\otimes V^*.
\]

定义\emph{$V$ 上秩 $k$ 的逆变张量}空间为向量空间
\[
  T^k(V)=V\otimes \cdots\otimes V.  
\]
特别地，$T^1(V)=V$，同样出于惯例，定义 $T^0(V)=\mathbb{R}$。
逆变 $k$-张量可以被视为 $V^*$ 上的 $k$-多重线性映射
\[
  \alpha:V^*\times \cdots\times V^*\to \mathbb{R} . 
\]
但是对于大多数目的来说，将逆变张量视为抽象的张量积空间中的元素更加简单。

更一般的，定义\emph{$V$ 上的 $(k,l)$ 型混合张量}空间为
\[
  T^{(k,l)}(V)=T^k(V)\otimes T^l(V^*)=\underbrace{V\otimes\cdots\otimes V}_{\text{$k$ copies}}  
  \otimes \underbrace{V^*\otimes\cdots\otimes V^*}_{\text{$l$ copies}}.
\]
上述定义的一些特殊情况为：
\begin{align*}
  T^{(0,0)}(V)&=T^0(V)=T^0(V^*)=\mathbb{R},\\
  T^{(0,1)}(V)&=T^1(V^*)=V^*,\\
  T^{(1,0)}(V)&=T^1(V)=V,\\
  T^{(0,k)}(V)&=T^k(V^*),\\
  T^{(k,0)}(V)&=T^k(V).
\end{align*}




\section{流形上的张量和张量场}

令 $M$ 是光滑流形，定义 \emph{$M$ 上的协变 $k$-张量丛}为
\[
  T^kT^*M=\coprod_{p\in M}T^k\bigl(T_p^*M\bigr).  
\] 
类似地，定义 \emph{$M$ 上的逆变 $k$-张量丛}为
\[
  T^kTM=\coprod_{p\in M}T^k\bigl(T_pM\bigr)  .
\]
\emph{$M$ 上的 $(k,l)$ 型混合张量丛}为
\[
  T^{(k,l)}TM=\coprod_{p\in M}  T^{(k,l)}\bigl(T_pM\bigr).
\]

上述这些丛中任意一个都被称为\emph{$M$ 上的张量丛}。张量丛
的截面被称为\emph{$M$ 上的(协变、逆变或者混合)张量场}。
使用上面的定义，我们发现逆变 $1$-张量场就是向量场，
协变 $1$-张量场就是余向量场。$0$-张量场就是连续实值函数。

这些张量场的光滑截面构成的空间 
$\Gamma\bigl(T^kT^*M\bigr),\Gamma\bigl(T^kTM\bigr),\Gamma\bigl(T^{(k,l)}TM\bigr)$
是 $\mathbb{R}$ 上的无限维向量空间，也是 $C^\infty(M)$ 环上的模。
在任意光滑局部坐标 $\left(x^i\right)$ 下，这些丛的截面
可以表示为
\[
  A=\begin{dcases}
    A_{i_1\dots i_k}dx^{i_1}\otimes\cdots\otimes dx^{i_k} & A\in \Gamma\bigl(T^kT^*M\bigr),\\
    A^{i_1\dots i_k}\frac{\partial}{\partial x^{i_1}}\otimes
    \cdots\otimes \frac{\partial}{\partial x^{i_k}} & A\in \Gamma\bigl(T^kTM\bigr),\\
    A_{j_1\dots j_l}^{i_1\dots i_k}\frac{\partial}{\partial x^{i_1}}\otimes
    \cdots\otimes \frac{\partial}{\partial x^{i_k}}\otimes
    dx^{j_1}\otimes\cdots\otimes dx^{j_l} & A\in \Gamma\bigl(T^{(k,l)}TM\bigr).
  \end{dcases}  
\]
函数 $A_{i_1\dots i_k},A^{i_1\dots i_k},A_{j_1\dots j_l}^{i_1\dots i_k}$ 被称为
\emph{$A$ 的分量函数}。由于我们主要关注光滑协变张量场，所以我们对于
光滑协变 $k$-张量场，采用以下简写：
\[
  \mathcal{T}^k(M)=\Gamma\bigl(T^kT^*M\bigr)  .
\]

\subsection{张量场的拉回}

与余向量场类似，协变张量场可以通过光滑映射拉回产生定义域上的张量场。
注意拉回构造仅限于协变张量场，这也是我们更多关注协变张量的原因之一。

设 $F:M\to N$ 是光滑映射。对于任意点 $p\in M$ 和 $k$-张量
$\alpha\in T^k\bigl(T_{F(p)}^*N\bigr)$，我们定义张量
$dF_p^*(\alpha)\in T^k\bigl(T_p^*M\bigr)$ 为
\[
  dF_p^*(\alpha)(v_1,\dots,v_k)=\alpha\bigl(dF_p(v_1),\dots,dF_p(v_k)\bigr)  ,
\]
其中 $v_1,\dots,v_k\in T_pM$，这个 $dF_p^*(\alpha)$ 被称为
\emph{$\alpha$ 通过 $F$ 在 $p$ 处的拉回}。如果 $A$ 是一个
$N$ 上的协变 $k$-张量场，我们定义 $M$ 上的 $k$-张量场
$F^*A$ 为
\[
  (F^*A)  _p=dF_p^*(A_{F(p)}).
\]
这被称为\emph{$A$ 通过 $F$ 的拉回}。这个张量场在
$v_1,\dots,v_k\in T_pM$ 上的作用为
\[
  (F^*A)  _p(v_1,\dots,v_k)=A_{F(p)}\bigl(dF_p(v_1),\dots,dF_p(v_k)\bigr).
\]


 


\chapter{黎曼度量}

\section{黎曼流形}

令 $M$ 是光滑流形，\emph{$M$ 上的黎曼度量}指的是 $M$ 上的
一个光滑的对称协变 $2$-张量场，并且在每个点处是正定的。
一个\emph{黎曼流形}指的是二元组 $(M,g)$，其中 $M$ 是光滑流形，
$g$ 是 $M$ 上的一个黎曼度量。

如果 $g$ 是黎曼度量，那么对于每个 $p\in M$，$2$-张量 $g_p\in T_p^*M\otimes T_p^*M$
是 $T_pM$ 上的一个内积。出于这一点，对于 $v,w\in T_pM$，我们通常使用 $\langle v,w\rangle_g$
来表示实数 $g_p(v,w)$。

在任意光滑局部坐标 $\left(x^i\right)$ 下，一个黎曼度量可以被写为：
\[
  g=g_{ij}dx^i\otimes dx^j.  
\]
其中 $(g_{ij})$ 是光滑函数的对称正定矩阵。$g$ 的对称性允许我们
将 $g$ 写为下述对称积的形式：


\subsection{拉回度量}

设 $M,N$ 是光滑流形，$g$ 是 $N$ 上的黎曼度量，$F:M\to N$ 是光滑映射。
拉回 $F^*g$ 是 $M$ 上的一个光滑 $2$-张量场。如果 $F^*g$ 是正定的，
那么就是 $M$ 上的黎曼度量，被称为由 $F$ 确定的\emph{拉回度量}。

\begin{proposition}[拉回度量判别法]
  设 $F:M\to N$ 是光滑映射，$g$ 是 $N$ 上的黎曼度量，那么 
  $F^*g$ 是 $M$ 上的黎曼度量当且仅当 $F$ 是光滑浸入。
\end{proposition}

如果 $(M,g)$ 和 $(\wwtilde{M},\tilde g)$ 是黎曼流形，
光滑映射 $F:M\to N$ 如果是微分同胚并且使得 $F^*\tilde g=g$，
那么我们说 $F$ 是一个\emph{(黎曼)等距}。如果每个 $p\in M$
有一个邻域 $U$ 使得 $F|_U$ 是 $U$ 到 $\wwtilde M$ 的一个开子集
的等距，那么我们说 $F$ 是一个\emph{局部等距}。

一个黎曼流形 $(M,g)$ 如果局部等距于 $(\mathbb{R}^n,\bar g)$，那么
$(M,g)$ 被称为\emph{平坦黎曼流形}，$g$ 被称为\emph{平坦度量}。

\subsection{黎曼子流形}

如果 $(M,g)$ 是一个黎曼流形，每个子流形 $S\subseteq M$
都自动继承一个拉回度量 $\iota^*g$，其中 $\iota:S\hookrightarrow M$
是包含映射。根据定义，这意味着对于 $v,w\in T_pS$，有
\[
  (\iota^*g)_p(v,w)=g_{\iota(p)}\bigl(d\iota_p(v),d\iota_p(w)\bigr)
  =g_p(v,w),
\]
注意这里我们通过 $d\iota_p:T_pS\to T_pM$，将 $T_pS$ 视为 $T_pM$
的子空间。所以 $(\iota^*g)_p$ 仅仅是 $g_p$ 在 $T_pS\times T_pS$
上的限制。在这个度量下，$S$ 被称为\emph{$M$ 的黎曼子流形}。

\subsection{法丛}

设 $(M,g)$ 是 $n$ 维黎曼流形，$S\subseteq M$ 是 $k$ 维黎曼子流形。
对于任意 $p\in S$，如果 $v\in T_pM$ 在内积 $\langle\cdot,\cdot\rangle_g$
的意义下与 $T_pS$ 中的每个向量都正交，那么我们说 $v$ \emph{正规于 $S$}。
定义 \emph{$S$ 在 $p$ 处的法空间}为子空间 $N_pS\subseteq T_pM$，
由所有 $p$ 处的正规于 $S$ 的向量构成。定义 \emph{$S$ 的法丛}
是子集 $NS\subseteq TM$，由 $S$ 在每个点处的法空间的无交并构成。


\chapter{指数映射}

\section{单参数子群和指数映射}

假设 $G$ 的李群，因为左不变向量场依赖于群结构自然地定义，
所以我们希望寻找左不变向量场的流和群乘法之间的关系。

\subsection{单参数子群}

$G$ 的一个\emph{单参数子群}指的是一个李群同态 $\gamma:\mathbb{R}\to G$，
这里 $\mathbb{R}$ 指的是加法李群。注意，单参数子群指的不是一个子群，
而是一个李群同态，但是，其像集 $\gamma(\mathbb{R})$ 是 $G$ 的一个
李子群。

\begin{theorem}[单参数子群的特征]
  令 $G$ 是李群，$G$ 的单参数子群恰好为左不变向量场的以单位元为起点的极大
  积分曲线。
\end{theorem}
\begin{proof}
  假设 $\gamma$ 是某个左不变向量场 $X\in\Lie(G)$ 的以单位元为起点的
  极大积分曲线。因为左不变向量场都是完备的，所以 $\gamma$ 
  定义在 $\mathbb{R}$ 上。左不变意味着任取 $g\in G$，$X$ 与自身 $L_g$-相关，
  根据积分曲线的自然性，所以 $L_g$ 将 $X$ 的积分曲线送到 $X$ 的积分曲线。
  对于任意的 $s\in \mathbb{R}$，那么 $L_{\gamma(s)}\circ\gamma$
  是 $X$ 的以 $\gamma(s)$ 为起点的积分曲线，根据平移引理，
  $t\mapsto \gamma(s+t)$ 也是以 $\gamma(s)$ 为起点的积分曲线，
  根据极大积分曲线的唯一性，就有
  \[
    \gamma(s+t)=\gamma(s)\gamma(t),  
  \]
  这表明 $\gamma:\mathbb{R}\to G$ 是单参数子群。

  反之，假设 $\gamma:\mathbb{R}\to G$ 是单参数子群，令 $X=\gamma_*(d/dt)\in\Lie(G)$，
  这里 $d/dt$ 表示 $\mathbb{R}$ 上的左不变向量场。由于 $\gamma(0)=e$，
  所以我们只需要验证 $\gamma$ 是 $X$ 的积分曲线。任取 $s\in \mathbb{R}$，有
  \[
    X_{\gamma(s)}=d \gamma_{s}\left(\frac{d}{dt}\bigg|_s\right)
    =\gamma'(s),
  \]
  这就表明 $\gamma$ 是 $X$ 的积分曲线。
\end{proof}

给定 $X\in\Lie(G)$，通过上述方式由 $X$ 确定的单参数子群被称为
\emph{$X$ 生成的单参数子群}。因为左不变向量场由其在单位元处的值
唯一确定，所以单参数子群也由其在 $T_eG$ 中的初速度决定，也就是说
我们有一一对应
\[
  \{\text{one-parameter subgroups of $G$}\}\longleftrightarrow
  \Lie(G)  \longleftrightarrow T_eG.
\]

\begin{proposition}
  对于任意 $A\in\lie{gl}(n,\mathbb{R})$，令
  \[
    e^A=\sum_{k=0}^\infty\frac{1}{k! }A^k  
  \]
  是矩阵指数，那么由 $A\in\lie{gl}(n,\mathbb{R})$ 生成的
  $\GL(n,\mathbb{R})$ 的单参数子群为 $\gamma(t)=e^{tA}$。
\end{proposition}
\begin{proof}
  给定 $A\in\lie{gl}(n,\mathbb{R})$，对应一个左不变向量场 $A^{\LL}$，
  因此，由 $A$ 生成的单参数子群是 $A^{\LL}$ 的一条以 $I_n$ 为起点的积分曲线
  $\gamma$，即
  \[
    \gamma(0)=I_n,  \quad
    \gamma'(t)=A^{\LL}|_{\gamma(t)}=d\bigl(L_{\gamma(t)}\bigr)_{I_n}
    \left(A\right)=\gamma(t)A,
  \]
  根据唯一性，我们只需要验证 $\gamma(t)=e^{tA}$ 满足上面的条件即可。
  因为 $e^{tA}$ 在任意有界集上都是一致收敛的，所以可以逐项求导，
  即
  \[
    \gamma'(t)=\sum_{k=1}^\infty\frac{k}{k!}t^{k-1}A^k
    =\gamma(t)A,  
  \]
  故 $\gamma(t)=e^{tA}$ 就是这样的积分曲线，即为 $A$ 生成的单参数子群。
\end{proof}

\begin{proposition}
  设 $G$ 是李群，$H\subseteq G$ 是李子群。$H$ 的单参数子群恰好为
  $G$ 的初速度在 $T_eH$ 中的单参数子群。
\end{proposition}
\begin{proof}
  令 $\gamma:\mathbb{R}\to H$ 是单参数子群，那么复合映射
  $\mathbb{R}\to H\hookrightarrow G$ 是 $G$ 的单参数子群，
  满足 $\gamma'(0)\in T_eH$。

  反之，设 $\gamma:\mathbb{R}\to G$ 是单参数子群且 $\gamma'(0)\in T_eH$。
  令 $\tilde{\gamma}:\mathbb{R}\to H$ 是 $\gamma'(0)\in T_eH$ 生成的单参数子群，
  通过复合包含映射，$\tilde{\gamma}$ 可以视为 $G$ 的单参数子群，
  因为 $\gamma$ 和 $\tilde{\gamma}$ 都是 $G$ 的单参数子群且
  有相同的初速度 $\gamma'(0)$，所以它们必须相等。
\end{proof}

\begin{example}
  令 $H$ 是 $\GL(n,\mathbb{R})$ 的李子群，前面的命题表明
  $H$ 的单参数子群恰好形如 $\gamma(t)=e^{tA}$，其中 $A\in\lie h$，
  $\lie h\subseteq \lie{gl}(n,\mathbb{R})$ 是对应于 $\Lie(H)$
  的李子代数。例如，取 $H=\Orth(n)$，这表明 $\Orth(n)$
  的单参数子群形如 $\gamma(t)=e^{tA}$，其中 $A$ 是任意反对称矩阵。
  特别地，这表明任意反对称矩阵的指数是正交矩阵。
\end{example}

\subsection{指数映射}

前一节我们看到 $\lie{gl}(n,\mathbb{R})$ 到 $\GL(n,\mathbb{R})$
的矩阵指数发挥了重要作用，其将每条过原点的直线 $tA$ 对应到单参数子群
$t\mapsto e^{tA}$。这可以推广到任意李群上。

给定一个李群 $G$，李代数 $\lie g$。定义映射 $\exp:\lie g\to G$ 为：
任取 $X\in \lie g$，令
\[
  \exp X=\gamma(1),  
\]
其中 $\gamma$ 表示 $X$ 生成的单参数子群，等价地说，即以 $e$ 为起点的
$X$ 的一条积分曲线。映射 $\exp$ 被称为 $G$ 的\emph{指数映射}。

\begin{proposition}
  $G$ 是李群，对于任意 $X\in\Lie(G)$，$\gamma(s)=\exp sX$ 是
  $G$ 的由 $X$ 生成的单参数子群。
\end{proposition}
\begin{proof}
  令 $\gamma:\mathbb{R}\to G$ 是 $X$ 生成的单参数子群，那么对于任意
  $s\in \mathbb{R}$，根据缩放引理，$\tilde{\gamma}(t)=\gamma(st)$
  是 $sX$ 的一条以 $e$ 为起点的积分曲线，所以
  \[
    \exp sX=\tilde{\gamma}(1)=\gamma(s).\qedhere  
  \]
\end{proof}

\begin{example}
  这表明 $\GL(n,\mathbb{R})$ 的指数映射为 $\exp A=e^A$，这也是
  指数映射名称的由来。
\end{example}

\begin{proposition}[指数映射的性质]
  令 $G$ 是李群，$\lie g$ 是李代数。
  \begin{enumerate}
    \item 指数映射是 $\lie g\to G$ 的光滑映射。
    \item 对于任意 $X\in\lie g$ 和 $s,t\in \mathbb{R}$，有
    $\exp(s+t)X=\exp sX \exp tX$。
    \item 对于任意 $X\in\lie g$，$(\exp X)^{-1}=\exp(-X)$。
    \item 对于任意 $X\in\lie g$ 和 $n\in \mathbb{Z}$，
    有 $(\exp X)^n=\exp(nX)$。
    \item 微分 $(d\exp)_0:T_0\lie g\to T_eG$ 是恒等映射。
    \item 指数映射限制在 $0\in \lie g$ 的某个邻域到
    $e\in G$ 的某个邻域的时候是微分同胚。
    \item 如果 $H$ 是另一个李群，$\lie h$ 是对应的李代数，
    $\varPhi:G\to H$ 是李群同态，那么有交换图：
    \begin{equation}
      \begin{tikzcd}
        \lie g\arrow[d,"\exp"']\arrow[r,"\varPhi_*"] &\lie h
        \arrow[d,"\exp"] \\
        G\arrow[r,"\varPhi"] & H 
      \end{tikzcd}
    \end{equation}
    \item 左不变向量场 $X$ 的生成流 $\theta$ 满足 
    $\theta_t=R_{\exp tX}$。
  \end{enumerate}  
\end{proposition}

 


\end{document}
