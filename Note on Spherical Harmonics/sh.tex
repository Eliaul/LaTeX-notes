\documentclass[fontset=none,zihao=-4]{Notes}

\makeatletter
\DeclareRobustCommand{\em}{%
  \@nomath\em \if b\expandafter\@car\f@series\@nil
  \normalfont \else \bfseries \fi}
\makeatother

\usepackage{tikz-cd,wrapstuff}
\usepackage{fixdif,siunitx,tikz,nicematrix}

\usetikzlibrary{hobby,calc,arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{decorations.pathreplacing}

\input{font.def}

\DeclareMathOperator\Int{Int}
\DeclareMathOperator\supp{supp}
\DeclareMathOperator\im{im}
\DeclareMathOperator\End{End}
\DeclareMathOperator\Ann{Ann}
\DeclareMathOperator\Hom{Hom}
\DeclareMathOperator\diag{diag}
\DeclareMathOperator\Or{O}
\DeclareMathOperator\rank{rank}
\DeclareMathOperator\Ob{Ob}
\DeclareMathOperator\id{id}
\DeclareMathOperator\SO{SO}
\DeclareMathOperator\SU{SU}
\DeclareMathOperator\GL{GL}
\DeclareMathOperator\SL{SL}

\newcommand{\cat}[1]{\mathsf{#1}}

\newcommand{\inn}[1]{\left\langle#1\right\rangle}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\spa}[1]{\operatorname{span}\left(#1\right)}


\makeatletter
\DeclareRobustCommand\bigop[2][1]{%
  \mathop{\vphantom{\sum}\mathpalette\bigop@{{#1}{#2}}}\slimits@
}
\newcommand{\bigop@}[2]{\bigop@@#1#2}
\newcommand{\bigop@@}[3]{%
  \vcenter{%
    \sbox\z@{$#1\sum$}%
    \hbox{\resizebox{\ifx#1\displaystyle#2\fi\dimexpr\ht\z@+\dp\z@}{!}{$\m@th#3$}}%
  }%
}
\makeatother

\newcommand{\fprod}{\DOTSB\bigop[1.05]{\ast}}

\tikzcdset{
  arrow style=tikz,
  diagrams={>={Straight Barb[scale=0.8]}}
}

\tikzset{
  point/.style={
    circle,fill,inner sep=0pt,minimum width=5pt
  }
}

\usepackage[subscriptcorrection,nofontinfo,mtpbb,mtpfrak]{mtpro2}

\usepackage{biblatex}
\addbibresource{ref.bib}
\begin{filecontents}{ref.bib}
@book{kirillov2008introduction,
  title={An introduction to Lie groups and Lie algebras},
  author={Kirillov, Alexander A},
  volume={113},
  year={2008},
  publisher={Cambridge University Press}
}

@article{notes,
  author = {Gallier, Jean},
  year = {2009},
  month = {02},
  pages = {},
  title = {Notes on Spherical Harmonics and Linear Representations of Lie Groups}
}
\end{filecontents}

\setlist[enumerate]{nosep,label=(\arabic*)}
\setlist[itemize]{nosep}

\title{\sffamily 球谐函数笔记}
\author{Eliauk}



\begin{document}

\maketitle

\tableofcontents

\section{圆上的调和函数}

Joseph Fourier (1768--1830) 在研究热传导问题时引入了 Fourier 级数的概念。使用 Fourier 级数，
每个平方可积的周期函数 $f$ 都可以唯一地表示为级数
\[
  f(\theta)=a_0+\sum_{k=1}^\infty\left(a_k\cos k\theta+b_k\sin k\theta\right),
\]
其中 Fourier 系数 $a_k,b_k$ 由下式给出：
\[
  a_0=\frac{1}{2\pi}\int_{-\pi}^{\pi}f(\theta) \d\theta,\quad
  a_k=\frac{1}{\pi}\int_{-\pi}^{\pi}f(\theta)\cos k\theta \d\theta,\quad
  b_k=\frac{1}{\pi}\int_{-\pi}^{\pi}f(\theta)\sin k\theta \d\theta.
\]

这个惊人的发现在物理学、信号处理、工程学等领域有着广泛的理论和实际应用，
但是 Fourier 级数的数学内涵远不止于此。
我们引入平方可积函数的内积
\[
  \langle f,g\rangle=\int_{-\pi}^{\pi}f(\theta)g(\theta)\d\theta,
\]
也记为
\[
  \langle f,g\rangle=\int_{\mathbb{S}^1}f(\theta)g(\theta)\d\theta,
\]
其中 $\mathbb{S}^1$ 是单位圆。实际上上述记法就是在 $\mathbb{S}^1$ 流形
上的积分。通过这个内积，空间 $L^2(\mathbb{S}^1)$ 是一个完备的赋范向量空间，
也即 Hilbert 空间。进一步的，我们定义 $L^2(\mathbb{S}^1)$ 的子空间 
$\mathcal{H}_k(\mathbb{S}^1)$ 为：$\mathcal{H}_0(\mathbb{S}^1)=\mathbb{R}$
是所有常值函数的空间，$\mathcal{H}_k(\mathbb{S}^1)$ 是由函数 $\cos k\theta$ 
和 $\sin k\theta$ 张成的二维空间。那么，Fourier 级数告诉我们有正交直和分解
\[
  L^2(\mathbb{S}^1)=\bigoplus_{k=0}^\infty \mathcal{H}_k(\mathbb{S}^1).
\]

空间 $\mathcal{H}_k(\mathbb{S}^1)$ 会自然地出现在 $\mathbb{R}^2$ 上的 Laplace 方程中，
即 $\Delta f=0$。大致来说，$\mathbb{R}^2$ 中的齐次函数 $f:\mathbb{R}^2\to \mathbb{R}$
在极坐标 $(r,\theta)$ 中有形式
\[
  f(r,\theta)=r^kg(\theta).
\]
极坐标中的 Laplace 算子为
\[
  \Delta f=\frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial f}{\partial r}\right)
  +\frac{1}{r^2}\frac{\partial^2 f}{\partial \theta^2}.
\]
当然，我们要求 $f\in C^2$ 是二阶连续可微的。如果我们把 $f$ 限制在单位圆 $\mathbb{S}^1$ 上，
那么 $\mathbb{S}^1$ 上的 Laplace 算子为
\[
  \Delta_{\mathbb{S}^1} f=\frac{\partial^2 f}{\partial \theta^2}.
\]
下面我们将看到空间 $\mathcal{H}_k(\mathbb{S}^1)$ 实际上是 $\Delta_{\mathbb{S}^1}:L^2(\mathbb{S}^1)\to L^2(\mathbb{S}^1)$ 的特征值
$-k^2$ 的特征函数空间。

对于方程 $\Delta f=0$，采用分离变量法，设 $f(r,\theta)=F(r)g(\theta)$。
假设 $F(r)=r^k$，其中 $k\geq 0$ 是整数，这意味着 $f$ 是 $k$ 次齐次函数。
其中 $g:\mathbb{S}^1\to \mathbb{R}$ 是圆上的函数。现在，将 $f$ 代入 Laplace 算子，有
\[
  \Delta f=r^{k-2}\left(k^2g(\theta)+g''(\theta)\right)
  =r^{k-2}\left(-\Delta_{\mathbb{S}^1}g(\theta)+k^2g(\theta)\right).
\]
于是我们得到 
\[
  \Delta f=0\Longleftrightarrow \Delta_{\mathbb{S}^1}g=-k^2g.
\]
即，$g$ 是 $\Delta_{\mathbb{S}^1}$ 的特征值 $-k^2$ 的特征函数。这等价于一个
二阶微分方程：
\[
  \frac{\d^2 g}{\d\theta^2}+k^2g=0,
\]
有通解
\[
  g(\theta)=a_k\cos k\theta+b_k\sin k\theta.
\]
因此，我们发现 $0,-1,-4,\dots,-k^2,\dots$ 是 $\Delta_{\mathbb{S}^1}$ 的特征值，
并且函数 $\cos k\theta$ 和 $\sin k\theta$ 是对应的特征函数。所以，
$k=0$ 的时候特征空间是 $1$ 维的，而 $k\geq 1$ 的时候特征空间是 $2$ 维的。
可以证明 $\Delta_{\mathbb{S}^1}$ 没有其他的特征值。

回到齐次调和函数 $f(r,\theta)=r^kg(\theta)$ 上，我们注意到这些函数构成的空间由
\[
  u_k=r^k\cos k\theta,\quad v_k=r^k\sin k\theta
\]
张成。因为 $(x+iy)^k=r^k(\cos k\theta+i\sin k\theta)=u_k+i v_k$，
由于复可微函数的实部和虚部都是调和函数，所以 $u_k$ 和 $v_k$ 都是 $\mathbb{R}^2$ 上的调和函数。
因此，$u_k,v_k$ 实际上还给出了 $\mathbb{R}^2$ 上所有 $k$ 次齐次调和多项式的一个基。
其中一些低次的齐次调和多项式如下：
\begin{alignat*}{2}
  k&=0 &\qquad& 1 \\
  k&=1 &\qquad& x,\,y \\
  k&=2 &\qquad& x^2-y^2,\,xy \\
  k&=3 &\qquad& x^3-3xy^2,\,3x^2y-y^3 \\
  k&=4 &\qquad& x^4-6x^2y^2+y^4,\,x^3 y-xy^3.
\end{alignat*}
于是，我们发现 $\mathbb{S}^1$ 上的 Laplace 算子的特征函数是 $\mathbb{R}^2$ 上
调和多项式在 $\mathbb{S}^1$ 上的限制，并且有 Hilbert 空间分解
$L^2(\mathbb{S}^1)=\bigoplus_{k=0}^\infty \mathcal{H}_k(\mathbb{S}^1)$。
这意味着我们可以在球面 $\mathbb{S}^2$ 上寻找类似的分解。

\section{球面上的球谐函数}

我们的目标是寻找 $\mathbb{R}^3$ 中 Laplace 方程 $\Delta f=0$ 的齐次解，并且
证明它们对应于 $2$-球面上的 Laplace 算子 $\Delta_{\mathbb{S}^2}$ 的特征函数空间 $\mathcal{H}_k(\mathbb{S}^2)$。
那么空间 $\mathcal{H}_k(\mathbb{S}^2)$ 将给出 $L^2(\mathbb{S}^2)$ 的 Hilbert 直和分解。
这是 Fourier 级数在球面上的推广，$\mathcal{H}_k(\mathbb{S}^2)$ 中的函数被称为\emph{球谐函数}。

在 $\mathbb{R}^3$ 中，采用球坐标 $(r,\theta,\varphi)$，那么
\[
  x=r\sin\theta\cos\varphi,\quad y=r\sin\theta\sin\varphi,\quad z=r\cos\theta,
\]
并且要求 $0\leq \theta<\pi$，$0\leq\varphi<2\pi$ 以及 $r>0$。那么球坐标中
Laplace 算子为
\begin{equation}\label{eq:laplace-spherical}
  \Delta f=\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial f}{\partial r}\right)
  +\frac{1}{r^2}\Delta_{\mathbb{S}^2}f,
\end{equation}
其中 $\mathbb{S}^2$ 上的 Laplace 算子为
\[
  \Delta_{\mathbb{S}^2}f=\frac{1}{\sin\theta}\frac{\partial}{\partial \theta}
  \left(\sin\theta\frac{\partial f}{\partial \theta}\right)
  +\frac{1}{\sin^2\theta}\frac{\partial^2 f}{\partial \varphi^2}.
\]
同样，我们寻找齐次调和函数 $f(r,\theta,\varphi)=r^kg(\theta,\varphi)$。
将 $f$ 代入 Laplace 方程，有
\begin{align*}
  \Delta f&=\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial (r^k g)}{\partial r}\right)
  +\frac{1}{r^2}\Delta_{\mathbb{S}^2}(r^k g) \\
  &=\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2 k r^{k-1} g\right)
  +\frac{1}{r^2}r^k \Delta_{\mathbb{S}^2} g \\
  &=r^{k-2}\left(k(k+1)g+\Delta_{\mathbb{S}^2}g\right).
\end{align*}
因此
\[
  \Delta f=0\Longleftrightarrow \Delta_{\mathbb{S}^2}g=-k(k+1)g.
\]
也即，$g$ 是 $\Delta_{\mathbb{S}^2}$ 的特征值 $-k(k+1)$ 的特征函数。

我们采用分离变量法寻找上述方程的解。令 $g(\theta,\varphi)=\Theta(\theta)\Phi(\varphi)$，那么得到方程
\[
  \frac{\Phi}{\sin\theta}\frac{\d}{\d \theta}\left(\sin\theta\frac{\d \Theta}{\d \theta}\right)
  +\frac{\Theta}{\sin^2\theta}\frac{\d^2 \Phi}{\d \varphi^2}=-k(k+1)\Theta\Phi,
\]
两边除以 $\Theta\Phi$ 并且乘以 $\sin^2\theta$，得到
\[
  \frac{\sin\theta}{\Theta}\frac{\d}{\d \theta}\left(\sin\theta\frac{\d \Theta}{\d \theta}\right)
  +k(k+1)\sin^2\theta=-\frac{1}{\Phi}\frac{\d^2 \Phi}{\d \varphi^2}.
\]
因为左边只含有 $\theta$，右边只含有 $\varphi$，所以两边只可能都等于一个常数，
记为 $\mu$。那么我们得到两个常微分方程：
\begin{align*}
  &\frac{\d^2 \Phi}{\d\varphi^2}+\mu \Phi=0, \\
  &\sin\theta\frac{\d}{\d \theta}\left(\sin\theta\frac{\d \Theta}{\d \theta}\right)
  +\left(k(k+1)\sin^2\theta-\mu\right)\Theta=0.
\end{align*}
因为我们考虑的是球面 $\mathbb{S}^2$ 上的函数，所以 $\Phi$ 是 $2\pi$-周期的，
所以必须有 $\mu=m^2$，其中 $m$ 是非负整数。那么，我们知道方程
\[
  \frac{\d^2\Phi}{\d\varphi^2}+m^2\Phi=0
\]
的解是 $2$ 维的，由下面两个函数张成：
\[
  \Phi(\varphi)=\cos m\varphi,\quad \Phi(\varphi)=\sin m\varphi.
\]
接下来，我们考虑 $\Theta$ 的方程：
\[
  \sin\theta\frac{\d}{\d \theta}\left(\sin\theta\frac{\d \Theta}{\d \theta}\right)
  +\left(k(k+1)\sin^2\theta - m^2\right)\Theta=0. 
\]
这等价于
\[
  \sin^2\theta \Theta''+\sin\theta\cos\theta \Theta'
  +\left(k(k+1)\sin^2\theta - m^2\right)\Theta=0.
\]
这是 Legendre 方程的一个变体。令 $t=\cos\theta$，考虑函数 $u(\cos\theta)=\Theta(\theta)$，
注意 $0\leq\theta<\pi$，那么我们得到二阶微分方程
\[
  (1-t^2)u''-2tu'+\left(k(k+1)-\frac{m^2}{1-t^2}\right)u=0.
\]
这被称为\emph{连带 Legendre 方程}。解这个方程的技巧是采用代换
$u(t)=(1-t^2)^{m/2}v(t)$，那么得到
\[
  (1-t^2)v''-2(m+1)tv'+(k(k+1)-m(m+1))v=0.
\]
当 $m=0$ 的时候，我们得到\emph{Legendre 方程}：
\[
  (1-t^2)v''-2tv'+k(k+1)v=0.
\]
这个方程有两个基本解 $P_k(t)$ 和 $Q_k(t)$，被称为\emph{第一类和第二类 Legendre 函数}。
$P_k(t)$ 实际上是多项式，$Q_k(t)$ 由一个在 $t=1$ 处发散的幂级数给出，
所以我们也把 $P_k(t)$ 称作\emph{Legendre 多项式}。Legendre 多项式有许多种定义形式，
其中一种定义由 \emph{Rodrigues 公式} 给出：
\[
  P_n(t)=\frac{1}{2^nn!}\frac{\d^n}{\d t^n}(t^2-1)^n.
\]
Legendre 多项式满足 $P_n(1)=1$ 以及递推关系
\begin{align*}
  P_0&=1,\quad P_1=t, \\
  (n+1)P_{n+1}&=(2n+1)tP_n - n P_{n-1} \quad n\geq 1.
\end{align*}
前六个 Legendre 多项式如下：
\[
  1,\, t,\, \frac{1}{2}(3t^2-1),\, \frac{1}{2}(5t^3-3t),\, \frac{1}{8}(35t^4-30t^2+3),\, \frac{1}{8}(63t^5-70t^3+15t).
\]

现在我们回到微分方程
\begin{equation}\label{eq:associated-Legendre}
  (1-t^2)v''-2(m+1)tv'+(k(k+1)-m(m+1))v=0.
\end{equation}
对 $t$ 微分，得到
\[
  (1-t^2)v'''-2(m+2)tv''+(k(k+1)-(m+1)(m+2))v'=0.
\]
这表明如果 $v$ 是 \eqref{eq:associated-Legendre} 式在 $k,m$ 情况下的解，
那么 $v'$ 是 \eqref{eq:associated-Legendre} 式在 $k,m+1$ 情况下的解。
因此，如果 $P_k(t)$ 在 $k$ 和 $m=0$ 的情况下是 \eqref{eq:associated-Legendre} 式的解，
那么 $P_k'(t)$ 在 $k$ 和 $m=1$ 的情况下是解，$P_k''(t)$ 在 $k$ 和 $m=2$ 的情况下是解，依此类推，
$\d^m/\d t^m \bigl(P_k(t)\bigr)$ 在 $k$ 和 $m$ 的情况下是解。于是，对于最开始的方程
\begin{equation}\label{eq:associated-Legendre-original}
  (1-t^2)u''-2tu'+\left(k(k+1)-\frac{m^2}{1-t^2}\right)u=0,
\end{equation}
有解 
\[
  u(t)=(-1)^m(1-t^2)^{m/2}\frac{\d^m}{\d t^m}\bigl(P_k(t)\bigr).
\]
这个函数 $u(t)$ 通常记为 $P_k^m(t)$，被称为\emph{连带 Legendre 函数}。
因为 $P_k(t)$ 是 $k$ 次多项式，所以在 $m>k$ 的情况下有 $P_k^m(t)\equiv 0$。
由于 $(1-t^2)^{m/2}$ 的存在，所以连带 Legendre 函数 $P_k^m(t)$ 一般来说
不是多项式并且只定义在闭区间 $[-1,1]$ 上。

连带 Legendre 函数满足许多的关系式。例如，对于 $m\geq 0$，有递推
\[
  (k-m+1)P_{k+1}^m(t)=(2k+1)tP_k^m(t)-(k+m)P_{k-1}^m(t),\quad k\geq 1.
\]
对于 $k\geq 2$，有
\[
  P_k^{m+2}(t)=-\frac{2(m+1)t}{(1-t^2)^{1/2}}P_k^{m+1}(t)
  -(k-m)(k+m+1)P_k^m(t),\quad 0\leq m\leq k-2.
\]
这些递推式可以用于从初始形式
\begin{align*}
  P_k^0(t)&=P_k(t), \\
  P_k^1(t)&=\frac{kt}{(t^2-1)^{1/2}}P_k(t)-\frac{k}{(t^2-1)^{1/2}}P_{k-1}(t)
\end{align*}
计算任意的连带 Legendre 函数 $P_k^m(t)$。
注意到 $k=m$ 的时候，有
\[
  P_{m+1}^m(t)=(2m+1)tP_m^m(t),
\]
所以还有
\[
  P_m^m(t)=(-1)^m(2m-1)!! (1-t^2)^{m/2}.
\]

再回到球谐函数的求解上，我们需要解方程
\[
  \sin^2\theta\Theta''+\sin\theta\cos\theta \Theta'
  +\left(k(k+1)\sin^2\theta - m^2\right)\Theta=0,
\]
我们使用了替换 $u(\cos\theta)=\Theta(\theta)$，并且得到了连带 Legendre 方程的解
为 $u(t)=P_k^m(t)$，所以我们有解
\[
  \Theta(\theta)=P_k^m(\cos\theta).
\]
将所有的结果综合起来，我们得到齐次函数 $f(r,\theta,\varphi)=r^k\Theta(\theta)\Phi(\varphi)$
为
\[
  f(r,\theta,\varphi)=r^k \cos m\varphi P_k^m(\cos\theta),\quad
  f(r,\theta,\varphi)=r^k \sin m\varphi P_k^m(\cos\theta),
\]
它们都是 $\mathbb{R}^3$ 上的调和函数，并且函数
\[
  \cos m\varphi P_k^m(\cos\theta),\quad \sin m\varphi P_k^m(\cos\theta)
\]
是球面上 Laplace 算子 $\Delta_{\mathbb{S}^2}$ 的特征值 $-k(k+1)$ 的特征函数。
对于固定的 $k$，取遍 $0\leq m\leq k$，我们得到 $2k+1$ 个线性无关的特征函数。

处于不同的用途，我们通常对球谐函数进行归一化处理。我们使用记号 $Y_l^m$，
其中 $l$ 是非负整数，$m$ 是整数且满足 $-l\leq m\leq l$。定义
\[
  Y_{lm}(\theta,\varphi)=\begin{cases}
    N_l^0 P_l^0(\cos\theta), & m=0, \\
    (-1)^m\sqrt{2} N_l^m \cos m\varphi P_l^m(\cos\theta), & m>0, \\
    (-1)^m\sqrt{2} N_l^{-m} \sin (-m\varphi) P_l^{-m}(\cos\theta), & m<0,
  \end{cases}
\]
其中 $N_l^m$ 是标量因子，通常被选为
\[
  N_l^m=\sqrt{\frac{(2l+1)}{4\pi}\frac{(l-m)!}{(l+m)!}}.
\]
函数 $Y_{lm}$ 被称为\emph{$l$ 次 $m$ 阶实球谐函数}。

函数 $Y_l^m$ 有许多非常漂亮的性质，为了解释它们，我们需要回顾 $L^2(\mathbb{S}^2)$
空间上的结构。$L^2(\mathbb{S}^2)$ 上的内积定义为
\[
  \langle f,g\rangle=\int_{\mathbb{S}^2} fg \d \Omega_2
  =\int_0^{2\pi}\int_0^\pi f(\theta,\varphi)g(\theta,\varphi)\sin\theta \d\theta \d\varphi.
\]
其中 $f,g\in L^2(\mathbb{S}^2)$，$\d\Omega_2$ 是 $\mathbb{S}^2$ 上的体积形式。
使用这个内积，空间 $L^2(\mathbb{S}^2)$ 是一个 Hilbert 空间。
可以证明 Laplace 算子 $\Delta_{\mathbb{S}^2}$ 相对于这个内积是自伴算子。
因为当 $l_1\neq l_2$ 的时候，函数 $Y_{l_1m_1}$ 和 $Y_{l_2m_2}$
是对应于不同特征值 $-l_1(l_1+1)$ 和 $-l_2(l_2+1)$ 的特征函数，所以它们
是正交的，也即
\[
  \left\langle Y_{l_1m_1},Y_{l_2m_2}\right\rangle=0,\quad l_1\neq l_2.
\]
同样不难证明对于固定的 $l$，有
\[
  \left\langle Y_{lm_1},Y_{lm_2}\right\rangle=\delta_{m_1 m_2}.
\]
也就是说，函数 $Y_{lm}$ 构成了一个正交函数系，我们记 $\mathcal{H}_l(\mathbb{S}^2)$
表示由这些函数张成的 $(2l+1)$-维空间。总的来说，$\Delta_{\mathbb{S}^2}$
的特征值仅有 $-l(l+1)$，并且对应的特征空间为 $E_l=\mathcal{H}_l(\mathbb{S}^2)$，
由基函数 $Y_l^m$ 张成，其中 $-l\leq m\leq l$。与圆上的情况类似，我们有
\[
  L^2(\mathbb{S}^2)=\bigoplus_{l=0}^\infty \mathcal{H}_l(\mathbb{S}^2).
\]
即任取函数 $f\in L^2(\mathbb{S}^2)$，都可以唯一表示为
\[
  f=\sum_{l=0}^\infty\sum_{-l\leq m\leq l}a_{lm} Y_{lm},
\]
这被称为\emph{球面上的 Fourier 分解}。此时 Fourier 系数计算为
\[
  a_{lm}=\langle f,Y_{lm}\rangle=\int_{\mathbb{S}^2} f(\theta,\varphi) Y_{lm}(\theta,\varphi) \d \Omega_2.
\]

当然，我们也有对应的 $\mathbb{R}^3$ 上的齐次球谐函数 $H_l^m(r,\theta,\varphi)$：
\[
  H_l^m(r,\theta,\varphi)=r^l Y_{lm}(\theta,\varphi).
\]
可以证明 $H_l^m$ 在直角坐标 $xyz$ 下总可以表示为齐次多项式！这表明：
Laplace 算子 $\Delta_{\mathbb{S}^2}$ 的特征函数（球谐函数）是 $\mathbb{R}^3$
上齐次调和多项式的限制。下面是一些低次的齐次调和多项式：
\begin{alignat*}{2}
  k&=0 &\qquad& 1 \\
  k&=1 &\qquad& x,\, y,\, z \\
  k&=2 &\qquad& x^2-y^2,\, x^2-z^2,\, xy,\, xz,\, yz \\
  k&=3 &\qquad& x^3-3xy^2,\, 3x^2y - y^3,\, x^3-3xz^2,\, 3x^2z - z^3,\, y^3-3yz^2,\, 3y^2z - z^3,\, xyz\\
\end{alignat*}

我们也可以定义对应的复球谐函数 $Y_l^m:\mathbb{S}^2\to \mathbb{C}$，其中 $-l\leq m\leq l$：
\[
  Y_l^m(\theta,\varphi)=N_l^m P_l^m(\cos\theta) e^{i m \varphi},
\]
其与实球谐函数的关系为
\[
  Y_l^m=\begin{dcases}
    \frac{(-1)^m}{\sqrt{2}}\left(Y_{l|m|}+i Y_{l,-|m|}\right), & m>0, \\
    Y_{l0}, & m=0, \\
    \frac{1}{\sqrt{2}}\left(Y_{l|m|}-i Y_{l,-|m|}\right), & m<0.
  \end{dcases}
\]
考虑复 Hilbert 空间 $L^2_{\mathbb{C}}(\mathbb{S}^2)$，内积由 Hermite 内积定义：
\[
  \langle f,g\rangle=\int_{\mathbb{S}^2} f\bar g \d \Omega_2.
\]
此时，复球谐函数 $Y_l^m$ 也是 $L_{\mathbb{C}}^2(\mathbb{S}^2)$ 上 Laplace 算子 $\Delta_{\mathbb{S}^2}$ 的特征值 $-l(l+1)$
的特征函数，并且是正交归一的。

\section{一点李群表示论}

\begin{definition}
  李群 $G$ 的一个表示指的是一个向量空间 $V$ 附带一个同态 $\rho:G\to\GL(V)$。
  李代数 $\mathfrak{g}$ 的一个表示指的是一个向量空间 $V$ 附带一个同态
  $\rho:\mathfrak{g}\to \mathfrak{gl}(V)$。
\end{definition}

李群 $G$ 的两个表示 $V,W$ 之间的 $G$-线性映射指的是一个线性映射 $f:V\to W$
与 $G$ 的作用交换：即对于任意 $g\in G$，都有 $f\circ \rho_V(g)=\rho_W(g)\circ f$。
对李代数的表示同样有类似的定义。$V$ 和 $W$ 之间的所有 $G$-线性映射构成一个向量空间，记为 $\Hom_G(V,W)$。
类似的，李代数的表示之间的线性映射构成向量空间 $\Hom_{\mathfrak{g}}(V,W)$。

不加说明的情况下，总是假设 $V$ 是复向量空间，此时 $G\to\GL(V)$ 理解为
一个光滑映射，$\GL(V)$ 是 $2n^2$-维光滑流形。

李群表示和李代数表示之间有如下重要联系。

\begin{theorem}
  令 $G$ 是李群，有李代数 $\mathfrak{g}$。
  \begin{enumerate}
    \item 每个表示 $\rho:G\to\GL(V)$ 都定义了一个李代数表示
      $\rho_*:\mathfrak{g}\to \mathfrak{gl}(V)$，并且每个 $G$-线性映射
      也是 $\mathfrak{g}$-线性映射。
    \item 如果 $G$ 是连通并且单连通的，那么 $\rho\mapsto \rho_*$ 给出了
      李群表示与李代数表示之间的一一对应，特别的，$\mathfrak{g}$
      的每个表示都可以唯一提升为 $G$ 的一个表示。
  \end{enumerate}
\end{theorem}

这是一个非常重要的定理，因为李代数作为有限维向量空间往往更容易处理。
例如，这个定理表明 $\SU(2)$ 的表示和 $\mathfrak{su}(2)$ 的表示相同，
而 $\mathfrak{su}(2)$ 是一个 $3$ 维的实向量空间。

这个定理也可以用于研究连通但是不是单连通的李群的表示。实际上，对于这样的
李群 $G$，存在一个单连通的李群 $\tilde G$ 使得 $G=\tilde G/Z$，
其中 $Z\subseteq G$ 是离散的中心子群。因此，$G$ 的表示和 $\tilde{G}$
的满足 $\rho(Z)=\mathrm{id}$ 的表示相同。一个非常重要的例子
就是二重覆盖 $\SU(2)\to \SO(3)$。

\begin{lemma}
  令 $\mathfrak{g}$ 是实李代数，$\mathfrak{g}_{ \mathbb{C}}$ 是它的复化。
  那么 $\mathfrak{g}$ 的任意复表示都可以提升为 $\mathfrak{g}_{\mathbb{C}}$ 的表示，
  并且 $\Hom_{\mathfrak{g}}(V,W)=\Hom_{\mathfrak{g}_{\mathbb{C}}}(V,W)$。
\end{lemma}
\begin{proof}
  令 $\rho:\mathfrak{g}\to \mathfrak{gl}(V)$ 是 $\mathfrak{g}$ 的一个复表示。
  延拓为 $\rho(x+iy)=\rho(x)+i\rho(y)$，这成为 $\mathfrak{g}_{\mathbb{C}}$ 的一个表示。
\end{proof}

我们重点关注 $\mathfrak{su}(2)$ 和 $\mathfrak{sl}(2,\mathbb{C})$。
$\mathfrak{su}(2)$ 的基（作为实向量空间）由 Pauli 矩阵给出：
\[
  i\sigma_1=\begin{pmatrix}
    0 & i \\ i & 0
  \end{pmatrix},\quad
  i\sigma_2=\begin{pmatrix}
    0 & 1 \\ -1 & 0
  \end{pmatrix},\quad
  i\sigma_3=\begin{pmatrix}
    i & 0 \\ 0 & -i
  \end{pmatrix}.
\]
满足对易关系
\[
  [i\sigma_1,i\sigma_2]=2i\sigma_3  ,\quad
  [i\sigma_2,i\sigma_3]=2i\sigma_1 ,\quad
  [i\sigma_3,i\sigma_1]=2i\sigma_2.
\]
$\mathfrak{sl}(2,\mathbb{C})$ 的基（作为复向量空间）为
\[
  E=\begin{pmatrix}
    0 & 1 \\ 0 & 0
  \end{pmatrix},\quad
  F=\begin{pmatrix}
    0 & 0 \\ 1 & 0
  \end{pmatrix},\quad
  H=\begin{pmatrix}
    1 & 0 \\ 0 & -1
  \end{pmatrix}.
\]
满足对易关系
\[
  [H,E]=2E,\quad [H,F]=-2F,\quad [E,F]=H.
\]
由于 $E=\frac{1}{2}(i\sigma_2-i(i\sigma_1))$，$F=\frac{1}{2}(-i\sigma_2-i(i\sigma_1))$
以及 $H=-i(i\sigma_3)$，所以 $\mathfrak{sl}(2,\mathbb{C})$ 是 $\mathfrak{su}(2)$ 的复化。
根据前面的结论，$\mathfrak{su}(2)$ 的表示和 $\mathfrak{sl}(2,\mathbb{C})$ 的表示是一样的。
同时 $\SU(2)$ 和 $\SL(2,\mathbb{C})$ 都是连通且单连通的李群，所以它们的表示
也和 $\mathfrak{su}(2)$ 的表示是一一对应的。也就是说，研究 $\SU(2)$，$\SL(2,\mathbb{C})$，
$\mathfrak{su}(2)$ 和 $\mathfrak{sl}(2,\mathbb{C})$ 的表示是等价的，
我们只需要选择其中一个来研究即可。

\begin{definition}
  令 $V$ 是 $G$（或者 $\mathfrak{g}$）的一个表示，如果子空间 $W\subseteq V$
  满足：对于任意 $g\in G$，有 $\rho(g)W\subseteq W$（或者对于任意 $x\in \mathfrak{g}$，有 $\rho(x)W\subseteq W$），
  那么称 $W$ 是 $V$ 的一个子表示。如果 $V$ 没有非平凡的子表示（即 $V$ 的子表示只有 $0$ 和 $V$），那么称 $V$ 是不可约的。
\end{definition}

例如 $\mathbb{C}^n$ 考虑为 $\SL(n,\mathbb{C})$ 的表示的时候，是不可约的。
因为可以证明，对于任意非零向量 $v\in \mathbb{C}^n$，都存在一个行列式为 $1$ 的矩阵 $A\in \SL(n,\mathbb{C})$，
使得 $Av$ 是任意一个标准基向量。因此，任意非零子空间 $W\subseteq \mathbb{C}^n$ 都包含所有的标准基向量，
所以 $W=\mathbb{C}^n$。

对于 $G$ 或者 $\mathfrak{g}$ 的两个表示 $V$ 和 $W$，它们的直和 $V\oplus W$ 也是一个表示，
只需要定义 $G$ 在 $V\oplus W$ 上的作用为
\[
  \rho_{V\oplus W}(g)(v,w)=(\rho_V  (g)v,\rho_W(g)w).
\]
  
\begin{definition}
  一个表示如果同构于若干不可约表示的直和，即存在不可约表示 $V_i$
  使得 $V\simeq\bigoplus_i V_i$，那么称它是完全可约的。
\end{definition}

通常来说，我们可以把直和项中同构的空间合并，记为 $V\simeq\bigoplus n_iV_i$，
其中 $V_i$ 是两两不同构的不可约表示，$n_i$ 是它们的重数。

令 $G=\mathbb{R}$，那么 $\mathfrak{g}=\mathbb{R}$。此时 $\mathfrak{g}$
的表示就是一个向量空间 $V$ 附带线性映射 $\mathbb{R}\to\End(V)$，
显然，这样的映射一定形如 $t\mapsto tA$，其中 $A\in \End(V)$。
所以对应的 $\mathbb{R}$ 的表示一定形如 $t\mapsto \exp(tA)$。也就是说，
分类 $\mathbb{R}$ 的表示等价于分类线性映射 $V\to V$。这样的分类
可以通过 Jordan 标准型完成。如果 $v$
是 $A$ 的一个特征向量，那么一维空间 $\mathbb{C}v\subseteq V$
在 $A$ 的作用下是不变的，所以 $\mathbb{C}v$ 是 $V$ 的一个子表示。
因此，$\mathbb{R}$ 的任意大于 $1$ 维的表示都有非平凡的子表示，
也即 $\mathbb{R}$ 的不可约表示都是 $1$ 维的。
因此，把表示 $t\mapsto \exp(tA)$ 写成一些不可约表示的直和等价于把矩阵 $A$ 对角化。
所以 $\mathbb{R}$ 的表示完全可约当且仅当矩阵 $A$ 可对角化。

\begin{lemma}
  令 $\rho:G\to\GL(V)$ 是 $G$ （或者 $\mathfrak{g}$）的表示，
  $A:V\to V$ 是可对角化的 $G$-线性映射。令 $V_\lambda\subseteq V$
  是 $A$ 的特征值 $\lambda$ 的特征空间，那么 $V_\lambda$ 是一个子表示，
  所以 $V=\bigoplus V_\lambda$ 是表示的一个直和分解。
\end{lemma}
\begin{proof}
  任取 $v\in V_\lambda$，那么 $Av=\lambda v$。对于任意 $g\in G$，有
  \[ 
    A(\rho(g)v)=\rho(g)(Av)=\rho(g)(\lambda v)=\lambda (\rho(g)v),
  \]
  所以 $\rho(g)v\in V_\lambda$，也即 $V_\lambda$ 是一个子表示。
  $A$ 可对角化意味着 $V=\bigoplus V_\lambda$，所以这是一个直和分解。
\end{proof}

\begin{lemma}[Schur 引理]
  \mbox{}
  \begin{enumerate}
    \item 令 $V$ 是 $G$ 的一个不可约复表示，那么 $\Hom_G(V,V)=\mathbb{C}\mathrm{id}$，
    即 $G$ 的不可约表示的自同态只有数乘同态。
    \item 如果 $V$ 和 $W$ 是两个不同构的不可约复表示，那么 $\Hom_G(V,W)=0$。
  \end{enumerate}
  类似的结果对于李代数 $\mathfrak{g}$ 也成立。
\end{lemma}
\begin{proof}
  如果 $\Phi:V\to W$ 是 $G$-线性映射，那么 $\ker\Phi$ 和 $\mathrm{im}\,\Phi$
  分别是 $V$ 和 $W$ 的子表示。如果 $V$ 不可约，那么 $\ker\Phi$ 是 $V$ 或者 $0$，
  所以 $\Phi$ 要么是 $0$，要么是单射。同样地，如果 $W$ 不可约，那么 $\mathrm{im}\,\Phi$
  是 $0$ 或者 $W$，所以 $\Phi$ 要么是 $0$，要么是满射。
  
  因此，如果 $V$ 和 $W$ 不同构并且都不可约，那么 $\Phi$ 只能是 $0$，所以 $\Hom_G(V,W)=0$。
  如果 $V$ 不可约，那么 $\Phi:V\to V$ 要么是 $0$，要么是同构。设 $\lambda$ 是 $\Phi$ 的一个特征值，
  那么 $\Phi-\lambda \mathrm{id}$ 不是同构，所以只能是 $0$，也即 $\Phi=\lambda \mathrm{id}$。
\end{proof}

Schur 引理有下述重要推论。

\begin{proposition}
  如果 $G$ 是交换群，那么 $G$ 的任意不可约复表示都是 $1$ 维的。
  类似地，如果 $\mathfrak{g}$ 是交换李代数，那么 $\mathfrak{g}$ 的任意不可约复表示都是 $1$ 维的。
\end{proposition}
\begin{proof}
  设 $\rho:G\to\GL(V)$ 是不可约复表示，任取 $g\in G$，那么 $\rho(g):V\to V$
  是 $G$-线性映射。因为对于任意 $h\in G$ 和 $v\in V$，
  都有 $\rho(g)(\rho(h)v)=\rho(gh)v=\rho(hg)v=\rho(h)(\rho(g)v)$。
  根据 Schur 引理，$\rho(g)=\lambda_g \mathrm{id}$，其中 $\lambda_g\in \mathbb{C}$。
  而 $V$ 不可约，所以 $V$ 是 $1$ 维的。
\end{proof}

还是考虑 $G=\mathbb{R}$。我们已经知道 $\mathbb{R}$ 的不可约表示都是 $1$ 维的。
实际上，任意 $1$ 维表示对应的李代数表示都是形如 $a\mapsto \lambda a$ 的映射，
其中 $\lambda\in \mathbb{C}$。因此，$\mathbb{R}$ 的任意不可约表示都形如 $V_\lambda$，
其中 $\lambda\in \mathbb{C}$ 并且 $V_\lambda$ 是 $1$ 维的复向量空间，
附带表示作用 $\rho(a)=e^{\lambda a}$。

类似地，我们可以描述 $\mathbb{S}^1=\mathbb{R}/\mathbb{Z}$ 的不可约表示。
此时，任意表示 $\tau:\mathbb{S}^1\to \GL(V)$ 都可以通过商映射
$\pi:\mathbb{R}\to \mathbb{S}^1$ 提升为 $\mathbb{R}$ 的表示 $\tau\circ\pi$。
并且对于任意 $a\in \mathbb{Z}$ 有 $\tau\circ\pi(a)=\tau(1)=\mathrm{id}$。
所以说 $\mathbb{S}^1$ 的表示必须是 $\mathbb{R}$ 的满足 $\rho(a)=\mathrm{id}$ 的表示。
因此，$\mathbb{S}^1$ 的不可约表示都是 $1$ 维的，形如 $V_k$，
其中 $k\in \mathbb{Z}$ 并且 $V_k$ 是 $1$ 维复向量空间，附带表示作用
$\tau\circ\pi(x)=e^{2\pi ikx}$，或者说 $\tau(z)=z^k$。

\section{Peter-Weyl 定理}

\begin{definition}
  一个李群 $G$ 的复表示 $V$ 如果存在一个 $G$-不变的 Hermite 内积，
  即对于任意 $g\in G$ 和 $v,w\in V$，都有
  \[
    \langle \rho(g)v,\rho(g)w\rangle=\langle v,w\rangle,
  \]
  那么称 $V$ 是{酉表示}。类似地，一个李代数 $\mathfrak{g}$ 的复表示 $V$
  如果存在一个 $\mathfrak{g}$-不变的 Hermite 内积
  \[
    \langle \rho(x)v,w\rangle + \langle v,\rho(x)w\rangle=0,\quad \forall x\in \mathfrak{g},\, v,w\in V,
  \]
  那么称 $V$ 是{酉表示}。
\end{definition}

酉表示的重要性体现在下面的定理。

\begin{theorem}
  每个酉表示都是完全可约的。
\end{theorem}
\begin{proof}
  对 $V$ 的维数归纳。对于 $\dim V=1$ 的情况，显然成立。假设对于 $\dim V<n$ 的情况成立。
  若 $\dim V=n$，如果 $V$ 是不可约的，那么结论成立。否则，存在非平凡子表示 $W\subseteq V$，
  那么 $V=W\oplus W^\bot$。如果 $v\in W^\bot$，那么任取 $w\in W$，有
  $\langle gv,w\rangle=\langle v,g^{-1}w\rangle=0$，所以 $gv\in W^\bot$，
  所以 $W^\bot$ 也是 $V$ 的子表示。根据归纳假设，$W$ 和 $W^\bot$ 都是完全可约的，
  所以 $V$ 也是完全可约的。对于李代数的情况同理。
\end{proof}

对于有限群而言，可以证明有限群的任意表示都是酉表示。其中需要对 $G$
上的函数平均化处理得到一个 $G$-不变的内积，从而得到酉表示结构。
然而，对于无限群，这种平均并不能通过求和完成，所以我们需要引入 Haar 测度。

\begin{definition}
  李群 $G$ 上的一个右 Haar 测度指的是 $G$ 上的一个 Borel 测度 $\d g$，
  其在右平移作用下不变：即对于任意 Borel 集合 $E\subseteq G$ 和任意 $h\in G$，
  都有 $\d g(Eh)=\d g(E)$。
\end{definition}

显然右 Haar 测度等价于对于任意 $h\in G$ 和可积函数 $f$，有
$\int f(gh)\d g=\int f(g)\d g$。类似地可以定义左 Haar 测度。

对于紧李群而言，从微分几何中的知识可知，$G$ 上存在唯一一个
双不变（同时左不变和右不变）的体积形式 $\omega$，使得 $\int_G\omega=1$。
这个体积形式可以构造一个双不变的 Haar 测度 $\d g$，满足对于任意连续函数 $f$，都有
$\int_G f\d g=\int_G f\omega$。

\begin{theorem}
  令 $G$ 是一个紧李群，那么 $G$ 的任意表示都是酉表示并且是完全可约的。
\end{theorem}
\begin{proof}
  令 $B(v,w)$ 是 $V$ 上的一个 Hermite 内积，将其平均化，定义
  \[
    \tilde{B}(v,w)=\int_G B(gv,gw)\d g.
  \]
  根据 Haar 测度的性质，$\tilde{B}$ 是一个 $G$-不变的 Hermite 内积，所以 $V$ 是酉表示。
\end{proof}

利用这个定理，紧李群的任意表示都可以写成不可约表示的直和
$V\simeq \bigoplus n_iV_i$，其中 $n_i\in \mathbb{Z}$，$V_i$ 是两两不同构的不可约表示。
下面我们研究如何构造这个直和分解。

令 $v_i$ 是 $V$ 的一组基，将映射 $\rho(g):V\to V$ 在这组基下
表示为矩阵 $\rho(g)=(\rho_{ij}(g))$。也就是说，我们考虑 $G$
上的标量函数 $\rho_{ij}:G\to \mathbb{C}$，这被称为矩阵系数。

\begin{theorem}\label{thm:orthogonality}
  \mbox{}
  \begin{enumerate}
    \item 令 $V,W$ 是 $G$ 的不同构的不可约表示。选取基 $v_i\in V\ (i=1,\dots,n)$
    和 $w_a\in W\ (a=1,\dots,m)$。那么矩阵系数 $\rho_{ij}^V$ 和 $\rho_{ab}^W$
    是正交的：$\langle \rho_{ij}^V,\rho_{ab}^W\rangle=0$，其中 $C^\infty(G,\mathbb{C})$
    上的内积定义为
    \[
      \langle f,h\rangle=\int_G f(g)\overline{h(g)}\d g.
    \]
    \item 令 $V$ 是 $G$ 的不可约表示。选取基 $v_i\in V$ 是一个
    相对于某个 $G$-不变内积的正交基。那么矩阵系数 $\rho_{ij}^V$ 是两两正交的
    并且每个的模长平方为 $1/{\dim V}$：
    \[
      \langle \rho_{ij}^V,\rho_{kl}^V\rangle=\frac{\delta_{ik}\delta_{jl}}{\dim V}.
    \]
  \end{enumerate}
\end{theorem}
\begin{proof}
  令 $v_i,w_a$ 分别是 $V$ 和 $W$ 的正交基。定义线性映射 $E_{ai}:V\to W$
  满足 $E_{ai}(v_i)=w_a$，并且 $E_{ai}(v_j)=0$ 对于 $j\neq i$。
  考虑函数
  \[
    f=\int_G\rho^W(g)E_{ai}\rho^V(g^{-1})\d g: V\to W.
  \]
  准确来说，$f$ 指的是线性映射 $\rho^W(g)E_{ai}\rho^V(g^{-1})$ 在给定基下
  的矩阵元逐点积分得到的线性映射。由于对于任意 $h\in G$，都有 
  那么任取 $h\in G$，由于 Haar 测度的左右不变性，所以
  \[
    \rho^W(h)f\rho^V(h^{-1})=\int_G \rho^W(hg)E_{ai}\rho^V(g^{-1}h^{-1})\d g
    =f,
  \]
  所以 $f$ 是 $G$-线性映射。根据 Schur 引理，$f=0$。又因为 $\rho$
  一定是酉表示，所以 $\rho(g^{-1})=\overline{\rho(g)^T}$，所以
  \[
    \int_G\rho^W(g)E_{ai}\overline{\rho^V(g)^T}\d g=0.
  \]
  那么对于任意 $(b,j)$-矩阵元，有
  \[
    \int_G \rho_{ba}^W(g)\overline{\rho_{ji}^V(g)}\d g=0,
  \]
  这就证明了在正交基情况下的第一点。对于一般的基，只需要使用
  基变换便可得出结论。

  对于第二点，只需要定义 $E_{ki}:V\to V$ 满足 $E_{ki}(v_i)=v_k$，
  并且 $E_{ki}(v_j)=0$ 对于 $j\neq i$。同样地，定义
  \[
    f=\int_G \rho^V(g)E_{ki}\rho^V(g^{-1})\d g: V\to V.
  \]
  根据 Schur 引理，$f=\lambda \mathrm{id}$。
  注意到 $\delta_{ki}=\mathrm{tr}\,E_{ki}=\mathrm{tr}\, f=\mathrm{tr}(\lambda \mathrm{id})=\lambda\dim V $。
  计算 $f$ 的 $(l,j)$-矩阵元，应该等于 $\lambda\delta_{lj}=\delta_{lj}\delta_{ki}/\dim V$，
  所以
  \[
    \int_G \rho_{lk}^V(g)\overline{\rho_{ji}^V(g)}\d g=
    \frac{\delta_{lj}\delta_{ki}}{\dim V}.\qedhere
  \]
\end{proof}

这表明不可约表示给出了一种构造群上函数的正交函数系的方法。
为了便于后续证明，我们也可以给出一种不依赖于基的描述。令
$v\in V$，$v^*\in V^*$，我们可以定义群上的函数 $\rho_{v^*,v}(g)$
为
\[
  \rho_{v^*,v}(g)=v^*\bigl(\rho(g)v\bigr).
\] 
如果给定一组基 $v_i$，取 $v=v_j$ 以及 $v^*=v_i^*$，那么
上述定义就得到矩阵系数 $\rho_{ij}(g)$。

于是，对于任意表示 $V$，有映射
\begin{align*}
  m:V^*\otimes V&\to C^\infty(G,\mathbb{C}) \\
  v^*\otimes v&\mapsto \rho_{v^*,v}.
\end{align*}
首先，可以注意到 $V^*\otimes V$ 是 $G$-双模，任取 $g_1,g_2\in G$，
作用为
\[
  (g_1,g_2)\cdot (v^*\otimes v)=(g_1 v^*)\otimes (g_2 v).
\]
此外，如果 $V$ 是酉表示，那么 $V$ 上的内积给出了 $V^*$ 上的内积，从而
$V^*\otimes V$ 上的内积定义为
\[
  \langle v_1^*\otimes w_1,v_2^*\otimes w_2\rangle
  =\frac{1}{\dim V}\langle v_1^*,v_2^*\rangle \langle w_1,w_2\rangle.
\]

\begin{theorem}
  令 $\widehat G$ 是 $G$ 的不可约表示的同构类集合，定义映射 
  \[
    m:\bigoplus_{V_i\in\widehat G}
    V_i^*\otimes V_i\to C^\infty(G,\mathbb{C})
  \]
  为 $m(v^*\otimes v)(g)=v^*\bigl(\rho(g)v\bigr)$。那么
  \begin{enumerate}
    \item $m$ 是 $G$-双模同态：
    \begin{gather*}
      m\bigl((gv^*)\otimes v\bigr)=L_g\bigl(m(v^*\otimes v)\bigr),\\
      m\bigl(v^*\otimes (gv)\bigr)=R_g\bigl(m(v^*\otimes v)\bigr).
    \end{gather*}
    其中 $L_g,R_g$ 分别是 $C^\infty(G,\mathbb{C})$ 上的左作用和右作用：
    $(L_gf)(h)=f(g^{-1}h)$，$(R_gf)(h)=f(hg)$。
    \item $m$ 保内积。
  \end{enumerate}
\end{theorem}
\begin{proof}
  (1) 直接计算得
  \begin{align*}
    \bigl(L_gm(v^*\otimes v)\bigr)(h)&=
    m(v^*\otimes v)(g^{-1}h)=v^*\bigl(\rho(g^{-1}h)v\bigr) \\
    &=(gv^*)\bigl(\rho(h)v\bigr)=m\bigl((gv^*)\otimes v\bigr)(h),
  \end{align*}
  另一个等式类似。

  (2) 直接利用定理 \ref{thm:orthogonality} 即可。
\end{proof}

\begin{corollary}
  映射 $m$ 是单射。
\end{corollary}

如果我们把直和进行适当的完备化，就可以得到 $m$ 还是一个满射，即：
群上的任意函数都可以被矩阵系数的线性组合逼近。这就是 Peter-Weyl 定理。

\begin{theorem}[Peter-Weyl 定理]
  令 $\widehat G$ 是 $G$ 的不可约表示的同构类集合，上述映射 
  \[
    m:\mathop{\widehat{\bigoplus}}_{V_i\in\widehat G}
    V_i^*\otimes V_i\to  L^2_{\mathbb{C}}(G)
  \]
  是同构映射。其中 $\widehat{\bigoplus}$ 是直和在 $L^2_{\mathbb{C}}(G)$
  空间中的闭包，$L^2_\mathbb{C}(G)$ 是 $G$ 相对于 Haar 测度的平方可积复函数空间。
\end{theorem}

令 $G=\mathbb{S}^1=\mathbb{R}/\mathbb{Z}$。$\mathbb{S}^1$ 上的
Haar 测度就是 $\d\theta$，并且 $G$ 的不可约表示可以由 $\mathbb{Z}$
记录为：对于每个 $k\in \mathbb{Z}$，有一维不可约表示 $V_k$ 附带
表示作用 $\rho_k(e^{2\pi i\theta})=e^{2\pi i k\theta}$。
因此，对应的矩阵系数函数就是 $\rho_k$ 本身。

那么定理 \ref{thm:orthogonality} 的正交性告诉我们
\[
  \int_0^1 e^{2\pi i k\theta}\overline{e^{2\pi i l\theta}}\d \theta
  =\delta_{kl}.
\]
于是 Peter-Weyl 定理告诉我们，任意平方可积函数 $f\in L^2_{\mathbb{C}}(\mathbb{S}^1)$
都可以被 $\{e^{2\pi i k\theta}\mid k\in \mathbb{Z}\}$ 的线性组合逼近。
这就是 Fourier 级数的内容。

\section{$\mathfrak{sl}(2,\mathbb{C})$ 和 $\mathfrak{so}(3)$ 的表示}

\begin{theorem}
  $\mathfrak{sl}(2,\mathbb{C})$ 的任意表示都是完全可约的。
\end{theorem}
\begin{proof}
  由于 $\mathfrak{sl}(2,\mathbb{C})$ 是 $\mathfrak{su}(2)$
  的复化，并且 $\SU(2)$ 是单连通的，所以 $\mathfrak{sl}(2,\mathbb{C})$
  的表示和紧李群 $\SU$(2) 的表示是一一对应的。根据前面的定理，$\SU(2)$
  的任意表示都是完全可约的，所以 $\mathfrak{sl}(2,\mathbb{C})$ 的任意表示也是完全可约的。
\end{proof}

回顾 $\mathfrak{sl}(2,\mathbb{C})$ 有基 $E,F,H$，满足对易关系
\[
  [H,E]=2E,\quad [H,F]=-2F,\quad [E,F]=H.
\]
对 $\mathfrak{sl}(2,\mathbb{C})$ 表示的研究的关键在于对角矩阵 $H$。

\begin{definition}
  令 $V$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的一个表示。向量 $v\in V$
  被称为是权 $\lambda\in \mathbb{C}$ 的，如果 $v$ 是 $H$
  的表示的特征值 $\lambda$ 的特征向量：即 $Hv=\lambda v$。
  我们记 $V[\lambda]\subseteq V$ 是权 $\lambda$ 的向量构成的子空间。
\end{definition}

\begin{lemma}
  我们有
  \begin{align*}
    EV[\lambda]&\subseteq V[\lambda+2], \\
    FV[\lambda]&\subseteq V[\lambda-2].
  \end{align*}
\end{lemma}
\begin{proof}
  任取 $v\in V[\lambda]$，那么 
  \[
    HEv=(EH+[H,E])v=E(Hv)+2Ev=(\lambda+2)Ev,
  \]
  所以 $Ev\in V[\lambda+2]$。类似地可以证明 $FV[\lambda]\subseteq V[\lambda-2]$。
\end{proof}

\begin{theorem}
  $\mathfrak{sl}(2,\mathbb{C})$ 的每个有限维表示 $V$ 都可以写为
  \[
    V=\bigoplus_\lambda V[\lambda],
  \]
  这个分解被称为 $V$ 的权分解。
\end{theorem}
\begin{proof}
  因为 $\mathfrak{sl}(2,\mathbb{C})$ 的每个表示都是完全可约的，所以
  我们可以假设 $V$ 是不可约的。令 $V'=\sum_\lambda V[\lambda]$
  是 $H$ 的所有特征空间的和。由于 $H$ 的不同特征值对应的特征向量
  是线性无关的，所以 $V'$ 是直和。根据前面的引理，$V'$ 在 
  $E,F,H$ 的作用下保持不变，所以是 $\mathfrak{sl}(2,\mathbb{C})$ 的子表示。
  而 $V'\neq 0$，$V$ 不可约，所以 $V'=V$。
\end{proof}

下面，令 $V$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的一个不可约表示。
令 $\lambda$ 是 $V$ 的一个权，并且在下面的意义上是最大的：
对于任意权 $\lambda'$，有 $\Re \,\lambda\geq \Re \lambda'$。
这样的权被称为最高权，向量 $v\in V[\lambda]$ 被称为最高权向量。

\begin{lemma}\label{lemma:sl2-highest-weight}
  令 $v\in V[\lambda]$ 是 $V$ 的一个最高权向量。
  \begin{enumerate}
    \item $Ev=0$。
    \item 令 $v^k=F^k v/k!\in V[\lambda-2k]$，其中 $k\geq 0$，那么
    \begin{align*}
      Hv^k&=(\lambda -2k)v^k, \\
      Fv^k&=(k+1)v^{k+1}, \\
      Ev^k&=(\lambda -k+1)v^{k-1}\ (k>0).
    \end{align*}
  \end{enumerate}
\end{lemma}
\begin{proof}
  由于 $Ev\in V[\lambda+2]$，而 $\lambda$ 是最高权，所以 $Ev=0$。
  对于第二点，$Fv^k$ 根据定义即可计算。由于 $Hv^k=HF^kv/k!$，
  又因为 $F^kv\in V[\lambda-2k]$，所以 $Hv^k=(\lambda -2k)F^kv/k!=(\lambda-2k)v^{k}$。
  对于 $Ev^k$。
  直接计算得 $k=1$ 的时候有
  \[
    Ev^1=EFv=[E,F]v+FEv=Hv+0=\lambda v.
  \]
  然后归纳得
  \begin{align*}
    Ev^{k+1}&=\frac{1}{k+1}EFv^k=\frac{1}{k+1}(Hv^k+FEv^k) \\
    &=\frac{1}{k+1}\left(
      (\lambda -2k)v^k+(\lambda -k+1)Fv^{k-1}
    \right)\\
    &=\frac{1}{k+1}\left(
      (\lambda -2k)v^k+(\lambda -k+1)kv^k
    \right) =(\lambda-k)v^k.\qedhere
  \end{align*}
\end{proof}

当 $V$ 是有限维的，只有有限多个 $v^k$ 不为零。但是，考虑 $V$
是有基 $v^k$ 的无限维空间的商更方便。

\begin{lemma}\label{lemma:sl2-verma}
  令 $\lambda\in \mathbb{C}$，定义 $M_\lambda$ 是有基 $v^0,v^1,\dots$
  的无限维向量空间。
  \begin{enumerate}
    \item 引理 \ref{lemma:sl2-highest-weight} 的法则定义了 $M_\lambda$
    上的一个 $\mathfrak{sl}(2,\mathbb{C})$-表示结构。
    \item 如果 $V$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的有限维不可约表示，
    其包含一个非零的最高权 $\lambda$ 的最高权向量，那么 $V=M_\lambda/W$，
    其中 $W$ 是 $M_\lambda$ 的一个子表示。
  \end{enumerate}
\end{lemma}
\begin{proof}
  (1) 直接利用引理 \ref{lemma:sl2-highest-weight} 的计算即可。
  (2) 令 $v\in V[\lambda]$ 是最高权向量，定义映射
  $\phi:M_\lambda\to V $ 为 $v^k\mapsto \frac{1}{k!}F^k v$，
  那么 $\phi$ 是 $\mathfrak{sl}(2,\mathbb{C})$-线性的并且是满射。
  所以 $V=M_\lambda/\ker\phi$。
\end{proof}

现在我们可以证明本节的主要定理。

\begin{theorem}
  \mbox{}
  \begin{enumerate}
    \item 对于任意 $n\geq 0$，令 $V_n$ 是基 $v^0,\dots,v^n$
    张成的有限维向量空间。定义 $\mathfrak{sl}(2,\mathbb{C})$ 的作用为
    \begin{equation}\label{eq:sl2-finite-rep}
      \begin{aligned}
        Hv^k&=(n-2k)v^k, \\
        Fv^k&=(k+1)v^{k+1}, \quad k<n; \  Fv^n=0, \\
        Ev^k&=(n-k+1)v^{k-1}, \quad k>0; \  Ev^0=0.
      \end{aligned}
    \end{equation}
    那么 $V_n$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的一个不可约表示，
    我们称为最高权为 $n$ 的表示。显然向量 $v^k$ 具有权 $n-2k$。
    \item 对于 $n\neq m$，表示 $V_n$ 和 $V_m$ 不同构。
    \item $\mathfrak{sl}(2,\mathbb{C})$ 的任意有限维不可约表示同构于某个 $V_n$。
  \end{enumerate}
\end{theorem}
\begin{proof}
  首先考虑无限维表示 $M_\lambda$。如果 $\lambda=n$ 是非负整数，
  考虑 $v^{n+1},v^{n+2},\dots$ 张成的子空间 $M'\subseteq M_n$。
  显然 $M'$ 在 $H$ 和 $F$ 的作用下保持不变。对于 $E$ 的作用，有
  $Ev^{n+1}=(n+1-(n+1))v^n=0\in M'$，所以 $M'$ 在
  $E$ 的作用下也保持不变，所以 $M'$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的子表示。

  因此，商空间 $M_n/M'$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的一个有限维表示。
  显然，其有基 $v^0,\dots,v^n$ 并且 $\mathfrak{sl}(2,\mathbb{C})$
  在基上的作用由 \eqref{eq:sl2-finite-rep} 给出。这个表示的不可约性容易证明：
  任意子表示都由 $v^0,\dots,v^n$ 的某个子集张成，但是很显然 $\mathfrak{sl}(2,\mathbb{C})$
  的作用可以从任意一个 $v^k$ 得到所有的 $v^0,\dots,v^n$。
  因此，$V_n$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的一个不可约有限维表示。
  因为 $\dim V_n=n+1$，所以 $V_n$ 是两两不同构的。

  为了证明任意不可约表示都有这种形式。令 $V$ 是 $\mathfrak{sl}(2,\mathbb{C})$
  的一个不可约表示，$v\in V[\lambda]$ 是最高权向量。那么引理 \ref{lemma:sl2-verma}
  表明 $V$ 是 $M_\lambda$ 的一个商。换句话说，其由 $v^k=(F^k/k!)v$ 张成。

  因为 $v^k$ 有不同的权，所以如果它们非零，那么一定是线性无关的。另一方面，
  $V$ 是有限维的，因此只有有限多个 $v^i$ 非零。令 $n$ 是最大的使得 $v^n\neq 0$
  的数，也即 $v^{n+1}=0$。显然，在 $v^0,\dots,v^n$ 全都非零的情况下，它们
  有不同的权，所以线性无关，所以构成 $V$ 的一组基。

  因为 $v^{n+1}=0$，所以必须有 $Ev^{n+1}=0$。另一方面，又有
  $Ev^{n+1}=(\lambda-n)v^n$，因为 $v^n\neq 0$，所以 $\lambda=n$
  是非负整数。因此，$V$ 必须有 (1) 中的形式。
\end{proof}

作为推论，我们也给出 $\mathfrak{sl}(2,\mathbb{C})$ 的任意有限维表示的一些有用的信息。

\begin{theorem}
  令 $V$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的有限维复表示。
  \begin{enumerate}
    \item $V$ 有一个整数权的权分解：
    \[
      V=\bigoplus_{n\in \mathbb{Z}} V[n].
    \]
    \item $\dim V[n]=\dim V[-n]$。此外，对于 $n\geq 0$，映射
    \[
      E^n: V[n]\to V[-n],\quad F^n: V[-n]\to V[n]
    \]
    是同构。
  \end{enumerate}
\end{theorem}
\begin{proof}
  由于 $V$ 是完全可约的，所以我们可以假设 $V$ 是不可约的。
  根据前面的定理，$V\simeq V_m$，其中 $m\geq 0$ 是某个整数。
  此时 $v^0$ 是权为 $m$ 的最高权向量，根据 \eqref{eq:sl2-finite-rep}，$V$ 的权分解为
  \[
    V=V[m]\oplus V[m-2]\oplus \cdots \oplus V[-m].
  \]
  这就证明了第一点。对于第二点，根据 \eqref{eq:sl2-finite-rep}，对于任意 $0\leq k\leq m$，
  都有
  \[
    E^{m-2k}v^k=(m-k+1)(m-k+2)\cdots (k+1)v^{m-k},
  \]
  所以 $E^{m-2k}:V[m-2k]\to V[2k-m]$ 是同构。类似地，$F^{m-2k}:V[2k-m]\to V[m-2k]$ 也是同构。
\end{proof}

下面我们可以研究 $\mathfrak{so}(3)$ 的表示。利用 $\mathfrak{su}(2)\to \mathfrak{so}(3)$
和 $\mathfrak{su}(2)_{\mathbb{C}}\to \mathfrak{sl}(2,\mathbb{C})$ 的同构，我们可以得出
$\mathfrak{so}(3)_{\mathbb{C}}\to \mathfrak{sl}(2,\mathbb{C})$ 的同构：
\[
  J_x\mapsto -\frac{i}{2}(E+F),\quad
  J_y\mapsto \frac{1}{2}(F-E),\quad
  J_z\mapsto -\frac{i}{2}H.
\]
于是 $\mathfrak{so}(3)_{\mathbb{C}}$ 的不可约表示与 $\mathfrak{sl}(2,\mathbb{C})$ 的不可约表示一一对应。
并且 $H$ 的特征值为整数 $n$ 对应于 $J_z$ 的特征值为 $-in/2$。于是 $\mathfrak{so}(3)_{\mathbb{C}}$
的任意有限维表示 $V$ 都有权分解
\[
  V=\bigoplus_{n\in \mathbb{Z}}V[n],
\]
其中 $V[n]$ 是 $J_z$ 的特征值为 $-in/2$ 的特征子空间。由于 $\mathfrak{so}(3)_{\mathbb{C}}$
是 $\mathfrak{so}(3)$ 的复化，所以 $\mathfrak{so}(3)$ 的表示与 $\mathfrak{so}(3)_{\mathbb{C}}$ 的表示
是一一对应的，也形如上面的权分解。

令 $\varphi:\SU(2)\to \SO(3)$ 是二重覆盖映射，那么 $\mathfrak{so}(3)$ 的表示 $\rho$ 如果能够
提升为 $\SO(3)$ 的表示 $\tilde \rho$，那么也可以提升为 $\SU(2)$ 的表示 $\tilde \rho\circ \varphi$。
于是必须有 $\tilde \rho\circ\varphi(-I)=\mathrm{id}_V$。考虑 $J_z$ 生成的单参数子群
$\gamma(t)=\exp(t J_z)$，当 $t=2\pi$ 的时候，$\gamma(2\pi)=I$。
$\varphi$ 诱导的李代数同构满足 $-\sigma_3/2i\mapsto J_z$，所以考虑 $\SU(2)$ 中的道路 $\tilde\gamma(t)=\exp(-t\sigma_3/2i)$，
那么 $\varphi\circ\tilde{\gamma}(t)=\exp(t J_z)=\gamma(t)$，于是
$\varphi\circ\tilde{\gamma}(2\pi)=\gamma(2\pi)=I$。也即 $\tilde{\gamma}(2\pi)$
表示三维空间中绕 $z$ 轴旋转 $2\pi$，由于 $\varphi$ 的 $2:1$ 映射关系，所以 $\tilde{\gamma}(2\pi)=-I$。
注意到 $\tilde{\rho}\circ\varphi$ 是 $\SU(2)$ 的表示，所以
\[
  \mathrm{id}_V=\tilde \rho\circ\varphi(-I)= \tilde{\rho}\circ\varphi(\exp(-\pi\sigma_3/i))=\exp(2\pi\rho(J_z)),
\]
前面已经说明 $\rho(J_z)$ 在 $V[n]$ 上的特征值为 $-in/2$，所以对于任意 $v\in V[n]$，有
\[
  \exp(2\pi \rho(J_z))v=\exp\left(2\pi \cdot -\frac{in}{2}\right)v=(-1)^n v,
\]
因此 $n$ 必须为偶数，才可能使得 $\rho$ 能够提升为 $\SO(3)$ 的表示。于是我们得到下面的
关于 $\mathfrak{so}(3)$ 的表示的定理。

\begin{theorem}\label{thm:so3-rep}
  $\mathfrak{so}(3)$ 的任意有限维表示 $V$ 都有权分解
  \[
    V=\bigoplus_{n\in \mathbb{Z}} V[n],
  \]
  其中 $V[n]$ 是 $J_z$ 的特征值为 $in/2$ 的特征子空间。
  \begin{enumerate}
    \item $\dim V[n]=\dim V[-n]$。此外，对于 $n\geq 0$，映射
    \[
      (J_x+iJ_y)^n: V[n]\to V[-n],\quad (J_x - iJ_y)^n: V[-n]\to V[n]
    \]
    是同构。
    \item 表示 $V$ 能够提升为 $\SO(3)$ 的表示，当且仅当 $V[n]=0$ 对于所有奇数 $n$。
  \end{enumerate}
\end{theorem}




\section{球面上的 Laplace 算子}

在本节，我们应用李群和李代数的表示理论来研究球面 $\mathbb{S}^2$ 上的 Laplace 算子，
这是一个使用表示论研究系统对称性的典型例子。

令 $\Delta=\partial^2/\partial x^2+\partial^2/\partial y^2+\partial^2/\partial z^2$
是 $\mathbb{R}^3$ 上的 Laplace 算子。我们将其分为“径向部分”和“球面部分”。

在球坐标系 $(r,\theta,\varphi)$ 下，Laplace 算子有分解
\[
  \Delta=\Delta_{\mathbb{R}_+}
  +\frac{1}{r^2}\Delta_{\mathbb{S}^2},
\]
具体形式如 \eqref{eq:laplace-spherical} 式所示：
\begin{align*}
  \Delta_{\mathbb{R}_+}&=\frac{\partial^2}{\partial r^2}+\frac{2}{r}\frac{\partial}{\partial r}, \\
  \Delta_{\mathbb{S}^2}&=\frac{1}{\sin\theta}\frac{\partial}{\partial \theta}\left(
    \sin\theta \frac{\partial}{\partial \theta}
  \right)
  +\frac{1}{\sin^2\theta}\frac{\partial^2}{\partial \varphi^2}.
\end{align*}
接下来重点关注球面部分 $\Delta_{\mathbb{S}^2}$。


回顾 $\mathfrak{so}(3)$ 的一组基为
\[
  J_x=\begin{pmatrix}
    0 & 0 & 0 \\
    0 & 0 & -1 \\
    0 & 1 & 0
  \end{pmatrix},\quad
  J_y=\begin{pmatrix}
    0 & 0 & 1 \\
    0 & 0 & 0 \\
    -1 & 0 & 0
  \end{pmatrix},\quad
  J_z=\begin{pmatrix}
    0 & -1 & 0 \\
    1 & 0 & 0 \\  
    0 & 0 & 0
  \end{pmatrix}.
\]
考虑 $\SO(3)$ 在 $\mathbb{R}^3$ 上的自然作用 $(A,x)\mapsto Ax$。
对于任意 $X\in \mathfrak{so}(3)$，这诱导了 $\mathbb{R}^3$ 上的向量场
\[
  X_p^\# =\frac{d}{dt}\bigg|_{t=0}\exp(tX)p=Xp,
\]
于是 $J_x,J_y,J_z$ 分别诱导了向量场
\[
  J_x^\#=y\frac{\partial}{\partial z}-z\frac{\partial}{\partial y},\quad
  J_y^\#=z\frac{\partial}{\partial x}-x\frac{\partial}{\partial z},\quad
  J_z^\#=x\frac{\partial}{\partial y}-y\frac{\partial}{\partial x}.
\]
滥用符号，我们仍然记这些向量场为 $J_x,J_y,J_z$。实际上可以检验 $X\mapsto X^\#$
给出了 $\mathfrak{so}(3)\to \mathfrak{X}(\mathbb{R}^3)$ 的李代数的反同态。
此时向量场 $J_x,J_y,J_z$ 在球坐标系下的表达式为
\begin{align*}
  J_x&=-\sin\varphi \frac{\partial}{\partial \theta}
  -\cot\theta \cos\varphi \frac{\partial}{\partial \varphi}, \\
  J_y&=\cos\varphi \frac{\partial}{\partial \theta}
  -\cot\theta \sin\varphi \frac{\partial}{\partial \varphi}, \\
  J_z&=\frac{\partial}{\partial \varphi}.
\end{align*}
直接计算得
\begin{align*}
  J_x^2&=\left(\sin\varphi \frac{\partial}{\partial \theta}
  +\cot\theta \cos\varphi \frac{\partial}{\partial \varphi}\right)\left(\sin\varphi \frac{\partial}{\partial \theta}
  +\cot\theta \cos\varphi \frac{\partial}{\partial \varphi}\right)\\
  &=\sin^2\varphi \frac{\partial^2}{\partial \theta^2}
  +\sin\varphi \cos\varphi \cot\theta \frac{\partial^2}{\partial \theta\partial \varphi}
  -\sin\varphi\cos\varphi\csc^2\theta\frac{\partial}{\partial\varphi}\\
  &\quad 
  +\sin\varphi \cos\varphi \cot\theta \frac{\partial^2}{\partial \varphi\partial \theta}
  +\cos^2\varphi\cot\theta\frac{\partial}{\partial\theta}\\
  &\quad +\cot^2\theta\cos^2\varphi \frac{\partial^2}{\partial \varphi^2}
  -\cot^2\theta \sin\varphi\cos\varphi \frac{\partial}{\partial \varphi},
\end{align*}
同理有
\begin{align*}
  J_y^2&=\cos^2\varphi \frac{\partial^2}{\partial \theta^2}
  -\sin\varphi \cos\varphi \cot\theta \frac{\partial^2}{\partial \theta\partial \varphi}
  +\sin\varphi\cos\varphi\csc^2\theta\frac{\partial}{\partial\varphi}\\
  &\quad 
  -\sin\varphi \cos\varphi \cot\theta \frac{\partial^2}{\partial \varphi\partial \theta}
  +\sin^2\varphi\cot\theta\frac{\partial}{\partial\theta}\\
  &\quad +\cot^2\theta\sin^2\varphi \frac{\partial^2}{\partial \varphi^2}
  +\cot^2\theta \sin\varphi\cos\varphi \frac{\partial}{\partial \varphi},
\end{align*}
所以
\begin{align*}
  J_x^2+J_y^2+J_z^2&=\frac{\partial^2}{\partial \theta^2}
  +\cot\theta \frac{\partial}{\partial \theta}
  +\cot^2\theta \frac{\partial^2}{\partial \varphi^2}+\frac{\partial^2}{\partial \varphi^2}\\
  &=\frac{1}{\sin\theta}\frac{\partial}{\partial \theta}\left(
    \sin\theta \frac{\partial}{\partial \theta}
  \right)
  +\frac{1}{\sin^2\theta}\frac{\partial^2}{\partial \varphi^2}=\Delta_{\mathbb{S}^2}.
\end{align*}
这表明，球面部分的 Laplace 算子可以用 $\mathfrak{so}(3)$ 的基表示为
\[
  \Delta_{\mathbb{S}^2}=J_x^2+J_y^2+J_z^2.
\]
$\Delta_{\mathbb{S}^2}$ 可以视为 $C^\infty(\mathbb{S}^2)\to C^\infty(\mathbb{S}^2)$
的线性映射，我们需要寻找 $\Delta_{\mathbb{S}^2}$ 的特征值和特征向量。
前面已经介绍过通过解微分方程的方法研究这一点，从而导出了球面谐函数。
现在我们使用表示论的方法来研究这个问题。首先我们需要利用 $\mathbb{S}^2$
的对称性。考虑群 $\SO(3)$ 在球面 $\mathbb{S}^2$ 上的自然作用，这导出了
$\SO(3)$ 在 $C^\infty(\mathbb{S}^2)$ 上的作用，定义为 $(g\cdot f)(x)=f(g^{-1}x)$。
因此 $C^\infty(\mathbb{S}^2)$ 可以作为 $\SO(3)$ 的一个表示空间，
表示作用为 $g\mapsto (f\mapsto f \circ g^{-1})$。


\begin{lemma}
  $\Delta_{\mathbb{S}^2}:C^\infty(\mathbb{S}^2)\to C^\infty(\mathbb{S}^2)$ 
  与 $\SO(3)$ 的作用交换。
\end{lemma}
\begin{proof}
  可以通过求导直接计算得到结论，但是为了更好地理解表示论的观点，我们使用李代数的方法来证明，
  需要用到一些泛包络代数的知识。
  首先证明对于 $\mathfrak{so} (3)$ 的任意表示 $V$，算子 $C=\rho(J_x)^2+\rho(J_y)^2+\rho(J_z)^2$
  与 $\mathfrak{so}(3)$ 的作用交换，也即任取 $X\in \mathfrak{so}(3)$，都有 $[\rho(X),C]=0$。
  此时分别取 $X$ 为基 $J_x,J_y,J_z$ 即可。以 $X=J_x$ 为例，有
  \begin{align*}
    [J_x,J_x^2+J_y^2+J_z^2]&=[J_x,J_x^2]+[J_x,J_y^2]+[J_x,J_z^2] \\
    &=0 + [J_x,J_y^2]+[J_x,J_z^2],
  \end{align*}
  利用恒等式 $[A,BC]=[A,B]C+B[A,C]$，有
  \[
    [J_x,J_y^2]=[J_x,J_y]J_y+J_y[J_x,J_y]=J_z J_y + J_y J_z,
  \]
  同理，有
  \[
    [J_x,J_z^2]=[J_x,J_z]J_z + J_z[J_x,J_z]=-J_y J_z - J_z J_y,
  \]
  所以
  \[
    [J_x,J_x^2+J_y^2+J_z^2]=0.
  \]
  需要注意，上述出现的所有乘法并不是在李代数 $\mathfrak{so}(3)$ 中的矩阵乘法，而是泛包络代数中的形式乘法。
  于是对于任意李代数表示 $\rho$ 和 $X\in \mathfrak{so}(3)$，有
  \[
    [\rho(X),C]=\rho[X,J_x^2+J_y^2+J_z^2]=0.
  \]
  这意味着 $C$ 属于结合代数 $\mathfrak{gl}(V)$ 的中心。

  对于任意 $\SO(3)$ 的表示 $\pi$，假设其对应李代数表示为 $\rho$，那么有关系
  $\pi\circ \exp =\exp \circ \rho$。此时，任取 $g\in \SO(3)$，设 $g=\exp X$，那么
  \begin{align*}
    \pi(g)C&=\pi(\exp X)C=\exp(\rho(X))C=\sum_{k=0}^\infty \frac{1}{k!}\rho(X)^k C \\
    &=\sum_{k=0}^\infty \frac{1}{k!}C \rho(X)^k =C\exp(\rho(X))=C\pi(g).
  \end{align*}
  取 $V=C^\infty(\mathbb{S}^2)$，$\pi(g)f=f\circ g^{-1}$，那么
  $\rho(X)=-X^\#$，这就证明了 $\Delta_{\mathbb{S}^2}$ 与 $\SO(3)$ 的作用交换。
\end{proof}
 
这意味着 $\Delta_{\mathbb{S}^2}$ 是 $\SO(3)$-线性映射，所以其与 $\SO(3)$ 的表示之间有着密切的联系。
注意，为了应用表示论的结论 ，这里我们考虑的是复值函数空间 $C^\infty(\mathbb{S}^2)$。
但是，由于 $C^\infty(\mathbb{S}^2)$ 是无限维的，我们无法直接使用前面介绍的有限维表示论的结果 (例如 Schur 引理)。
为了克服这个困难，我们考虑多项式函数的子空间 $P_n$，即所有 $\mathbb{S}^2$ 上的次数小于等于 $n$
的复值三元多项式函数构成的空间。

显然每个 $P_n$ 都是 $\SO(3)$ 的有限维表示，并且是 $\Delta_{\mathbb{S}^2}$-不变的（也即 $\Delta_{\mathbb{S}^2}$
不会升高多项式的次数）。于是我们考虑 $P_n$ 作为 $\SO(3)$ 的表示空间。因此，我们可以使用有限维表示论将 $P_n$ 分解成不可约表示，然后利用这一点寻找
$\Delta_{\mathbb{S}^2}$ 在 $P_n$ 中的特征值。因为 $\bigcup_n P_n=P$ 是多项式函数空间，其在
$C^\infty(\mathbb{S}^2)$ 中稠密，所以研究 $\Delta_{\mathbb{S}^2}$ 在 $P$ 中的对角化
等价于研究其在 $C^\infty(\mathbb{S}^2)$ 中的对角化。

因此，我们的目标是将 $P_n$ 分解成 $\SO(3)$ 的不可约表示的直和。根据定理 \ref{thm:so3-rep}，我们知道 $\SO(3)$ 的不可约表示
必然形如 $V_{2k}$，因此，我们有分解
\[
  P_n=\bigoplus c_k V_{2k}.
\]
为了寻找重数 $c_k$，我们需要研究 $J_z$ 的特征空间。

\begin{lemma}
  下面的函数构成 $P_n$ 的一组基：
  \[
    f_{p,k}=z^p\bigl(\sqrt{1-z^2}\bigr)^{|k|}e^{ik\varphi},
    \quad p\in \mathbb{Z}_{\geq 0}, k\in \mathbb{Z},p+|k|\leq n,
  \]
  其中 $\varphi$ 是 $xy$-平面中的方位角，满足 $x=\rho\cos\varphi, y=\rho\sin\varphi,\rho=\sqrt{x^2+y^2}$。
\end{lemma}
\begin{proof}
  令 $u=x+iy=\rho e^{i\varphi},v=x-iy=\rho e^{-i\varphi}$。
  显然，任意三元多项式 $P(x,y,z)$ 都可以写成 $P(u,v,z)$ 的形式。
  而在球面上，我们有 $1-z^2=x^2+y^2=uv$，所以每个单项式 $z^ku^lv^m$
  都可以被写为仅涉及 $z,u$ 或者 $z,v$ 的形式。因此，$P_n$ 的每个元素
  都可以写为下述单项式的线性组合：
  \begin{align*}
    &z^p,\\
    &z^pu^k=z^p\rho^k e^{ik\varphi}=f_{p,k},\\
    &z^pv^k=z^p\rho^k e^{-ik\varphi}=f_{p,-k},
  \end{align*}
  其中 $p,k\in \mathbb{Z}_+$，且 $p+k\leq n$。因此 $\{f_{p,k}\}$
  张成 $P_n$。

  然后说明这些函数线性无关。假设
  \[
    \sum a_{p,k}f_{p,k}=\sum_k a_k(z) e^{ik\varphi}=0,\quad
    a_k(z)=\sum_p a_{p,k} z^p \bigl(\sqrt{1-z^2}\bigr)^{|k|}.
  \]
  根据 Fourier 级数的唯一性，对于每个 $k\in \mathbb{Z}$ 和 $z\in (-1,1)$，
  我们有 $a_k(z)=0$，所以 $a_k(z)$ 在 $(-1,1)$ 上有无穷多个零点。
  由于 $a_k(z)$ 是一个多项式，所以只能有有限多个零点，因此只能是零多项式。
  这说明对于每个 $k$，都有 $a_{p,k}=0$，所以这些函数线性无关。
\end{proof}

现在我们可以寻找 $J_z$ 的特征空间的维数。因为 $J_z$ 是绕 $z$ 轴旋转的
无穷小生成元，所以考虑柱坐标 $z,\rho,\varphi$ 更加方便，此时 $J_z=\partial/\partial \varphi$。
因此，我们有 
\[
  J_z f_{p,k}=ik f_{p,k},
\]
于是 $J_z$ 的特征值是 $ik$，这对应 $H$ 的权为 $2k$，所以权空间 $P_n[2k]$ 由 $\{f_{p,k}\}_{0\leq p\leq n-|k|}$ 张成，因此
$\dim P_n[2k]=n+1-|k|$。为了得到重数 $c_k$，我们需要下面的引理。

\begin{lemma}
  若 $V$ 是 $\mathfrak{sl}(2,\mathbb{C})$ 的有限维表示，那么 $V\simeq \bigoplus n_kV_k$，
  并且 $n_k=\dim V[k]-\dim V[k+2]$。此外，还有 $\sum n_{2k}=\dim V[0]$，
  $\sum n_{2k+1}=\dim V[1]$。
\end{lemma}
\begin{proof}
  设 $V$ 分解为不可约表示的直和
  \[
    V\simeq \bigoplus_k n_k V_k.
  \]
  其中每个 $V_k$ 的权空间 $V_k[j]$ 的维数为
  \[
    \dim V_k[j]=
    \begin{cases}
      1, & j=k,k-2,\dots,-k; \\
      0, & \text{其他}.
    \end{cases}
  \]
  因此，$V$ 的权空间 $V[j]$ 的维数为
  \[
    \dim V[j]=\sum_{k\geq j,\,2\mid (k-j)} n_k
    =n_{j}+n_{j+2}+n_{j+4}+\cdots,
  \]
  所以
  \[
    \dim V[j]-\dim V[j+2]=n_j.
  \]
  取 $j=0$ 和 $j=1$ 即得其余的结论。
\end{proof}

回到 $\SO(3)$ 的表示空间 $P_n$ 上来，已经求得 $\dim P_n[2k]=n+1-|k|$，
那么重数 $c_k=(k+1)-k=1$，因此 $P_n$ 有分解
\[
  P_n\simeq V_0\oplus V_2 \oplus V_4 \oplus \cdots \oplus V_{2n}.
\]
现在寻找 $\Delta_{\mathbb{S}^2}$ 在 $P_n$ 上的特征值就变得十分简单。

由于 $\Delta_{\mathbb{S}^2}$ 是 $\SO(3)$-线性映射，根据 Schur 引理，
$\Delta_{\mathbb{S}^2}$ 在每个不可约表示 $V_{2m}$ 上是一个标量乘法算子。
为了确定这个标量，我们只需要计算 $\Delta_{\mathbb{S}^2}$ 在最高权向量 $v^0$
上的作用。我们先把 $\Delta_{\mathbb{S}^2}=J_x^2+J_y^2+J_z^2$ 
写成 $E,F,H$ 的形式：
\[
  J_x^2+J_y^2=\left(\frac{E+F}{2i}\right)^2+\left(\frac{F-E}{2}\right)^2
  =\frac{(F-E)^2-(E+F)^2}{4}=-\frac{1}{2}(EF+FE),
\]
因此
\[
  \Delta_{\mathbb{S}^2}=-\frac{1}{2}(EF+FE)-\frac{H^2}{4}=
  -\frac{1}{2}\left(EF+FE+\frac{H^2}{2}\right).
\]
在最高权向量 $v^0$ 上，有 $Ev^0=0$, $Fv^0=v^1$, $Hv^0=2m v^0$，所以
\[
  \Delta_{\mathbb{S}^2}v^0
  =-\frac{1}{2}\left(2mv^0 + 0+ \frac{(2m)^2}{2}v^0\right)
  = -m(m+1)v^0.
\]
这表明 $\Delta_{\mathbb{S}^2}$ 在 $V_{2m}$ 上的特征值为 $-m(m+1)$。
综上所述，我们得到了下面的定理。

\begin{theorem}
  $P_n$ 中的球面 Laplace 算子 $\Delta_{\mathbb{S}^2}$ 的特征值为
  \[
    \lambda_k=-k(k+1),\quad k=0,1,\dots,n,
  \]
  并且 $\lambda_k$ 对应的特征空间的维数为 $\dim V_{2k}=2k+1$。
\end{theorem}

我们也可以显式地写出 $V_{2k}$ 的基向量 $v^0,\dots,v^{2k}$ 对应的多项式函数。
由于 $J_zf_{p,k}=ik f_{p,k}$，所以 $v^0$ 对应于 $f_{p,k}$ 中的一个。
最高权向量 $v^0$ 还满足 $Ev^0=0$，也即 $f_{p,k}$ 需要满足
\[
  (J_x + i J_y)f_{p,k}=0,
\]
也即
\[
  \left(
    z\left(i\frac{\partial}{\partial x}-\frac{\partial}{\partial y}\right)
    +(y-ix)\frac{\partial}{\partial z}
  \right)\left(
    z^p(x+iy)^k
  \right)=0,
\]
简单计算可得 $p=0$，所以 $v^0$ 对应于多项式函数 $f_{0,k}=(x+iy)^k$，
使用球坐标系并注意到 $r=1$，也即 $f_{0,k}=\sin^k\theta e^{ik\varphi}$，
这就是球谐函数 $Y_k^k(\theta,\varphi)$ (忽略归一化常数)。
要得到其余的球谐函数，只需要依次作用 $F$ 计算 $v^1,\dots,v^{2k}$
即可。由于 $F$ 对应于 $J_y+iJ_x$，所以 $v^1$ 对应于多项式函数
\begin{align*}
  (J_y+iJ_x)f_{0,k}&=\left(
    \left(z\frac{\partial}{\partial x}-x\frac{\partial}{\partial z}\right)
    +i\left(y\frac{\partial}{\partial z}-z\frac{\partial}{\partial y}\right)
  \right)(x+iy)^k \\
  &=\left(k z (x+iy)^{k-1}
  +kz(x+iy)^{k-1}\right) \\ 
  &=2k z (x+iy)^{k-1}=2k f_{1,k-1},
\end{align*}
这正好对应于球谐函数 (忽略归一化常数) 
\[
  Y_k^{k-1}(\theta,\varphi)=\cos\theta \sin^{k-1}\theta e^{i(k-1)\varphi}.
\]
以此类推，可以得到所有的球谐函数。
总的来说，$V_{2k}$ 的基向量 $v^0,\dots,v^{2k}$ 对应的多项式函数为
$f_{0,k},f_{1,k-1},\dots,f_{2k,-k}$。然后让 $k$ 从 $0$ 取到 $n$，
就得到了 $P_n$ 的一组由齐次多项式构成的基。再进行正交化便可得到
球谐函数的表达式。
最后，我们说明 $C^\infty(\mathbb{S}^2)$ 中的特征函数必为多项式函数，
从而完成对 $\Delta_{\mathbb{S}^2}$ 的刻画。

\begin{theorem}
  $\Delta_{\mathbb{S}^2}$ 的每个特征函数都是多项式。
\end{theorem}
\begin{proof}
  考虑平方可积空间 $L_{\mathbb{C}}^2(\mathbb{S}^2)$，因为 $\SO(3)$
  的作用保体积形式，所以保 $L_{\mathbb{C}}^2(\mathbb{S}^2)$ 中的内积。
  这表明算子 $J_x,J_y,J_z$ 是反 Hermite 算子，所以 $\Delta_{\mathbb{S}^2}$ 是自伴的。

  令 $E_n\subseteq P_n$ 是 $P_{n-1}$ 的正交补，那么 $E_n$ 也是 $\SO(3)$ 不变的。
  由于 $P_n\simeq V_0\oplus V_2\oplus\cdots\oplus V_{2n}$，所以 $E_n\simeq V_{2n}$，
  所以 $\Delta_{\mathbb{S}^2}$ 作用在 $E_n$ 上是单位算子的 $\lambda_n=-n(n+1)$
  倍。另一方面，因为多项式空间在 $L^2$ 中稠密，所以有 Hilbert 直和分解
  \[
    L^2_{\mathbb{C}}(\mathbb{S}^2)=\bigoplus_{n\geq 0}E_n.
  \]
  如果 $f\in C^\infty(\mathbb{S}^2)$ 使得 $\Delta_{\mathbb{S}^2}f=\lambda f$，
  那么要么对于所有的 $n$ 都有 $\lambda\neq \lambda_n$，这表明 $\langle f,E_n\rangle =0$，
  即 $f=0$，要么存在某个 $n$ 使得 $\lambda=\lambda_n$，这表明 $f\in E_n$。
\end{proof}

\nocite{*}
\printbibliography















\end{document}