\documentclass[fontset=none]{Notes}

\makeatletter
\DeclareRobustCommand{\em}{%
  \@nomath\em \if b\expandafter\@car\f@series\@nil
  \normalfont \else \bfseries \fi}
\makeatother

\usepackage{tikz-cd,wrapstuff}
\usepackage{fixdif,siunitx,tikz,nicematrix}
\usetikzlibrary{matrix,calc}

\input{font.def}

\usepackage[subscriptcorrection,nofontinfo,mtpbb,mtpfrak]{mtpro2}

\tikzcdset{
  arrow style=tikz,
  diagrams={>={Straight Barb[scale=0.8]}}
}

\allowdisplaybreaks[1]

\newlength{\mymathln}
\newcommand{\aligninside}[2]{
  \settowidth{\mymathln}{#2}
  \mathmakebox[\mymathln]{#1}
}

\DeclareMathOperator\Spec{Spec}
\DeclareMathOperator\im{im}
\DeclareMathOperator\nil{nil}
\DeclareMathOperator\rad{rad}
\DeclareMathOperator\Ann{Ann}
\DeclareMathOperator\Max{Max}
\DeclareMathOperator\GL{GL}
\DeclareMathOperator\End{End}
\DeclareMathOperator\Int{Int}
\DeclareMathOperator\Tor{Tor}
\DeclareMathOperator\Frac{Frac}
\DeclareMathOperator\Tr{Tr}
\DeclareMathOperator\Hom{Hom}
\DeclareMathOperator\supp{supp}
\DeclareMathOperator\Id{Id}
\DeclareMathOperator\rk{rank}
\DeclareMathOperator\coker{coker}

\newcommand{\ideal}[1]{\mathfrak{#1}}
\newcommand{\mat}[1]{\mathbold{#1}}
\newcommand{\uline}{\underline{\hphantom{X}}}
\newcommand{\abs}[1]{\left|#1\right|}

\usepackage{enumitem}

\setlist[enumerate]{nosep}

%\DeclareMathAlphabet\mathcal{OMS}{cmsy}{m}{n}

\newlength\stextwidth
\newcommand\makesamewidth[3][c]{%
  \settowidth{\stextwidth}{#2}%
  \makebox[\stextwidth][#1]{#3}%
}



\begin{document}

\frontmatter

\tableofcontents

\mainmatter

\chapter{测度和积分}

\section{可测空间}

令 $E$ 是集合，$\mathcal{E}$ 是 $E$ 的一个子集族。若对于任意 $A,B\in\mathcal{E}$ 有
$A\cap B\in\mathcal{E}$，那么我们说 $\mathcal{E}$ \emph{对交封闭}。如果 $\mathcal{E}$
中任意可数个集合的交还在 $\mathcal{E}$ 中，那么我们说 $\mathcal{E}$ 对可数交封闭。
类似地，我们可以定义对补封闭、对并封闭和对可数并封闭的概念。

\subsubsection{$\sigma$-代数}

如果 $E$ 的非空子集族 $\mathcal{E}$ 对补和有限并封闭，那么我们说 $\mathcal{E}$
是 $E$ 上的\emph{代数}。如果其对补和可数并封闭，那么我们说 $\mathcal{E}$
是 $E$ 上的\emph{$\sigma$-代数}，即：
\begin{alphenum}
  \item $A\in\mathcal{E}\Rightarrow E\smallsetminus A\in\mathcal{E}$，
  \item $A_1,A_2,\dotsc\in \mathcal{E}\Rightarrow\bigcup_n A_n\in\mathcal{E}$。
\end{alphenum}
由于 $\left(\bigcup_n A_n\right)^c=\bigcap_n A_n^c\in\mathcal{E}$，所以对补和可数并封闭
可以自然导出对可数交封闭，即 $\sigma$-代数对可数交也封闭。

任取 $A\in \mathcal{E}$，那么 $E=A\cup(E \smallsetminus A)\in \mathcal{E}$，所以 $E$ 上
任意 $\sigma$-代数都至少包含 $E$ 和 $\emptyset$。事实上，$\mathcal{E}=\{E,\emptyset\}$
是 $E$ 上的最简单的 $\sigma$-代数，被称为\emph{平凡 $\sigma$-代数}。$E$ 上最大的
$\sigma$-代数当然是 $\mathcal{E}=2^E$，即 $\mathcal{E}$ 就是 $E$ 的幂集，被
称为\emph{离散 $\sigma$-代数}。

不难看出，$E$ 上一族 $\sigma$-代数的任意交(不一定可数)还是 $E$ 上的 $\sigma$-代数。
给定 $E$ 的一个子集族 $\mathcal{C}$，我们可以考虑所有包含 $\mathcal{C}$ 
的 $\sigma$-代数(总是存在至少一个这样的 $\sigma$-代数，即 $2^E$)，将这些
$\sigma$-代数取交集，我们便得到了包含 $\mathcal{C}$ 的最小的 $\sigma$-代数，
被称为\emph{由 $\mathcal{C}$ 生成的} $\sigma$-代数，记为 $\sigma\mathcal{C}$。

如果 $E$ 是拓扑空间，由 $E$ 的所有开集族生成的 $\sigma$-代数被称为 $E$ 上的
\emph{Borel $\sigma$-代数}，记为 $\mathcal{B}(E)$ 或者 $\mathcal{B}_E$，
其元素被称为\emph{Borel 集}。

\subsubsection{p-系和 d-系}

对于 $E$ 的子集族 $\mathcal{C}$，如果其对交封闭，那么我们说 $\mathcal{C}$
是一个 p-系，这里 p 代表 product，是“交”的另一种说法。
$E$ 的子集族 $\mathcal{D}$ 被称为 d-系，如果其满足：
\begin{alphenum}
  \item $E\in\mathcal{D}$，
  \item $\text{$A,B\in \mathcal{D}$ and $A\supseteq B\Rightarrow A \smallsetminus B\in \mathcal{D}$}$，
  \item $\text{$(A_n)\subseteq \mathcal{D}$ and $A_n\nearrow A\Rightarrow A\in \mathcal{D}$}$。
\end{alphenum}
其中 $(A_n)\subseteq D$ 表明 $(A_n)$ 是 $D$ 中的集合序列，$A_n\nearrow A$ 表明这个序列
递增于极限 $A$：
\[
  A_1\subseteq A_2\subseteq\cdots,\quad \bigcup_{n=1}^\infty A_n=A.
\]

显然一个 $\sigma$-代数既是 p-系又是 d-系，其反面也是成立的。所以 p-系和 d-系是产生
$\sigma$-代数的原始结构。

\begin{proposition}\label{prop:equivalent condition of sigma algebra}
  $E$ 的子集族是 $\sigma$-代数当且仅当其既是 p-系又是 d-系。
\end{proposition}
\begin{proof}
  $(\Rightarrow)$ 若 $\mathcal{E}$ 是 $\sigma$-代数，其显然是 p-系并且满足 d-系的条件 (a) 和 (c)。
  下面我们验证其满足 d-系的条件 (b)。任取 $A,B\in\mathcal{E}$ 且 $A\supseteq B$，
  那么 $A \smallsetminus B=A\cap (E \smallsetminus B)\in \mathcal{E}$，
  所以 $\mathcal{E}$ 是 d-系。

  $(\Leftarrow)$ 若 $\mathcal{E}$ 既是 p-系又是 d-系。任取 $A\in \mathcal{E}$，
  根据 d-系的 (a) 和 (b)，我们有 $E \smallsetminus A\in \mathcal{E}$。
  所以 $\mathcal{E}$ 对补封闭。然后我们说明对并封闭。任取 $A,B\in \mathcal{E}$， 
  由于
  \[
    A\cup B=E \smallsetminus (A\cup B)^c=E \smallsetminus (A^c\cap B^c),
  \]
  结合 p-系对交封闭，所以 $A\cup B\in \mathcal{E}$。最后我们说明对可数并封闭。
  如果 $(A_n)\subseteq \mathcal{E}$，令 $B_n=A_1\cup\cdots\cup A_n$，
  那么 $(B_n)\subseteq \mathcal{E}$ 且 $B_n\nearrow A$，根据 d-系的 (c)，所以
  $A\in \mathcal{E}$，故 $\mathcal{E}$ 对可数并封闭。
\end{proof}

下面的引理为本节的主要定理做准备。

\begin{lemma}\label{lemma:hat D}
  令 $\mathcal{D}$ 是 $E$ 上的 d-系，固定 $D\in \mathcal{D}$，令
  \[
    \hat{\mathcal{D}}=\{A\in \mathcal{D}: A\cap D\in \mathcal{D}\},
  \]
  那么 $\hat{\mathcal{D}}$ 仍然是 d-系。
\end{lemma}

\subsubsection{单调类定理}

这是一个非常有用的工具来证明某些集族是 $\sigma$-代数。

\begin{theorem}
  如果一个 d-系包含一个 p-系，那么其包含这个 p-系生成的 $\sigma$-代数。
\end{theorem}
\begin{proof}
  设 $\mathcal{C}$ 是一个 p-系。令 $\mathcal{D}$ 是包含 $\mathcal{C}$
  的最小的 d-系，即包含 $\mathcal{C}$ 的所有 d-系的交(不难看出 d-系的任意交是 d-系)。
  我们证明 $\mathcal{D}$ 实际上是一个 $\sigma$-代数，这样包含 $\mathcal{C}$
  的任意 d-系都包含 $\mathcal{D}$，而 $\mathcal{D}$ 作为包含 $\mathcal{C}$
  的 $\sigma$-代数，其包含 $\sigma \mathcal{C}$。
  根据 \autoref{prop:equivalent condition of sigma algebra}，只需要说明 
  $\mathcal{D}$ 既是 p-系又是 d-系，而 $\mathcal{D}$ 已经是 d-系，所以只需要
  说明 $\mathcal{D}$ 是 p-系。

  我们首先说明对于任意的 $D\in \mathcal{D}$ 和 $C\in \mathcal{C}$，
  有 $D\cap C\in \mathcal{D}$。令
  \[
    \mathcal{D}_1=\{A\in \mathcal{D}: A\cap C\in \mathcal{D}\},  
  \]
  根据 \autoref{lemma:hat D}，$\mathcal{D}_1$ 是 d-系。由于 $\mathcal{C}$
  是 p-系，所以 $\mathcal{C}\subseteq \mathcal{D}_1$，即 $\mathcal{D}_1$
  是包含 $\mathcal{C}$ 的 d-系，所以 $\mathcal{D}\subseteq \mathcal{D}_1$。
  这就表明 $D\in \mathcal{D}_1$，即 $D\cap C\in \mathcal{D}$。

  下面说明对于任意的 $D,B\in \mathcal{D}$，有 $D\cap B\in \mathcal{D}$。
  令
  \[
    \mathcal{D}_2=\{A\in \mathcal{D}: A\cap D\in \mathcal{D}\} .
  \]
  同样根据 \autoref{lemma:hat D}，$\mathcal{D}_2$ 是 d-系。根据上面的叙述，
  有 $\mathcal{C}\subseteq \mathcal{D}_2$，即 $\mathcal{D}_2$ 是包含 
  $\mathcal{C}$ 的 d-系，所以 $\mathcal{D}\subseteq \mathcal{D}_2$，
  这就表明 $B\in \mathcal{D}_2$，即 $D\cap B\in \mathcal{D}$。
  这就证明了 $\mathcal{D}$ 是 p-系。
\end{proof}

\subsubsection{可测空间}

一个\emph{可测空间}指的是二元组 $(E,\mathcal{E})$，其中 $E$ 是集合，
$\mathcal{E}$ 是 $E$ 上的 $\sigma$-代数。此时，$\mathcal{E}$
的元素被称为\emph{可测集}。当 $E$ 是拓扑空间，$\mathcal{E}=\mathcal{B}_E$
的时候，可测集也被称为\emph{Borel 集}。

\subsubsection{可测空间的积}

令 $(E,\mathcal{E})$ 和 $(F,\mathcal{F})$ 是可测空间。
如果 $A\in \mathcal{E}$ 和 $B\in \mathcal{F}$，那么 $A\times B$
被称为\emph{可测矩形}。我们用 $\mathcal{E}\otimes \mathcal{F}$
表示 $E\times F$ 上的由可测矩形集族生成的 $\sigma$-代数，
被称为\emph{乘积 $\sigma$-代数}。可测空间 $(E\times F,\mathcal{E}\otimes \mathcal{F})$
被称为 $(E,\mathcal{E})$ 和 $(F,\mathcal{F})$ 的积，我们通常使用
$(E,\mathcal{E})\times (F,\mathcal{F})$ 来表示。

\subsubsection{Exercises}

\begin{exercise}{划分生成 $\sigma$-代数}{}
  \begin{alphenum}[nosep]
    \item 令 $\mathcal{C}=\{A,B,C\}$ 是 $E$ 的一个划分，列出
    $\sigma \mathcal{C}$ 的元素。
    \item 令 $\mathcal{C}$ 是 $E$ 的(可数)划分。证明 $\sigma \mathcal{C}$
    的每个元素都是 $\mathcal{C}$ 中元素的可数并。
    \item 令 $E=\mathbb{R}$，$\mathcal{C}$ 是 $\mathbb{R}$ 的所有单点子集
    构成的子集族。证明 $\sigma \mathcal{C}$ 的元素要么是可数集要么
    是可数集的补集。这表明从直观上来看，$\sigma \mathcal{C}$ 要比 $\mathcal{B}(\mathbb{R})$
    小得多，例如开区间 $(0,1)$ 属于后者但是不属于前者。
  \end{alphenum}
\end{exercise}
\begin{solution}
  (a) 令
  \[
    \mathcal{E}=\{A,B,C,A\cup B,A\cup C,B\cup C,E\},
  \]
  显然 $\mathcal{E}$ 是一个 $\sigma$-代数。对于任意包含 $\mathcal{C}$
  的 $\sigma$-代数，由于其对并封闭，所以其必须包含 $\mathcal{E}$，
  所以 $\mathcal{E}=\sigma \mathcal{C}$。

  (b) 令 $\mathcal{E}$ 为 $\mathcal{C}$ 中元素的所有可数并构成的
  集族。根据 $\sigma$-代数对可数并的封闭性，所以 $\sigma \mathcal{C}\supseteq \mathcal{E}$。
  设 $(A_n)$ 构成 $E$ 的可数划分，即 $(A_n)$ 两两不相交且 $E=\bigcup_n A_n$。
  任取 $\bigcup_k A_{n_k}\in \mathcal{E}$，那么
  $E \smallsetminus \left(\bigcup_k A_{n_k}\right)$ 依然是某些 $(A_n)$
  的可数并，所以 $E \smallsetminus \left(\bigcup_k A_{n_k}\right)\in \mathcal{E}$，
  即 $\mathcal{E}$ 对补封闭，所以 $\mathcal{E}$ 是 $\sigma$-代数，
  所以 $\mathcal{E}=\sigma \mathcal{C}$。

  (c) 令 $\mathcal{E}$ 为 $\mathbb{R}$ 的可数子集和补集可数的子集构成的子集族。
  显然 $\mathcal{E}\subseteq \sigma \mathcal{C}$ 且不难验证 $\mathcal{E}$
  是一个 $\sigma$-代数(可数个可数集的并是可数集)，所以 $\mathcal{E}=\sigma \mathcal{C}$。
\end{solution}

\begin{exercise}{$\mathbb{R}$ 上的 Borel $\sigma$-代数}{}
  $\mathbb{R}=(-\infty,+\infty)$ 的任意开子集都是开区间的可数并。使用这一事实证明
  $\mathcal{B}(\mathbb{R})$ 由所有开区间构成的子集族生成。
\end{exercise}
\begin{proof}
  设 $\mathcal{C}$ 为所有开区间构成的子集族，$\mathcal{T}$ 为所有开集构成的子集族(即 $\mathbb{R}$ 上的拓扑)。
  显然 $\mathcal{C}\subseteq \mathcal{T}$，
  所以 $\sigma \mathcal{C}\subseteq \sigma \mathcal{T}=\mathcal{B}(\mathbb{R})$。由于
  $\mathcal{T}$ 中集合都是 $\mathcal{C}$ 中集合的可数并，所以 $\mathcal{T}\subseteq \sigma \mathcal{C}$，
  这表明 $\mathcal{B}(\mathbb{R})=\sigma \mathcal{T}\subseteq \sigma \mathcal{C}$。
  所以 $\mathcal{B}(\mathbb{R})=\sigma \mathcal{C}$ 由所有开区间构成的子集族生成。
\end{proof}

\begin{exercise}{$\mathbb{R}$ 上的 Borel $\sigma$-代数}{}
  证明：$\mathbb{R}$ 中的任意区间都是 Borel 集。特别的，$(-\infty,x),(-\infty,x],(x,y],[x,y]$ 都是 Borel 集。
  对于每个 $x$，单点集 $\{x\}$ 也是 Borel 集。 
\end{exercise}
\begin{proof}
  只需注意到
  \begin{gather*}
    (-\infty,x)=\bigcup_{n=1}^\infty \left(-n+x,x\right), 
    (-\infty, x]=\bigcap_{n=1}^\infty \left(-\infty,x+\frac{1}{n}\right),\\
    (x,y]=\bigcap_{n=1}^\infty \left(x,y+\frac{1}{n}\right),
    [x,y]=\bigcap_{n=1}^\infty\left(x-\frac{1}{n},y\right],
    \{x\}=\bigcap_{n=1}^\infty\left(x-\frac{1}{n},x\right].
  \end{gather*}
  所以上述集合都是 Borel 集，对于其他的区间同理。
\end{proof}

\begin{exercise}{$\mathbb{R}$ 上的 Borel $\sigma$-代数}{}
  证明 $\mathcal{B}(\mathbb{R})$ 可以由以下任意一种集族生成(实际上还有很多可能)：
  \begin{alphenum}[nosep]
    \item 所有形如 $(-\infty, x]$ 的区间构成的子集族。
    \item 所有形如 $(x,y]$ 的区间构成的子集族。
    \item 所有形如 $[x,y]$ 的区间构成的子集族。
    \item 所有形如 $(x,+\infty)$ 的区间构成的子集族。
  \end{alphenum}
  此外，在每种情况中 $x,y$ 可以被限制为有理数。
\end{exercise}
\begin{proof}
  (a) 记该集族为 $\mathcal{C}$，由上题，这样的区间已经是 Borel 集，
  所以 $\sigma\mathcal{C}\subseteq \mathcal{B}(\mathbb{R})$。任取 $\mathbb{R}$
  的开区间 $(x,y)$，有
  \[
    (x,y)=(-\infty,x]^c\cap (-\infty, y)=
    (-\infty,x]^c\cap\bigcup_{n=1}^\infty \left(-\infty,y-\frac{1}{n}\right]\in\sigma \mathcal{C},
  \]
  而 $\mathcal{B}(\mathbb{R})$ 由所有开区间生成，所以 $\mathcal{B}(\mathbb{R})\subseteq \sigma \mathcal{C}$。
  所以 $\mathcal{B}(\mathbb{R})=\sigma \mathcal{C}$。

  (b) (c) (d) 完全同理。
\end{proof}



\section{可测函数}

\subsubsection{可测函数}

令 $(E,\mathcal{E})$ 和 $(F,\mathcal{F})$ 是可测空间，映射 $f:E\to F$ 如果使得任取 $B\in \mathcal{F}$，有
$f^{-1}B\in \mathcal{E}$，那么我们说 $f$ 相对于 $\mathcal{E}$ 和 $\mathcal{F}$ \emph{可测}。

\begin{proposition}\label{prop:equivalent condition of measurable}
  映射 $f:E\to F$ 相对于 $\mathcal{E}$ 和 $\mathcal{F}$ 可测当且仅当对于任意生成 $\mathcal{F}$ 的子集族
  $\mathcal{F}_0$，任取 $B\in \mathcal{F}_0$，有 $f^{-1}B\in \mathcal{E}$。
\end{proposition}
\begin{proof}
  必要性显然。下证充分性。设 $\mathcal{F}_0$ 使得 $\mathcal{F}=\sigma \mathcal{F}_0$，且
  对于任意的 $B\in \mathcal{F}_0$ 有 $f^{-1}B\in \mathcal{E}$。记
  \[
    \mathcal{F}_1=\{A\in \mathcal{F}: f^{-1}A\in \mathcal{E}\},
  \]
  显然 $\mathcal{F}_0\subseteq \mathcal{F}_1\subseteq \mathcal{F}$。由于
  \[
    f^{-1}\left(F \smallsetminus A\right)=E \smallsetminus(f^{-1}A),\quad
    f^{-1}\left(\bigcup_{i\in I}A_i\right)=\bigcup_{i\in I} f^{-1}A_i,
  \]
  所以 $\mathcal{F}_1$ 是 $\sigma$-代数，所以 $\mathcal{F}=\mathcal{F}_1$，即 $f$ 
  相对于 $\mathcal{E}$ 和 $\mathcal{F}$ 可测。
\end{proof}

\begin{proposition}
  给定可测空间 $(E,\mathcal{E}),(F,\mathcal{F}),(G,\mathcal{G})$，如果 $f$ 相对于 $\mathcal{E}$ 和 
  $\mathcal{F}$ 可测，$g$ 相对于 $\mathcal{F}$ 和 $\mathcal{G}$ 可测，那么复合
  $g\circ f$ 相对于 $\mathcal{E}$ 和 $\mathcal{G}$ 可测。
\end{proposition}
\begin{proof}
  任取 $C\in \mathcal{G}$，有
  \[
    (g\circ f)^{-1}(C)=f^{-1}\left(g^{-1}(C)\right),  
  \]
  $g$ 可测表明 $g^{-1}(C)\in \mathcal{F}$，$f$ 可测表明 $f^{-1}\left(g^{-1}(C)\right)\in \mathcal{E}$，
  所以 $g\circ f$ 相对于 $\mathcal{E}$ 和 $\mathcal{G}$ 可测。
\end{proof}

\subsubsection{数值函数}

令 $(E,\mathcal{E})$ 是可测空间。回顾实数及扩充实数 $\mathbb{R}=(-\infty,+\infty)$，
$\bar{\mathbb{R}}=[-\infty,+\infty]$，$\mathbb{R}_+=[0,+\infty)$，
$\bar{\mathbb{R}}_+=[0,+\infty]$。$E$ 上的\emph{数值函数}指的是
从 $E$ 到 $\bar{\mathbb{R}}$ 或者 $\bar{\mathbb{R}}$ 的子集的映射。
如果这个映射的值在 $\mathbb{R}$ 中，那么我们一般称其为\emph{实值函数}。

$E$ 上的数值函数如果相对于 $\mathcal{E}$ 和 $\mathcal{B}(\bar{\mathbb{R}})$
可测，那么我们说其是 $\mathcal{E}$-可测的。如果 $E$
是拓扑空间且 $\mathcal{E}=\mathcal{B}(E)$，那么 $\mathcal{E}$-可测函数
被称为\emph{Borel 函数}。
下面的命题是 \autoref{prop:equivalent condition of measurable} 的直接结果。

\begin{proposition}
  映射 $f:E\to\bar{\mathbb{R}}$ 是 $\mathcal{E}$-可测的当且仅当
  对于每个 $r\in \mathbb{R}$，$f^{-1}[-\infty,r]\in \mathcal{E}$。
\end{proposition}

上述命题中的 $[-\infty,r]$ 可以改为 $[-\infty,r)$，$[r,\infty]$，
$(r,\infty]$ 中的任意一种。

\subsubsection{函数的正部分和负部分}

对于 $a,b\in\bar{\mathbb{R}}$，我们记 $a\vee b$ 为 $a$ 和 $b$
中的最大者，$a\wedge b$ 为 $a$ 和 $b$ 中的最小者。
对于函数 $f,g$，用 $f\vee g$ 表示函数 $x\mapsto f(x)\vee g(x)$。
令 $(E,\mathcal{E})$ 是可测空间，$f$ 是 $E$ 上的数值函数。
那么
\[
  f^+=f\vee 0,\quad f^-=-(f\wedge 0)  
\]
都是正值函数并且 $f=f^+-f^-$。函数 $f^+$ 被称为 $f$ 的\emph{正部分}，
$f^-$ 被称为 $f$ 的\emph{负部分}。

\begin{proposition}
  函数 $f$ 是 $\mathcal{E}$-可测的当且仅当 $f^+$ 和 $f^-$
  都是 $\mathcal{E}$-可测的。
\end{proposition}
\begin{proof}
  若 $f$ 是 $\mathcal{E}$-可测的。任取 $r\in \mathbb{R}$，
若 $r< 0$，则 $\left(f^+\right)^{-1}[-\infty,r]=\emptyset\in \mathcal{E}$。
  若 $r\geq 0$，则
  \[
    \left(f^+\right)^{-1}[-\infty,r]=E \smallsetminus \left(f^+\right)^{-1}(r,\infty]
    =E \smallsetminus f^{-1}(r,\infty],
  \]
  由于 $(r,\infty]$ 是 Borel 集，所以 $\left(f^+\right)^{-1}[-\infty,r]\in \mathcal{E}$。
  综合起来，$f^+$ 是 $\mathcal{E}$-可测的。同理可证 $f^-$ 是 $\mathcal{E}$-可测的。

  若 $f^+$ 和 $f^-$ 都是 $\mathcal{E}$-可测的。任取 $r\in \mathbb{R}$，若 $r<0$，那么
  \[
    f^{-1}[-\infty,r]=  \left(f^-\right)^{-1}[-r,\infty]\in \mathcal{E}.
  \]
  若 $r\geq 0$，那么
  \[
    f^{-1}[-\infty,r]= E \smallsetminus f^{-1}(r,\infty]
    =E \smallsetminus \left(f^+\right)^{-1}(r,\infty]\in \mathcal{E}.
  \]
  所以 $f$ 是 $\mathcal{E}$-可测的。
\end{proof}

\subsubsection{指示函数和简单函数}

令 $A\subseteq E$，定义 $A$ 的指示函数为 $1_A$：
\[
  1_A(x)=\begin{cases}
    1 & x\in A,\\
    0 & x\notin A.
  \end{cases}  
\]
对于 $1_E$，我们简记为 $1$。显然，$1_A$ 是 $\mathcal{E}$-可测的当且仅当
$A\in \mathcal{E}$。

$E$ 上的函数 $f$ 如果形如
\[
  f=\sum_{i=1}^n a_i 1_{A_i},  
\]
其中 $n\geq 1$，$a_1,\dots,a_n\in \mathbb{R}$，$A_1,\dots,A_n$ 是可测集，
那么我们说 $f$ 是\emph{简单函数}。
在这个定义中，若 $A_i\cap A_j\ne\emptyset$，那么我们可以将
$a_i1_{A_i}+a_j1_{A_j}$ 拆为
\[ 
  a_i1_{A_i \smallsetminus (A_i\cap A_j)}+(a_i+a_j)1_{A_i\cap A_j}+a_j 1_{A_j \smallsetminus (A_i\cap A_j)},
\]
所以我们可以假设 $A_i$ 两两不相交。此外，如果 $\bigcup_i A_i\neq E$，记
$B=E \smallsetminus\bigcup_i A_i\in \mathcal{E}$，那么
\[
  f=  \sum_{i=1}^n a_i 1_{A_i}+0\cdot 1_{B},
\]
所以我们还可以假设 $\bigcup_i A_i=E$。这意味着对于一个简单函数 $f$，
总存在整数 $m$，不同的实数 $b_1,\dots,b_m$ 和 $E$ 的可测划分
$\{B_1,\dots,B_m\}$ 使得 $f=\sum_{i=1}^m b_i 1_{B_i}$，
这种表示被称为简单函数 $f$ 的\emph{标准型}。

利用简单函数的标准型，很容易验证简单函数都是 $\mathcal{E}$-可测的。
反之，若 $f$ 是 $\mathcal{E}$-可测的，只有有限个取值且值为实数，那么
$f$ 为简单函数。特别地，任意常值函数是简单函数。最后，如果 $f,g$
是简单函数，那么
\[
  f+g,\quad f-g,\quad fg,\quad f/g,\quad f\vee g,\quad f\wedge g  
\]
都是简单函数，其中 $f/g$ 要求 $g$ 的值始终非零。

\subsubsection{函数列的极限}

令 $(f_n)$ 是 $E$ 上的一列数值函数，我们可以逐点定义
\begin{equation}\label{eq:inf and sup}
  \inf f_n,\quad \sup f_n,\quad \liminf f_n,\quad \limsup f_n,
\end{equation}
例如，$\inf f_n$ 将 $x\in E$ 送到实数列 $(f_n(x))$ 的下确界。
如果
\[
  \liminf f_n=\limsup f_n=f,
\]
那么我们说 $(f_n)$ 有逐点极限 $f$，记为 $f=\lim f_n$ 或者 $f_n\to f$。

如果 $(f_n)$ 单调递增，即 $f_1\leq f_2\leq \cdots$，那么根据单调有界定理，$\lim f_n$
存在且等于 $\sup f_n$。此时我们用 $f_n\nearrow f$ 来表示 $(f_n)$ 单调递增且有极限 $f$。
类似地，用 $f_n\searrow f$ 来表示 $(f_n)$ 单调递减且有极限 $f$。

下面的定理表明可测函数类对极限操作是封闭的。
\begin{theorem}\label{thm:lim of measurable function is measurable}
  令 $(f_n)$ 是一列 $\mathcal{E}$-可测函数，那么 \eqref{eq:inf and sup} 中的四个函数都是
  $\mathcal{E}$-可测的。此外，如果 $\lim f_n$ 存在，那么 $\lim f_n$ 也是 $\mathcal{E}$-可测的。
\end{theorem}
\begin{proof}
  记 $g=\sup f_n$。任取 $r\in \mathbb{R}$，注意到 $g(x)\leq r$ 当且仅当对于所有 $n$ 有 $f_n(x)\leq r$。
  所以
  \[
    g^{-1}[-\infty,r]=\bigcap_{n=1}^\infty f_n^{-1}[-\infty,r],
  \]
  $f_n$ 可测表明 $f_n^{-1}[-\infty,r]\in \mathcal{E}$，所以 $g^{-1}[-\infty,r]\in \mathcal{E}$，即
  $g$ 可测。

  对于 $\inf f_n$，我们有 $\inf f_n=-\sup (-f_n)$，所以 $\inf f_n$ 也可测。
  最后，注意到
  \[
    \liminf f_n=\sup\limits_m \mathop{\vphantom{\sup}\inf}_{n\geq m} f_n,\quad
    \limsup f_n=\mathop{\vphantom{\sup}\inf}_{m}\sup_{n\geq m} f_n,
  \] 
  所以 $\liminf f_n$ 和 $\limsup f_n$ 可测。若二者相等，那么 $\lim f_n$ 也可测。
\end{proof}

\subsubsection{可测函数的逼近}

\begin{lemma}
  对于 $n\in \mathbb{N}^*$，令
  \[
    d_n(r)=\sum_{k=1}^{n2^n}\frac{k-1}{2^n}1_{\left[\frac{k-1}{2^n},\frac{k}{2^n}\right)}(r)
    +n1_{[n,\infty]}(r),\quad r\in \bar{\mathbb{R}}_+.
  \]
  那么，$d_n(r)$ 是 $\bar{\mathbb{R}}_+$ 上单调递增的简单函数，并且对于每个 $r\in\bar{\mathbb{R}}_+$，
  $d_n(r)$ 随着 $n$ 的增大是的单调递增的。
\end{lemma}
\begin{proof}
  显然 $d_n(r)$ 是单调递增的简单函数，我们证明任取 $r\in \bar{\mathbb{R}}_+$，$d_n(r)$
  是单调递增的。若 $r=\infty$，那么 $d_n(r)=n$ 是单调递增的。现在假设 $r\in \mathbb{R}_+$，
  那么存在正整数 $m$ 使得 $m\leq r<m+1$，所以当 $n\leq m$ 的时候，$d_n(r)=n$ 单调递增。
  当 $n>m$ 的时候，直观来看，$d_n$ 将区间 $[0,n]$ 等分为 $n2^{n}$ 份，$r\in [0,n]$
  表明一定存在唯一的 $k_n$ 使得 $(k_n-1)/2^n\leq r <k_n/2^n$，可以发现 $k_{n}$ 满足 
  递推关系 $k_{n+1}=2k_n-1$ 或者 $k_{n+1}=2k_n$，这表明
  \[
    d_{n+1}(r)= \frac{k_{n+1}-1}{2^{n+1}}\geq\frac{2k_n-2}{2^{n+1}}=\frac{k_n-1}{2^n}=d_n(r).
  \]
  综上，$d_n(r)$ 随着 $n$ 的增大是的单调递增的。
\end{proof}

\begin{theorem}
  $E$ 上的正值函数是 $\mathcal{E}$-可测的当且仅当其是一列单调递增的正值简单函数序列
  的极限。
\end{theorem}
\begin{proof}
  充分性来源于 \autoref{thm:lim of measurable function is measurable}。
  对于必要性，设 $f:E\to\bar{\mathbb{R}}_+$ 是 $\mathcal{E}$-可测的正值函数。
  记 $d_n$ 为上述引理中的函数，令 $f_n=d_n\circ f$。那么 $f_n$ 是正值的 $\mathcal{E}$-可测函数，
  并且其取值只有有限个，所以是简单函数。由于 $(d_n)$ 单调递增，所以 $(f_n)$ 单调递增。
  对于任意 $x\in E$，由于 $f_n(x)=d_n(f(x))$，所以 $n\to\infty$ 的时候
  $f_n(x)\to f(x)$，故 $f=\lim f_n$。
\end{proof}

\subsubsection{函数的单调类}

令 $\mathcal{M}$ 为 $E$ 上数值函数的一个集合，记 $\mathcal{M}_+$ 为 $\mathcal{M}$
中正值函数组成的子集，$\mathcal{M}_b$ 为 $\mathcal{M}$ 中有界函数组成的子集。

如果 $\mathcal{M}$ 包含常值函数 $1$，$\mathcal{M}_b$ 构成 $\mathbb{R}$ 上的向量空间
以及 $\mathcal{M}_+$ 在递增极限下封闭，那么我们说 $\mathcal{M}$ 是一个\emph{单调类}。
更准确地说，$\mathcal{M}$ 是单调类当且仅当：
\begin{alphenum}
  \item $1\in \mathcal{M}$，
  \item 若 $f,g\in \mathcal{M}_b$ 且 $a,b\in \mathbb{R}$，则 $af+bg\in \mathcal{M}$，
  \item 若 $(f_n)\subseteq \mathcal{M}_+$ 且 $f_n\nearrow f$，那么
  $f\in \mathcal{M}$。
\end{alphenum}










\end{document}